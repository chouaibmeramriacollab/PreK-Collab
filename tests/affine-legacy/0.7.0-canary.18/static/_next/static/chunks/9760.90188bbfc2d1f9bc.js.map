{"version":3,"file":"static/chunks/9760.90188bbfc2d1f9bc.js","mappings":"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","sources":["webpack://_N_E/../../packages/component/src/components/image-preview-modal/hooks/use-zoom.tsx","webpack://_N_E/../../packages/component/src/components/image-preview-modal/index.css.ts","webpack://_N_E/../../packages/component/src/components/image-preview-modal/index.jotai.ts","webpack://_N_E/../../packages/component/src/components/image-preview-modal/index.tsx","webpack://_N_E/../../node_modules/@vanilla-extract/webpack-plugin/extracted.js?a312","webpack://_N_E/ignored|/Users/himself65/Code/old-affine/node_modules/shiki/dist|fs","webpack://_N_E/ignored|/Users/himself65/Code/old-affine/node_modules/shiki/dist|path","webpack://_N_E/<anon>"],"sourcesContent":["import type { MouseEvent as ReactMouseEvent, RefObject } from 'react';\nimport { useCallback, useEffect, useState } from 'react';\n\ninterface UseZoomControlsProps {\n  zoomRef: RefObject<HTMLDivElement>;\n  imageRef: RefObject<HTMLImageElement>;\n}\n\nexport const useZoomControls = ({\n  zoomRef,\n  imageRef,\n}: UseZoomControlsProps) => {\n  const [currentScale, setCurrentScale] = useState<number>(1);\n  const [isZoomedBigger, setIsZoomedBigger] = useState<boolean>(false);\n  const [isDragging, setIsDragging] = useState<boolean>(false);\n  const [mouseX, setMouseX] = useState<number>(0);\n  const [mouseY, setMouseY] = useState<number>(0);\n  const [dragBeforeX, setDragBeforeX] = useState<number>(0);\n  const [dragBeforeY, setDragBeforeY] = useState<number>(0);\n  const [imagePos, setImagePos] = useState<{ x: number; y: number }>({\n    x: 0,\n    y: 0,\n  });\n\n  const zoomIn = useCallback(() => {\n    const image = imageRef.current;\n\n    if (image && currentScale < 2) {\n      const newScale = currentScale + 0.1;\n      setCurrentScale(newScale);\n      image.style.width = `${image.naturalWidth * newScale}px`;\n      image.style.height = `${image.naturalHeight * newScale}px`;\n    }\n  }, [imageRef, currentScale]);\n\n  const zoomOut = useCallback(() => {\n    const image = imageRef.current;\n    if (image && currentScale > 0.2) {\n      const newScale = currentScale - 0.1;\n      setCurrentScale(newScale);\n      image.style.width = `${image.naturalWidth * newScale}px`;\n      image.style.height = `${image.naturalHeight * newScale}px`;\n      const zoomedWidth = image.naturalWidth * newScale;\n      const zoomedHeight = image.naturalHeight * newScale;\n      const containerWidth = window.innerWidth;\n      const containerHeight = window.innerHeight;\n      if (zoomedWidth > containerWidth || zoomedHeight > containerHeight) {\n        image.style.transform = `translate(0px, 0px)`;\n        setImagePos({ x: 0, y: 0 });\n      }\n    }\n  }, [imageRef, currentScale]);\n\n  const checkZoomSize = useCallback(() => {\n    const { current: zoomArea } = zoomRef;\n    if (zoomArea) {\n      const image = zoomArea.querySelector('img');\n      if (image) {\n        const zoomedWidth = image.naturalWidth * currentScale;\n        const zoomedHeight = image.naturalHeight * currentScale;\n        const containerWidth = window.innerWidth;\n        const containerHeight = window.innerHeight;\n        setIsZoomedBigger(\n          zoomedWidth > containerWidth || zoomedHeight > containerHeight\n        );\n      }\n    }\n  }, [currentScale, zoomRef]);\n\n  const resetZoom = useCallback(() => {\n    const image = imageRef.current;\n    if (image) {\n      const viewportWidth = window.innerWidth;\n      const viewportHeight = window.innerHeight;\n      const margin = 0.2;\n\n      const availableWidth = viewportWidth * (1 - margin);\n      const availableHeight = viewportHeight * (1 - margin);\n\n      const widthRatio = availableWidth / image.naturalWidth;\n      const heightRatio = availableHeight / image.naturalHeight;\n\n      const newScale = Math.min(widthRatio, heightRatio);\n      setCurrentScale(newScale);\n      image.style.width = `${image.naturalWidth * newScale}px`;\n      image.style.height = `${image.naturalHeight * newScale}px`;\n      image.style.transform = 'translate(0px, 0px)';\n      setImagePos({ x: 0, y: 0 });\n      checkZoomSize();\n    }\n  }, [checkZoomSize, imageRef]);\n\n  const handleDragStart = useCallback(\n    (event: ReactMouseEvent) => {\n      event?.preventDefault();\n      setIsDragging(true);\n      const image = imageRef.current;\n      if (image && isZoomedBigger) {\n        image.style.cursor = 'grab';\n        const rect = image.getBoundingClientRect();\n        setDragBeforeX(rect.left);\n        setDragBeforeY(rect.top);\n        setMouseX(event.clientX);\n        setMouseY(event.clientY);\n      }\n    },\n    [imageRef, isZoomedBigger]\n  );\n\n  const handleDrag = useCallback(\n    (event: ReactMouseEvent) => {\n      event?.preventDefault();\n      const image = imageRef.current;\n\n      if (isDragging && image && isZoomedBigger) {\n        image.style.cursor = 'grabbing';\n        const currentX = imagePos.x;\n        const currentY = imagePos.y;\n        const newPosX = currentX + event.clientX - mouseX;\n        const newPosY = currentY + event.clientY - mouseY;\n        image.style.transform = `translate(${newPosX}px, ${newPosY}px)`;\n      }\n    },\n    [\n      imagePos.x,\n      imagePos.y,\n      imageRef,\n      isDragging,\n      isZoomedBigger,\n      mouseX,\n      mouseY,\n    ]\n  );\n\n  const dragEndImpl = useCallback(() => {\n    setIsDragging(false);\n\n    const image = imageRef.current;\n    if (image && isZoomedBigger && isDragging) {\n      image.style.cursor = 'pointer';\n      const rect = image.getBoundingClientRect();\n      const newPos = { x: rect.left, y: rect.top };\n      const currentX = imagePos.x;\n      const currentY = imagePos.y;\n      const newPosX = currentX + newPos.x - dragBeforeX;\n      const newPosY = currentY + newPos.y - dragBeforeY;\n      setImagePos({ x: newPosX, y: newPosY });\n    }\n  }, [\n    dragBeforeX,\n    dragBeforeY,\n    imagePos.x,\n    imagePos.y,\n    imageRef,\n    isDragging,\n    isZoomedBigger,\n  ]);\n\n  const handleDragEnd = useCallback(\n    (event: ReactMouseEvent) => {\n      event.preventDefault();\n      dragEndImpl();\n    },\n    [dragEndImpl]\n  );\n\n  const handleMouseUp = useCallback(() => {\n    if (isDragging) {\n      dragEndImpl();\n    }\n  }, [isDragging, dragEndImpl]);\n\n  useEffect(() => {\n    const handleScroll = (event: WheelEvent) => {\n      const { deltaY } = event;\n      if (deltaY > 0) {\n        zoomOut();\n      } else if (deltaY < 0) {\n        zoomIn();\n      }\n    };\n\n    const handleResize = () => {\n      checkZoomSize();\n    };\n\n    checkZoomSize();\n\n    window.addEventListener('wheel', handleScroll, { passive: false });\n    window.addEventListener('resize', handleResize);\n    window.addEventListener('mouseup', handleMouseUp);\n\n    return () => {\n      window.removeEventListener('wheel', handleScroll);\n      window.removeEventListener('resize', handleResize);\n      window.removeEventListener('mouseup', handleMouseUp);\n    };\n  }, [zoomIn, zoomOut, checkZoomSize, handleMouseUp]);\n\n  return {\n    zoomIn,\n    zoomOut,\n    resetZoom,\n    isZoomedBigger,\n    currentScale,\n    handleDragStart,\n    handleDrag,\n    handleDragEnd,\n  };\n};\n","import \"../../packages/component/src/components/image-preview-modal/index.css.ts.vanilla.css!=!../../../../../node_modules/@vanilla-extract/webpack-plugin/virtualFileLoader/dist/vanilla-extract-webpack-plugin-virtualFileLoader.cjs.js?{\\\"fileName\\\":\\\"../../packages/component/src/components/image-preview-modal/index.css.ts.vanilla.css\\\",\\\"source\\\":\\\"#H4sIAAAAAAAAE61V247aMBB95yssVZVAqhEJEGj2pS98iBM7iWliR7ZTwlb8e33LbTfZ3UoIEPZkPD5z5sxke8WpuqY78HcFQM0lVZSzGGS0JfhFmxSvY7Azq5Jkyi9vFKsiBsFu991sC0LzQg37V0gZJq01WH9MZV2iuw5bktYYUElzBqkilYxBSpgiwpivjVQ0u8OUawtT40cJSn/ngjcMx0DkCVrvftjP9nTcvKweq63LI3iTB0okLxtFZlGYf4ipIKlzTrVrxT4BsgC942Af1e2Iom6bcIGJgAJh2khDjDM7drdHQSqzFS7GYBhn/QeJNYQoyygj8FZoBJshcgwYZzbLGmFMWT6OkjZCcu1Sc9rB1akayyQm1dlC+8AGVgKxjsYBhw4bSkCQ1P4M8kZNCz4qRWhLMXfRAH6+UJlmHUr6SmIQeaJKc67juDNav5s3Jry0guU1Sqm6m/zDKR8gOLpz7/joMe8t5ndCWRR4OCsWqSEQmBB1I4Qtaqa/9DB/6bI6FyQ4W4XjU4L34aIvFLVCItfasNoOD4by/vhpHs3/t1tf1UA3mBtKg0bhx/je9OK569AWygJhftOodUzz0+C7YQP8d7v3ObbQt7hZeuCjTM/TTCmzCn7G/Ptadm5aBzoB3VcUg2+X/SW8HEYIf7pR6Yjs/H1ndVbR6X5SRWRPujKbvjpPniZPkvPMyyjhSvFK18fXbPKiGas+9Qj7IkVnP4g/Ie/Dt8xYdp4or/UeWOCo+FURTBGQqdATACA9NtcjMKdI499YiJMRsEjFY/CMvKcirYLWfer4+AfMh4WV0QcAAA==\\\"}!../../../../../node_modules/@vanilla-extract/webpack-plugin/extracted.js\"\nexport var buttonStyle = 'jdctjc9';\nexport var captionStyle = 'jdctjcc';\nexport var groupStyle = 'jdctjc8';\nexport var imageBottomContainerStyle = 'jdctjcb';\nexport var imageNavigationControlStyle = 'jdctjc3';\nexport var imagePreviewActionBarStyle = 'jdctjc7';\nexport var imagePreviewModalCaptionStyle = 'jdctjc6';\nexport var imagePreviewModalCenterStyle = 'jdctjc5';\nexport var imagePreviewModalCloseButtonStyle = 'jdctjc1';\nexport var imagePreviewModalContainerStyle = 'jdctjc4';\nexport var imagePreviewModalGoStyle = 'jdctjc2';\nexport var imagePreviewModalStyle = 'jdctjc0';\nexport var scaleIndicatorStyle = 'jdctjca';","import type { EmbedBlockDoubleClickData } from '@blocksuite/blocks';\nimport { atom } from 'jotai';\n\nexport const previewBlockIdAtom = atom<string | null>(null);\n\npreviewBlockIdAtom.onMount = set => {\n  if (typeof window !== 'undefined') {\n    const callback = (event: CustomEvent<EmbedBlockDoubleClickData>) => {\n      set(event.detail.blockId);\n    };\n    window.addEventListener('affine.embed-block-db-click', callback);\n    return () => {\n      window.removeEventListener('affine.embed-block-db-click', callback);\n    };\n  }\n  return;\n};\n","/// <reference types=\"react/experimental\" />\nimport '@blocksuite/blocks';\n\nimport type { EmbedBlockModel } from '@blocksuite/blocks';\nimport { assertExists } from '@blocksuite/global/utils';\nimport {\n  ArrowLeftSmallIcon,\n  ArrowRightSmallIcon,\n  CopyIcon,\n  DeleteIcon,\n  DownloadIcon,\n  MinusIcon,\n  PlusIcon,\n  ViewBarIcon,\n} from '@blocksuite/icons';\nimport type { Workspace } from '@blocksuite/store';\nimport clsx from 'clsx';\nimport { useAtom } from 'jotai';\nimport type { ReactElement } from 'react';\nimport { Suspense, useCallback } from 'react';\nimport { useEffect, useRef, useState } from 'react';\nimport useSWR from 'swr';\n\nimport Button from '../../ui/button/button';\nimport { useZoomControls } from './hooks/use-zoom';\nimport {\n  buttonStyle,\n  captionStyle,\n  groupStyle,\n  imageBottomContainerStyle,\n  imageNavigationControlStyle,\n  imagePreviewActionBarStyle,\n  imagePreviewModalCaptionStyle,\n  imagePreviewModalCenterStyle,\n  imagePreviewModalCloseButtonStyle,\n  imagePreviewModalContainerStyle,\n  imagePreviewModalGoStyle,\n  imagePreviewModalStyle,\n  scaleIndicatorStyle,\n} from './index.css';\nimport { previewBlockIdAtom } from './index.jotai';\n\nexport type ImagePreviewModalProps = {\n  workspace: Workspace;\n  pageId: string;\n};\n\nconst ImagePreviewModalImpl = (\n  props: ImagePreviewModalProps & {\n    blockId: string;\n    onClose: () => void;\n  }\n): ReactElement | null => {\n  const [blockId, setBlockId] = useAtom(previewBlockIdAtom);\n\n  const [bIsActionBarVisible, setBIsActionBarVisible] = useState(false);\n  const [caption, setCaption] = useState(() => {\n    const page = props.workspace.getPage(props.pageId);\n    assertExists(page);\n    const block = page.getBlockById(props.blockId) as EmbedBlockModel;\n    assertExists(block);\n    return block?.caption;\n  });\n  useEffect(() => {\n    const page = props.workspace.getPage(props.pageId);\n    assertExists(page);\n    const block = page.getBlockById(props.blockId) as EmbedBlockModel;\n    assertExists(block);\n    setCaption(block?.caption);\n  }, [props.blockId, props.pageId, props.workspace]);\n  const { data } = useSWR(['workspace', 'embed', props.pageId, props.blockId], {\n    fetcher: ([_, __, pageId, blockId]) => {\n      const page = props.workspace.getPage(pageId);\n      assertExists(page);\n      const block = page.getBlockById(blockId) as EmbedBlockModel;\n      assertExists(block);\n      return props.workspace.blobs.get(block?.sourceId);\n    },\n    suspense: true,\n  });\n  const zoomRef = useRef<HTMLDivElement | null>(null);\n  const imageRef = useRef<HTMLImageElement | null>(null);\n  const {\n    zoomIn,\n    zoomOut,\n    isZoomedBigger,\n    handleDrag,\n    handleDragStart,\n    handleDragEnd,\n    resetZoom,\n    currentScale,\n  } = useZoomControls({ zoomRef, imageRef });\n  const [prevData, setPrevData] = useState<string | null>(() => data);\n  const [url, setUrl] = useState<string | null>(null);\n  if (prevData !== data) {\n    if (url) {\n      URL.revokeObjectURL(url);\n    }\n    setUrl(URL.createObjectURL(data));\n\n    setPrevData(data);\n  } else if (!url) {\n    setUrl(URL.createObjectURL(data));\n  }\n  if (!url) {\n    return null;\n  }\n\n  const nextImageHandler = (blockId: string | null) => {\n    assertExists(blockId);\n    const workspace = props.workspace;\n\n    const page = workspace.getPage(props.pageId);\n    assertExists(page);\n    const block = page.getBlockById(blockId);\n    assertExists(block);\n    const nextBlock = page\n      .getNextSiblings(block)\n      .find(\n        (block): block is EmbedBlockModel => block.flavour === 'affine:embed'\n      );\n    if (nextBlock) {\n      setBlockId(nextBlock.id);\n    }\n  };\n\n  const previousImageHandler = (blockId: string | null) => {\n    assertExists(blockId);\n    const workspace = props.workspace;\n    const page = workspace.getPage(props.pageId);\n    assertExists(page);\n    const block = page.getBlockById(blockId);\n    assertExists(block);\n    const prevBlock = page\n      .getPreviousSiblings(block)\n      .findLast(\n        (block): block is EmbedBlockModel => block.flavour === 'affine:embed'\n      );\n    if (prevBlock) {\n      setBlockId(prevBlock.id);\n    }\n  };\n\n  const deleteHandler = (blockId: string) => {\n    const workspace = props.workspace;\n\n    const page = workspace.getPage(props.pageId);\n    assertExists(page);\n    const block = page.getBlockById(blockId);\n    assertExists(block);\n    if (\n      page\n        .getPreviousSiblings(block)\n        .findLast(\n          (block): block is EmbedBlockModel => block.flavour === 'affine:embed'\n        )\n    ) {\n      const prevBlock = page\n        .getPreviousSiblings(block)\n        .findLast(\n          (block): block is EmbedBlockModel => block.flavour === 'affine:embed'\n        );\n      if (prevBlock) {\n        setBlockId(prevBlock.id);\n      }\n    } else if (\n      page\n        .getNextSiblings(block)\n        .find(\n          (block): block is EmbedBlockModel => block.flavour === 'affine:embed'\n        )\n    ) {\n      const nextBlock = page\n        .getNextSiblings(block)\n        .find(\n          (block): block is EmbedBlockModel => block.flavour === 'affine:embed'\n        );\n      if (nextBlock) {\n        const image = imageRef.current;\n        resetZoom();\n        if (image) {\n          image.style.width = '100%'; // Reset the width to its original size\n          image.style.height = 'auto'; // Reset the height to maintain aspect ratio\n        }\n        setBlockId(nextBlock.id);\n      }\n    } else {\n      props.onClose();\n    }\n    page.deleteBlock(block);\n  };\n\n  let actionbarTimeout: NodeJS.Timeout;\n\n  const downloadHandler = async (blockId: string | null) => {\n    const workspace = props.workspace;\n    const page = workspace.getPage(props.pageId);\n    assertExists(page);\n    if (typeof blockId === 'string') {\n      const block = page.getBlockById(blockId) as EmbedBlockModel;\n      assertExists(block);\n      const store = await block.page.blobs;\n      const url = store?.get(block.sourceId);\n      const img = await url;\n      if (!img) {\n        return;\n      }\n      const arrayBuffer = await img.arrayBuffer();\n      const buffer = new Uint8Array(arrayBuffer);\n      let fileType: string;\n      if (\n        buffer[0] === 0x47 &&\n        buffer[1] === 0x49 &&\n        buffer[2] === 0x46 &&\n        buffer[3] === 0x38\n      ) {\n        fileType = 'image/gif';\n      } else if (\n        buffer[0] === 0x89 &&\n        buffer[1] === 0x50 &&\n        buffer[2] === 0x4e &&\n        buffer[3] === 0x47\n      ) {\n        fileType = 'image/png';\n      } else if (\n        buffer[0] === 0xff &&\n        buffer[1] === 0xd8 &&\n        buffer[2] === 0xff &&\n        buffer[3] === 0xe0\n      ) {\n        fileType = 'image/jpeg';\n      } else {\n        // unknown, fallback to png\n        console.error('unknown image type');\n        fileType = 'image/png';\n      }\n      const downloadUrl = URL.createObjectURL(\n        new Blob([arrayBuffer], { type: fileType })\n      );\n      const a = document.createElement('a');\n      const event = new MouseEvent('click');\n      a.download = block.id;\n      a.href = downloadUrl;\n      a.dispatchEvent(event);\n\n      // cleanup\n      a.remove();\n      URL.revokeObjectURL(downloadUrl);\n    }\n  };\n\n  const handleMouseEnter = () => {\n    clearTimeout(actionbarTimeout);\n    setBIsActionBarVisible(true);\n  };\n\n  const handleMouseLeave = () => {\n    actionbarTimeout = setTimeout(() => {\n      setBIsActionBarVisible(false);\n    }, 3000);\n  };\n\n  return (\n    <div\n      data-testid=\"image-preview-modal\"\n      className={imagePreviewModalStyle}\n      onClick={event =>\n        event.target === event.currentTarget ? props.onClose() : null\n      }\n    >\n      {!isZoomedBigger ? (\n        <div className={imageNavigationControlStyle}>\n          <span\n            className={imagePreviewModalGoStyle}\n            style={{\n              left: 0,\n            }}\n            onClick={() => {\n              assertExists(blockId);\n              previousImageHandler(blockId);\n            }}\n          >\n            ❮\n          </span>\n          <span\n            className={imagePreviewModalGoStyle}\n            style={{\n              right: 0,\n            }}\n            onClick={() => {\n              assertExists(blockId);\n              nextImageHandler(blockId);\n            }}\n          >\n            ❯\n          </span>\n        </div>\n      ) : (\n        <></>\n      )}\n      <div className={imagePreviewModalContainerStyle}>\n        <div\n          className={clsx('zoom-area', { 'zoomed-bigger': isZoomedBigger })}\n          ref={zoomRef}\n        >\n          <div className={imagePreviewModalCenterStyle}>\n            <img\n              data-blob-id={props.blockId}\n              src={url}\n              alt={caption}\n              ref={imageRef}\n              draggable={isZoomedBigger}\n              onMouseDown={handleDragStart}\n              onMouseMove={handleDrag}\n              onMouseUp={handleDragEnd}\n              onMouseEnter={handleMouseEnter}\n              onMouseLeave={handleMouseLeave}\n              onLoad={resetZoom}\n            />\n            {isZoomedBigger ? null : (\n              <p className={imagePreviewModalCaptionStyle}>{caption}</p>\n            )}\n          </div>\n        </div>\n      </div>\n      <button\n        onClick={() => {\n          props.onClose();\n        }}\n        className={imagePreviewModalCloseButtonStyle}\n      >\n        <svg\n          width=\"10\"\n          height=\"10\"\n          viewBox=\"0 0 10 10\"\n          fill=\"none\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n        >\n          <path\n            fillRule=\"evenodd\"\n            clipRule=\"evenodd\"\n            d=\"M0.286086 0.285964C0.530163 0.0418858 0.925891 0.0418858 1.16997 0.285964L5.00013 4.11613L8.83029 0.285964C9.07437 0.0418858 9.4701 0.0418858 9.71418 0.285964C9.95825 0.530041 9.95825 0.925769 9.71418 1.16985L5.88401 5.00001L9.71418 8.83017C9.95825 9.07425 9.95825 9.46998 9.71418 9.71405C9.4701 9.95813 9.07437 9.95813 8.83029 9.71405L5.00013 5.88389L1.16997 9.71405C0.925891 9.95813 0.530163 9.95813 0.286086 9.71405C0.0420079 9.46998 0.0420079 9.07425 0.286086 8.83017L4.11625 5.00001L0.286086 1.16985C0.0420079 0.925769 0.0420079 0.530041 0.286086 0.285964Z\"\n            fill=\"#77757D\"\n          />\n        </svg>\n      </button>\n      {bIsActionBarVisible ? (\n        <div\n          className={imageBottomContainerStyle}\n          onMouseEnter={handleMouseEnter}\n          onMouseLeave={handleMouseLeave}\n          onClick={event => event.stopPropagation()}\n        >\n          {isZoomedBigger && caption !== '' ? (\n            <p className={captionStyle}>{caption}</p>\n          ) : null}\n          <div className={imagePreviewActionBarStyle}>\n            <div>\n              <Button\n                icon={<ArrowLeftSmallIcon />}\n                noBorder={true}\n                className={buttonStyle}\n                onClick={() => {\n                  assertExists(blockId);\n                  previousImageHandler(blockId);\n                }}\n              />\n              <Button\n                icon={<ArrowRightSmallIcon />}\n                noBorder={true}\n                className={buttonStyle}\n                onClick={() => {\n                  assertExists(blockId);\n                  nextImageHandler(blockId);\n                }}\n              />\n            </div>\n            <div className={groupStyle}>\n              <Button\n                icon={<ViewBarIcon />}\n                noBorder={true}\n                className={buttonStyle}\n                onClick={() => resetZoom()}\n              />\n              <Button\n                icon={<MinusIcon />}\n                noBorder={true}\n                className={buttonStyle}\n                onClick={zoomOut}\n              />\n              <span className={scaleIndicatorStyle}>{`${(\n                currentScale * 100\n              ).toFixed(0)}%`}</span>\n              <Button\n                icon={<PlusIcon />}\n                noBorder={true}\n                className={buttonStyle}\n                onClick={() => zoomIn()}\n              />\n            </div>\n            <div className={groupStyle}>\n              <Button\n                icon={<DownloadIcon />}\n                noBorder={true}\n                className={buttonStyle}\n                onClick={() => {\n                  assertExists(blockId);\n                  downloadHandler(blockId).catch(err => {\n                    console.error('Could not download image', err);\n                  });\n                }}\n              />\n              <Button\n                icon={<CopyIcon />}\n                noBorder={true}\n                className={buttonStyle}\n                onClick={() => {\n                  if (!imageRef.current) {\n                    return;\n                  }\n                  const canvas = document.createElement('canvas');\n                  canvas.width = imageRef.current.naturalWidth;\n                  canvas.height = imageRef.current.naturalHeight;\n                  const context = canvas.getContext('2d');\n                  if (!context) {\n                    console.warn('Could not get canvas context');\n                    return;\n                  }\n                  context.drawImage(imageRef.current, 0, 0);\n                  canvas.toBlob(blob => {\n                    if (!blob) {\n                      console.warn('Could not get blob');\n                      return;\n                    }\n                    const dataUrl = URL.createObjectURL(blob);\n                    navigator.clipboard\n                      .write([new ClipboardItem({ 'image/png': blob })])\n                      .then(() => {\n                        console.log('Image copied to clipboard');\n                        URL.revokeObjectURL(dataUrl);\n                      })\n                      .catch(error => {\n                        console.error(\n                          'Error copying image to clipboard',\n                          error\n                        );\n                        URL.revokeObjectURL(dataUrl);\n                      });\n                  }, 'image/png');\n                }}\n              />\n            </div>\n            <div className={groupStyle}>\n              <Button\n                icon={<DeleteIcon />}\n                noBorder={true}\n                className={buttonStyle}\n                onClick={() => blockId && deleteHandler(blockId)}\n              />\n            </div>\n          </div>\n        </div>\n      ) : null}\n    </div>\n  );\n};\n\nexport const ImagePreviewModal = (\n  props: ImagePreviewModalProps\n): ReactElement | null => {\n  const [blockId, setBlockId] = useAtom(previewBlockIdAtom);\n\n  const handleKeyUp = useCallback(\n    (event: KeyboardEvent) => {\n      if (event.key === 'Escape') {\n        event.preventDefault();\n        event.stopPropagation();\n        setBlockId(null);\n        return;\n      }\n\n      if (!blockId) {\n        return;\n      }\n\n      const workspace = props.workspace;\n\n      const page = workspace.getPage(props.pageId);\n      assertExists(page);\n      const block = page.getBlockById(blockId);\n      assertExists(block);\n\n      if (event.key === 'ArrowLeft') {\n        const prevBlock = page\n          .getPreviousSiblings(block)\n          .findLast(\n            (block): block is EmbedBlockModel =>\n              block.flavour === 'affine:embed'\n          );\n        if (prevBlock) {\n          setBlockId(prevBlock.id);\n        }\n      } else if (event.key === 'ArrowRight') {\n        const nextBlock = page\n          .getNextSiblings(block)\n          .find(\n            (block): block is EmbedBlockModel =>\n              block.flavour === 'affine:embed'\n          );\n        if (nextBlock) {\n          setBlockId(nextBlock.id);\n        }\n      } else {\n        return;\n      }\n      event.preventDefault();\n      event.stopPropagation();\n    },\n    [blockId, setBlockId, props.workspace, props.pageId]\n  );\n\n  useEffect(() => {\n    document.addEventListener('keyup', handleKeyUp);\n    return () => {\n      document.removeEventListener('keyup', handleKeyUp);\n    };\n  }, [handleKeyUp]);\n\n  if (!blockId) {\n    return null;\n  }\n\n  return (\n    <Suspense fallback={<div className={imagePreviewModalStyle} />}>\n      <ImagePreviewModalImpl\n        {...props}\n        blockId={blockId}\n        onClose={() => setBlockId(null)}\n      />\n    </Suspense>\n  );\n};\n","// extracted by mini-css-extract-plugin","/* (ignored) */","/* (ignored) */"],"names":["useZoomControls","zoomRef","imageRef","param","currentScale","setCurrentScale","useState","isZoomedBigger","setIsZoomedBigger","isDragging","setIsDragging","mouseX","setMouseX","mouseY","setMouseY","dragBeforeX","setDragBeforeX","dragBeforeY","setDragBeforeY","imagePos","setImagePos","x","y","zoomIn","useCallback","image","current","newScale","style","width","concat","naturalWidth","height","naturalHeight","zoomOut","zoomedWidth","zoomedHeight","containerWidth","window","innerWidth","containerHeight","innerHeight","transform","checkZoomSize","zoomArea","querySelector","resetZoom","viewportWidth","viewportHeight","widthRatio","availableWidth","heightRatio","availableHeight","Math","min","handleDragStart","event","preventDefault","cursor","rect","getBoundingClientRect","left","top","clientX","clientY","handleDrag","currentX","currentY","newPosX","newPosY","dragEndImpl","newPos","handleDragEnd","handleMouseUp","useEffect","handleScroll","deltaY","handleResize","addEventListener","passive","removeEventListener","buttonStyle","groupStyle","imagePreviewModalGoStyle","imagePreviewModalStyle","previewBlockIdAtom","atom","onMount","set","callback","detail","blockId","ImagePreviewModalImpl","actionbarTimeout","setBlockId","useAtom","bIsActionBarVisible","setBIsActionBarVisible","caption","setCaption","page","props","workspace","getPage","pageId","assertExists","block","getBlockById","data","useSWR","fetcher","_","__","blobs","get","sourceId","suspense","useRef","prevData","setPrevData","url","setUrl","URL","revokeObjectURL","createObjectURL","nextImageHandler","nextBlock","getNextSiblings","find","flavour","id","previousImageHandler","prevBlock","getPreviousSiblings","findLast","deleteHandler","onClose","deleteBlock","downloadHandler","fileType","store","img","arrayBuffer","buffer","Uint8Array","console","error","downloadUrl","Blob","type","a","document","createElement","MouseEvent","download","href","dispatchEvent","remove","handleMouseEnter","clearTimeout","handleMouseLeave","setTimeout","emotion_react_jsx_runtime_browser_esm","BX","div","data-testid","className","onClick","target","currentTarget","tZ","HY","span","right","clsx","ref","data-blob-id","src","alt","draggable","onMouseDown","onMouseMove","onMouseUp","onMouseEnter","onMouseLeave","onLoad","p","button","svg","viewBox","fill","xmlns","path","fillRule","clipRule","d","stopPropagation","Button","icon","ArrowLeftSmallIcon","noBorder","ArrowRightSmallIcon","ViewBarIcon","MinusIcon","toFixed","PlusIcon","DownloadIcon","catch","err","CopyIcon","canvas","context","getContext","warn","drawImage","toBlob","blob","dataUrl","navigator","clipboard","write","ClipboardItem","then","log","DeleteIcon","ImagePreviewModal","handleKeyUp","key","Suspense","fallback"],"sourceRoot":""}