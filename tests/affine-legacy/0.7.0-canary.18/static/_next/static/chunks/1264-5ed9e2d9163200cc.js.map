{"version":3,"file":"static/chunks/1264-5ed9e2d9163200cc.js","mappings":"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","sources":["webpack://_N_E/./src/atoms/public-workspace/index.ts","webpack://_N_E/./src/hooks/current/use-current-mode.ts","webpack://_N_E/./src/hooks/current/use-current-user.ts","webpack://_N_E/./src/hooks/current/use-current-workspace.ts","webpack://_N_E/./src/hooks/use-router-title.ts","webpack://_N_E/./src/hooks/use-workspaces.ts","webpack://_N_E/../../packages/component/src/components/affine-watermark/index.css.ts","webpack://_N_E/../../packages/component/src/components/affine-watermark/logo.tsx","webpack://_N_E/../../packages/component/src/components/affine-watermark/index.tsx","webpack://_N_E/../../packages/workspace/src/affine/channel.ts","webpack://_N_E/../../packages/workspace/src/affine/sync.ts","webpack://_N_E/./src/atoms/history.ts","webpack://_N_E/./src/components/pure/shortcuts-modal/config.ts","webpack://_N_E/./src/components/pure/shortcuts-modal/icons.tsx","webpack://_N_E/./src/components/pure/shortcuts-modal/style.ts","webpack://_N_E/./src/components/pure/shortcuts-modal/index.tsx","webpack://_N_E/./src/components/pure/help-island/icons.tsx","webpack://_N_E/./src/components/pure/help-island/style.ts","webpack://_N_E/./src/components/pure/help-island/index.tsx","webpack://_N_E/../../packages/hooks/src/use-block-suite-page-references.ts","webpack://_N_E/./src/components/pure/workspace-slider-bar/favorite/empty-item.tsx","webpack://_N_E/./src/components/pure/workspace-slider-bar/favorite/styles.css.ts","webpack://_N_E/./src/components/pure/workspace-slider-bar/favorite/favorite-list.tsx","webpack://_N_E/./src/components/pure/workspace-slider-bar/WorkspaceSelector/index.css.ts","webpack://_N_E/./src/components/pure/workspace-slider-bar/WorkspaceSelector/styles.ts","webpack://_N_E/./src/components/pure/workspace-slider-bar/WorkspaceSelector/workspace-selector.tsx","webpack://_N_E/./src/components/pure/workspace-slider-bar/WorkspaceSelector/index.ts","webpack://_N_E/./src/components/root-app-sidebar/index.tsx","webpack://_N_E/./src/layouts/workspace-layout.tsx","webpack://_N_E/./src/hooks/affine/use-affine-log-in.ts","webpack://_N_E/./src/providers/modal-provider.tsx","webpack://_N_E/../../packages/component/src/components/workspace-avatar/index.css.ts","webpack://_N_E/../../packages/component/src/components/workspace-avatar/default-avatar.tsx","webpack://_N_E/../../packages/component/src/components/workspace-avatar/index.tsx","webpack://_N_E/../../packages/env/src/workspace/legacy-cloud/index.ts","webpack://_N_E/../../packages/hooks/src/use-block-suite-workspace-avatar-url.ts","webpack://_N_E/../../packages/hooks/src/use-block-suite-workspace-helper.ts","webpack://_N_E/../../packages/hooks/src/use-block-suite-workspace-name.ts","webpack://_N_E/../../packages/hooks/src/use-block-suite-workspace-page.ts","webpack://_N_E/../../node_modules/@vanilla-extract/webpack-plugin/extracted.js?393f","webpack://_N_E/../../node_modules/@vanilla-extract/webpack-plugin/extracted.js?4029","webpack://_N_E/../../node_modules/@vanilla-extract/webpack-plugin/extracted.js?cb47","webpack://_N_E/../../node_modules/@vanilla-extract/webpack-plugin/extracted.js?07e6","webpack://_N_E/<anon>"],"sourcesContent":["import type { BlockSuiteFeatureFlags } from '@affine/env';\nimport { config } from '@affine/env';\nimport type { AffinePublicWorkspace } from '@affine/env/workspace';\nimport { WorkspaceFlavour } from '@affine/env/workspace';\nimport { affineApis } from '@affine/workspace/affine/shared';\nimport { createEmptyBlockSuiteWorkspace } from '@affine/workspace/utils';\nimport { atom } from 'jotai';\n\nimport { BlockSuiteWorkspace } from '../../shared';\n\nfunction createPublicWorkspace(\n  workspaceId: string,\n  binary: ArrayBuffer,\n  singlePage = false\n): AffinePublicWorkspace {\n  const blockSuiteWorkspace = createEmptyBlockSuiteWorkspace(\n    workspaceId,\n    WorkspaceFlavour.AFFINE,\n    {\n      workspaceApis: affineApis,\n      cachePrefix: WorkspaceFlavour.PUBLIC + (singlePage ? '-single-page' : ''),\n    }\n  );\n  BlockSuiteWorkspace.Y.applyUpdate(\n    blockSuiteWorkspace.doc,\n    new Uint8Array(binary)\n  );\n  Object.entries(config.editorFlags).forEach(([key, value]) => {\n    blockSuiteWorkspace.awarenessStore.setFlag(\n      key as keyof BlockSuiteFeatureFlags,\n      value\n    );\n  });\n  // force disable some features\n  blockSuiteWorkspace.awarenessStore.setFlag('enable_block_hub', false);\n  blockSuiteWorkspace.awarenessStore.setFlag('enable_drag_handle', false);\n  return {\n    flavour: WorkspaceFlavour.PUBLIC,\n    id: workspaceId,\n    blockSuiteWorkspace,\n    // maybe we can add some sync providers here\n    providers: [],\n  };\n}\n\nexport const publicWorkspaceIdAtom = atom<string | null>(null);\nexport const publicWorkspacePageIdAtom = atom<string | null>(null);\nexport const publicPageBlockSuiteAtom = atom<Promise<AffinePublicWorkspace>>(\n  async get => {\n    const workspaceId = get(publicWorkspaceIdAtom);\n    const pageId = get(publicWorkspacePageIdAtom);\n    if (!workspaceId || !pageId) {\n      throw new Error('No workspace id or page id');\n    }\n    const binary = await affineApis.downloadPublicWorkspacePage(\n      workspaceId,\n      pageId\n    );\n    return createPublicWorkspace(workspaceId, binary, true);\n  }\n);\nexport const publicWorkspaceAtom = atom<Promise<AffinePublicWorkspace>>(\n  async get => {\n    const workspaceId = get(publicWorkspaceIdAtom);\n    if (!workspaceId) {\n      throw new Error('No workspace id');\n    }\n    const binary = await affineApis.downloadWorkspace(workspaceId, true);\n    return createPublicWorkspace(workspaceId, binary, false);\n  }\n);\n","import { rootCurrentPageIdAtom } from '@affine/workspace/atom';\nimport { atom, useAtomValue } from 'jotai';\n\nimport { pageSettingFamily } from '../../atoms';\n\nconst currentModeAtom = atom<'page' | 'edgeless'>(get => {\n  const pageId = get(rootCurrentPageIdAtom);\n  // fixme(himself65): pageId should not be null\n  if (!pageId) {\n    return 'page';\n  }\n  return get(pageSettingFamily(pageId))?.mode ?? 'page';\n});\n\nexport const useCurrentMode = () => {\n  return useAtomValue(currentModeAtom);\n};\n","import { currentAffineUserAtom } from '@affine/workspace/affine/atom';\nimport type { AccessTokenMessage } from '@affine/workspace/affine/login';\nimport { useAtomValue } from 'jotai';\n\nexport function useCurrentUser(): AccessTokenMessage | null {\n  return useAtomValue(currentAffineUserAtom);\n}\n","import {\n  rootCurrentPageIdAtom,\n  rootCurrentWorkspaceIdAtom,\n} from '@affine/workspace/atom';\nimport { useAtom, useAtomValue } from 'jotai';\nimport { useCallback } from 'react';\n\nimport { rootCurrentWorkspaceAtom } from '../../atoms/root';\nimport type { AllWorkspace } from '../../shared';\n\nexport function useCurrentWorkspace(): [\n  AllWorkspace,\n  (id: string | null) => void\n] {\n  const currentWorkspace = useAtomValue(rootCurrentWorkspaceAtom);\n  const [, setId] = useAtom(rootCurrentWorkspaceIdAtom);\n  const [, setPageId] = useAtom(rootCurrentPageIdAtom);\n  return [\n    currentWorkspace,\n    useCallback(\n      (id: string | null) => {\n        if (typeof window !== 'undefined' && id) {\n          localStorage.setItem('last_workspace_id', id);\n        }\n        setPageId(null);\n        setId(id);\n      },\n      [setId, setPageId]\n    ),\n  ];\n}\n","import type { NextRouter } from 'next/router';\nimport { useMemo } from 'react';\n\nimport { WorkspaceSubPathName } from '../shared';\n\nexport function useRouterTitle(router: NextRouter) {\n  return useMemo(() => {\n    if (!router.isReady) {\n      return 'Loading...';\n    } else {\n      if (\n        !router.query.pageId &&\n        router.pathname.startsWith('/workspace/[workspaceId]/')\n      ) {\n        const subPath = router.pathname.split('/').at(-1);\n        if (subPath && subPath in WorkspaceSubPathName) {\n          return (\n            WorkspaceSubPathName[subPath as keyof typeof WorkspaceSubPathName] +\n            ' - AFFiNE'\n          );\n        }\n      }\n      return 'AFFiNE';\n    }\n  }, [router]);\n}\n","import { DebugLogger } from '@affine/debug';\nimport type { LocalWorkspace } from '@affine/env/workspace';\nimport { WorkspaceFlavour } from '@affine/env/workspace';\nimport { rootWorkspacesMetadataAtom } from '@affine/workspace/atom';\nimport { saveWorkspaceToLocalStorage } from '@affine/workspace/local/crud';\nimport { createEmptyBlockSuiteWorkspace } from '@affine/workspace/utils';\nimport { nanoid } from '@blocksuite/store';\nimport { useAtomValue, useSetAtom } from 'jotai';\nimport { useCallback } from 'react';\n\nimport { LocalAdapter } from '../adapters/local';\nimport { WorkspaceAdapters } from '../adapters/workspace';\nimport { workspacesAtom } from '../atoms';\nimport type { AllWorkspace } from '../shared';\n\nexport function useWorkspaces(): AllWorkspace[] {\n  return useAtomValue(workspacesAtom);\n}\n\nconst logger = new DebugLogger('use-workspaces');\n\n/**\n * This hook has the permission to all workspaces. Be careful when using it.\n */\nexport function useAppHelper() {\n  const workspaces = useWorkspaces();\n  const jotaiWorkspaces = useAtomValue(rootWorkspacesMetadataAtom);\n  const set = useSetAtom(rootWorkspacesMetadataAtom);\n  return {\n    createWorkspacePage: useCallback(\n      (workspaceId: string, pageId: string) => {\n        const workspace = workspaces.find(\n          ws => ws.id === workspaceId\n        ) as LocalWorkspace;\n        if (workspace && 'blockSuiteWorkspace' in workspace) {\n          workspace.blockSuiteWorkspace.createPage({ id: pageId });\n        } else {\n          throw new Error('cannot create page. blockSuiteWorkspace not found');\n        }\n      },\n      [workspaces]\n    ),\n    addLocalWorkspace: useCallback(\n      async (workspaceId: string): Promise<string> => {\n        saveWorkspaceToLocalStorage(workspaceId);\n        set(workspaces => [\n          ...workspaces,\n          {\n            id: workspaceId,\n            flavour: WorkspaceFlavour.LOCAL,\n          },\n        ]);\n        logger.debug('imported local workspace', workspaceId);\n        return workspaceId;\n      },\n      [set]\n    ),\n    createLocalWorkspace: useCallback(\n      async (name: string): Promise<string> => {\n        const blockSuiteWorkspace = createEmptyBlockSuiteWorkspace(\n          nanoid(),\n          WorkspaceFlavour.LOCAL\n        );\n        blockSuiteWorkspace.meta.setName(name);\n        const id = await LocalAdapter.CRUD.create(blockSuiteWorkspace);\n        set(workspaces => [\n          ...workspaces,\n          {\n            id,\n            flavour: WorkspaceFlavour.LOCAL,\n          },\n        ]);\n        logger.debug('created local workspace', id);\n        return id;\n      },\n      [set]\n    ),\n    deleteWorkspace: useCallback(\n      async (workspaceId: string) => {\n        const targetJotaiWorkspace = jotaiWorkspaces.find(\n          ws => ws.id === workspaceId\n        );\n        const targetWorkspace = workspaces.find(ws => ws.id === workspaceId);\n        if (!targetJotaiWorkspace || !targetWorkspace) {\n          throw new Error('page cannot be found');\n        }\n\n        // delete workspace from plugin\n        await WorkspaceAdapters[targetWorkspace.flavour].CRUD.delete(\n          // fixme: type casting\n          targetWorkspace as any\n        );\n        // delete workspace from jotai storage\n        set(workspaces => workspaces.filter(ws => ws.id !== workspaceId));\n      },\n      [jotaiWorkspaces, set, workspaces]\n    ),\n  };\n}\n","import \"../../packages/component/src/components/affine-watermark/index.css.ts.vanilla.css!=!../../../../../node_modules/@vanilla-extract/webpack-plugin/virtualFileLoader/dist/vanilla-extract-webpack-plugin-virtualFileLoader.cjs.js?{\\\"fileName\\\":\\\"../../packages/component/src/components/affine-watermark/index.css.ts.vanilla.css\\\",\\\"source\\\":\\\"Ll8xNmZzM3dpMCB7CiAgZGlzcGxheTogbm9uZTsKfQouXzE2ZnMzd2kxIHsKICB0ZXh0LWFsaWduOiBsZWZ0OwogIGNvbG9yOiBibGFjazsKICBkaXNwbGF5OiBmbGV4OwogIGZsZXgtZGlyZWN0aW9uOiByb3c7CiAganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDsKICBhbGlnbi1pdGVtczogY2VudGVyOwogIHdpZHRoOiAyMDBweDsKfQouXzE2ZnMzd2kyIHsKICB3aGl0ZS1zcGFjZTogbm93cmFwOwp9Ci5fMTZmczN3aTMgewogIGZvbnQtc2l6ZTogMjBweDsKfQpAbWVkaWEgcHJpbnQgewogIC5fMTZmczN3aTAgewogICAgcG9zaXRpb246IGZpeGVkOwogICAgYm90dG9tOiAwOwogICAgcmlnaHQ6IDIwcHg7CiAgICB6LWluZGV4OiAxMDA7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIHdpZHRoOiBhdXRvOwogICAgZmlsdGVyOiBvcGFjaXR5KDIwJSk7CiAgfQp9\\\"}!../../../../../node_modules/@vanilla-extract/webpack-plugin/extracted.js\"\nexport var iconStyle = '_16fs3wi3';\nexport var linkStyle = '_16fs3wi1';\nexport var linkTextStyle = '_16fs3wi2';\nexport var waterMarkStyle = '_16fs3wi0';","export const AffineLogoIcon = () => {\n  return (\n    <svg\n      id=\"Layer_2\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      viewBox=\"0 0 1459.61 470\"\n    >\n      <g id=\"_6_export\">\n        <path\n          id=\"logo-black\"\n          d=\"m404.14,350.34c-5.95-10.33-15.86-27.48-25.65-44.42-2.97-5.14-5.92-10.25-8.75-15.15-5.82-10.08-11.12-19.27-14.9-25.83-26.23-45.33-77.87-135.08-103.67-179.46-7.95-12.37-26.37-11.39-33.21,1.42-7.76,13.45-16.3,28.24-25.32,43.87-2.86,4.96-5.78,10.01-8.73,15.12-37.58,65.08-81.56,141.26-112.89,195.52-1.6,2.9-4.58,7.63-6.07,10.76-2.61,5.65-2.1,12.69,1.19,17.91,3.71,6.18,10.65,9.57,17.74,9.22,8.53,0,26.62-.01,50.01,0,5.55,0,11.4,0,17.49,0,81.33,0,205.57.05,236.06,0,14.81.03,24.1-16.21,16.72-28.97Zm-175.07-57.64l-14.97-25.93c-2.63-4.56.66-10.26,5.92-10.26h29.94c5.27,0,8.56,5.7,5.92,10.26l-14.97,25.93c-2.63,4.56-9.21,4.56-11.85,0Zm-25.08-48.29c-1.24-3.16-2.31-6.37-3.19-9.63l49.53,9.63h-46.34Zm22.62,68.22c-2.11,2.66-4.36,5.19-6.74,7.59l-16.43-47.71,23.16,40.12Zm47.78-53.7c3.35.5,6.67,1.19,9.93,2.05l-33.1,38.08,23.17-40.13Zm-76.64-40.4c-.53-4.82-.76-9.69-.74-14.57l65.41,31.91-64.68-17.33Zm-7.76,47.77l17.32,64.65c-3.91,2.87-8.01,5.51-12.25,7.93l-5.08-72.58Zm109.93.17c4.44,1.95,8.77,4.19,12.99,6.65l-60.34,40.7,47.35-47.35Zm-101.41-83.09c1.2-8.86,3.05-17.59,5.29-25.96l99.37,86.38-104.65-60.42Zm-22.02,164.51c-8.27,3.39-16.75,6.15-25.12,8.39l25.12-129.23v120.84Zm153.49-63.19c7.07,5.47,13.71,11.44,19.84,17.56l-124.49,42.86,104.65-60.42Zm-90.64-175.85c18.32,31.79,44.92,77.89,70.26,121.77l-94.61-94.61c5.56-9.62,10.83-18.75,15.69-27.18,1.93-3.33,6.73-3.33,8.66,0Zm-147.77,240.92c5.21-8.99,12.37-21.32,13.96-24.16,15.08-26.12,35.39-61.29,56.37-97.63l-34.65,129.3c-12.41,0-23.11,0-31.35,0-3.85,0-6.26-4.17-4.33-7.5Zm282.54,7.53c-28.89,0-84.98,0-140.67,0l129.31-34.65c6.78,11.74,12.21,21.14,15.69,27.16,1.93,3.33-.48,7.49-4.32,7.49Z\"\n        />\n        <rect fill=\"none\" width=\"1459.61\" height=\"470\" />\n        <path d=\"m594.24,116.6c-1.17-4.72-5.41-8.03-10.27-8.03h-16.41c-4.86,0-9.1,3.31-10.27,8.03l-55.64,224.39c-1.65,6.67,3.39,13.12,10.27,13.12h5.66c4.92,0,9.19-3.39,10.3-8.18l11.85-50.91c1.11-4.79,5.38-8.18,10.3-8.18h51.46c4.92,0,9.19,3.39,10.3,8.18l11.85,50.91c1.11,4.79,5.38,8.18,10.3,8.18h5.66c6.87,0,11.92-6.45,10.27-13.12l-55.64-224.39Zm-3.15,146.69h-30.65c-6.81,0-11.85-6.34-10.3-12.97l20.48-98.57c1.27-5.45,9.03-5.45,10.3,0l20.48,98.57c1.54,6.63-3.49,12.97-10.3,12.97Z\" />\n        <path d=\"m994.58,215.86h-126.97c-5.84,0-10.58-4.74-10.58-10.58v-53.08c0-11.1,9-20.1,20.1-20.1h62.83c5.84,0,10.58-4.74,10.58-10.58v-2.39c0-5.84-4.74-10.58-10.58-10.58h-70.32c-22.2,0-40.19,18-40.19,40.19v67.1h-113.04c-5.84,0-10.58-4.74-10.58-10.58v-53.08c0-11.1,9-20.1,20.1-20.1h62.83c5.84,0,10.58-4.74,10.58-10.58v-2.39c0-5.84-4.74-10.58-10.58-10.58h-70.32c-22.2,0-40.19,18-40.19,40.19v194.77c0,5.84,4.74,10.58,10.58,10.58h6.43c5.84,0,10.58-4.74,10.58-10.58v-93.54c0-5.84,4.74-10.58,10.58-10.58h113.04v104.12c0,5.84,4.74,10.58,10.58,10.58h6.43c5.84,0,10.58-4.74,10.58-10.58v-93.54c0-5.84,4.74-10.58,10.58-10.58h120.16c11.1,0,20.1,9,20.1,20.1v84.14c0,5.84,4.74,10.58,10.58,10.58h5.75c5.84,0,10.58-4.74,10.58-10.58v-87.59c0-22.2-18-40.19-40.19-40.19Z\" />\n        <path d=\"m1202.87,108.57h-5.79c-5.83,0-10.56,4.72-10.58,10.54l-.64,201.36-57.7-204.2c-1.29-4.56-5.44-7.7-10.18-7.7h-25.15c-5.84,0-10.58,4.74-10.58,10.58v224.39c0,5.84,4.74,10.58,10.58,10.58h5.79c5.83,0,10.56-4.72,10.58-10.54l.64-201.36,57.7,204.2c1.29,4.56,5.44,7.7,10.18,7.7h25.15c5.84,0,10.58-4.74,10.58-10.58V119.14c0-5.84-4.74-10.58-10.58-10.58Z\" />\n        <path d=\"m1293.92,132.11h59.81c5.84,0,10.58-4.74,10.58-10.58v-2.39c0-5.84-4.74-10.58-10.58-10.58h-66.95c-22.2,0-40.19,18-40.19,40.19v165.15c0,22.2,18,40.19,40.19,40.19h66.95c5.84,0,10.58-4.74,10.58-10.58v-2.39c0-5.84-4.74-10.58-10.58-10.58h-59.81c-11.1,0-20.1-9-20.1-20.1v-63.84c0-5.84,4.74-10.58,10.58-10.58h65.96c5.84,0,10.58-4.74,10.58-10.58v-2.39c0-5.84-4.74-10.58-10.58-10.58h-65.96c-5.84,0-10.58-4.74-10.58-10.58v-49.72c0-11.1,9-20.1,20.1-20.1Z\" />\n        <path d=\"m1018.67,138.5c-4.7-4.7-12.71-2.55-14.43,3.87l-7.77,29.01c-1.72,6.41,4.15,12.28,10.57,10.57l29.01-7.77c6.42-1.72,8.56-9.74,3.87-14.43l-21.23-21.23Z\" />\n      </g>\n    </svg>\n  );\n};\n","import { useAFFiNEI18N } from '@affine/i18n/hooks';\nimport clsx from 'clsx';\n\nimport { linkStyle, linkTextStyle, waterMarkStyle } from './index.css';\nimport { AffineLogoIcon } from './logo';\n\nexport const AffineWatermark = () => {\n  const t = useAFFiNEI18N();\n  return (\n    <div className={clsx()}>\n      <div data-testid=\"affine-watermark\" className={clsx(waterMarkStyle)}>\n        <a className={linkStyle} href=\"https://affine.pro\">\n          <div className={linkTextStyle}>{t['Created with']()}</div>\n          <AffineLogoIcon />\n        </a>\n      </div>\n    </div>\n  );\n};\n","import { DebugLogger } from '@affine/debug';\nimport { WorkspaceFlavour } from '@affine/env/workspace';\nimport { assertExists } from '@blocksuite/global/utils';\nimport * as url from 'lib0/url';\nimport * as websocket from 'lib0/websocket';\n\nimport { getLoginStorage, isExpired, parseIdToken } from '../affine/login';\nimport { cleanupWorkspace } from '../utils';\n\nconst RECONNECT_INTERVAL_TIME = 500;\nconst MAX_RECONNECT_TIMES = 50;\n\nexport class WebsocketClient {\n  public readonly baseServerUrl: string;\n  private _client: websocket.WebsocketClient | null = null;\n  public shouldReconnect = false;\n  private _retryTimes = 0;\n  private _logger = new DebugLogger('affine:channel');\n  private _callback: ((message: any) => void) | null = null;\n\n  constructor(serverUrl: string) {\n    while (serverUrl.endsWith('/')) {\n      serverUrl = serverUrl.slice(0, serverUrl.length - 1);\n    }\n    this.baseServerUrl = serverUrl;\n  }\n\n  public connect(callback: (message: any) => void) {\n    const loginResponse = getLoginStorage();\n    if (!loginResponse || isExpired(parseIdToken(loginResponse.token))) {\n      cleanupWorkspace(WorkspaceFlavour.AFFINE);\n      return;\n    }\n    assertExists(loginResponse, 'loginResponse is null');\n    const encodedParams = url.encodeQueryParams({\n      token: loginResponse.token,\n    });\n    const serverUrl =\n      this.baseServerUrl +\n      (encodedParams.length === 0 ? '' : '?' + encodedParams);\n    this._client = new websocket.WebsocketClient(serverUrl);\n    this._callback = callback;\n    this._setupChannel();\n\n    this._client.on('message', this._callback);\n  }\n\n  public disconnect() {\n    assertExists(this._client, 'client is null');\n    if (this._callback) {\n      this._client.off('message', this._callback);\n    }\n    this._client.disconnect();\n    this._client.destroy();\n    this._client = null;\n  }\n\n  private _setupChannel() {\n    assertExists(this._client, 'client is null');\n    const client = this._client;\n    client.on('connect', () => {\n      this._logger.debug('Affine channel connected');\n      this.shouldReconnect = true;\n      this._retryTimes = 0;\n    });\n\n    client.on('disconnect', ({ error }: { error: Error }) => {\n      if (error) {\n        const loginResponse = getLoginStorage();\n        const isLogin = loginResponse\n          ? isExpired(parseIdToken(loginResponse.token))\n          : false;\n        // Try to re-connect if connect error has occurred\n        if (this.shouldReconnect && isLogin && !client.connected) {\n          try {\n            setTimeout(() => {\n              if (this._retryTimes <= MAX_RECONNECT_TIMES) {\n                assertExists(this._callback, 'callback is null');\n                this.connect(this._callback);\n                this._logger.info(\n                  `try reconnect channel ${++this._retryTimes} times`\n                );\n              } else {\n                this._logger.error(\n                  'reconnect failed, max reconnect times reached'\n                );\n              }\n            }, RECONNECT_INTERVAL_TIME);\n          } catch (e) {\n            this._logger.error('reconnect failed', e);\n          }\n        }\n      }\n    });\n  }\n}\n","import { DebugLogger } from '@affine/debug';\nimport { websocketPrefixUrl } from '@affine/env/api';\nimport type { WorkspaceCRUD } from '@affine/env/workspace';\nimport type { WorkspaceFlavour } from '@affine/env/workspace';\nimport {\n  workspaceDetailSchema,\n  workspaceSchema,\n} from '@affine/env/workspace/legacy-cloud';\nimport { assertExists } from '@blocksuite/global/utils';\nimport type { Disposable } from '@blocksuite/store';\nimport { rootStore } from '@toeverything/plugin-infra/manager';\nimport { z } from 'zod';\n\nimport { WebsocketClient } from '../affine/channel';\nimport { storageChangeSlot } from '../affine/login';\nimport { rootWorkspacesMetadataAtom } from '../atom';\n\nconst logger = new DebugLogger('affine-sync');\n\nconst channelMessageSchema = z.object({\n  ws_list: z.array(workspaceSchema),\n  ws_details: z.record(workspaceDetailSchema),\n  metadata: z.record(\n    z.object({\n      search_index: z.array(z.string()),\n      name: z.string(),\n    })\n  ),\n});\n\ntype ChannelMessage = z.infer<typeof channelMessageSchema>;\n\nexport function createAffineGlobalChannel(\n  crud: WorkspaceCRUD<WorkspaceFlavour.AFFINE>\n) {\n  let client: WebsocketClient | null;\n\n  async function handleMessage(channelMessage: ChannelMessage) {\n    logger.debug('channelMessage', channelMessage);\n    const parseResult = channelMessageSchema.safeParse(channelMessage);\n    if (!parseResult.success) {\n      console.error(\n        'channelMessageSchema.safeParse(channelMessage) failed',\n        parseResult\n      );\n    }\n    const { ws_details } = channelMessage;\n    const currentWorkspaces = await crud.list();\n    for (const [id] of Object.entries(ws_details)) {\n      const workspaceIndex = currentWorkspaces.findIndex(\n        workspace => workspace.id === id\n      );\n\n      // If the workspace is not in the current workspace list, remove it\n      if (workspaceIndex === -1) {\n        rootStore.set(rootWorkspacesMetadataAtom, workspaces => {\n          const idx = workspaces.findIndex(workspace => workspace.id === id);\n          workspaces.splice(idx, 1);\n          return [...workspaces];\n        });\n      }\n    }\n  }\n  let dispose: Disposable | undefined = undefined;\n  const apis = {\n    connect: () => {\n      client = new WebsocketClient(websocketPrefixUrl + '/api/global/sync/');\n      client.connect(handleMessage);\n      dispose = storageChangeSlot.on(() => {\n        apis.disconnect();\n        apis.connect();\n      });\n    },\n    disconnect: () => {\n      assertExists(client, 'client is null');\n      client.disconnect();\n      dispose?.dispose();\n      client = null;\n    },\n  };\n\n  return apis;\n}\n","import { atom, useAtom, useSetAtom } from 'jotai';\nimport { useRouter } from 'next/router';\nimport { useCallback, useEffect } from 'react';\n\nexport type History = {\n  stack: string[];\n  current: number;\n  skip: boolean;\n};\n\nexport const MAX_HISTORY = 50;\n\nexport const historyBaseAtom = atom<History>({\n  stack: [],\n  current: 0,\n  skip: false,\n});\n\n// fixme(himself65): don't use hooks, use atom lifecycle instead\nexport function useTrackRouterHistoryEffect() {\n  const setBase = useSetAtom(historyBaseAtom);\n  const router = useRouter();\n  useEffect(() => {\n    const callback = (url: string) => {\n      setBase(prev => {\n        console.log('push', url, prev.skip, prev.stack.length, prev.current);\n        if (prev.skip) {\n          return {\n            stack: [...prev.stack],\n            current: prev.current,\n            skip: false,\n          };\n        } else {\n          if (prev.current < prev.stack.length - 1) {\n            const newStack = prev.stack.slice(0, prev.current);\n            newStack.push(url);\n            if (newStack.length > MAX_HISTORY) {\n              newStack.shift();\n            }\n            return {\n              stack: newStack,\n              current: newStack.length - 1,\n              skip: false,\n            };\n          } else {\n            const newStack = [...prev.stack, url];\n            if (newStack.length > MAX_HISTORY) {\n              newStack.shift();\n            }\n            return {\n              stack: newStack,\n              current: newStack.length - 1,\n              skip: false,\n            };\n          }\n        }\n      });\n    };\n\n    router.events.on('routeChangeComplete', callback);\n    return () => {\n      router.events.off('routeChangeComplete', callback);\n    };\n  }, [router.events, setBase]);\n}\n\nexport function useHistoryAtom() {\n  const router = useRouter();\n  const [base, setBase] = useAtom(historyBaseAtom);\n  return [\n    base,\n    useCallback(\n      (forward: boolean) => {\n        setBase(prev => {\n          if (forward) {\n            const target = Math.min(prev.stack.length - 1, prev.current + 1);\n            const url = prev.stack[target];\n            router.push(url).catch(err => {\n              console.error(err);\n            });\n            return {\n              ...prev,\n              current: target,\n              skip: true,\n            };\n          } else {\n            const target = Math.max(0, prev.current - 1);\n            const url = prev.stack[target];\n            router.push(url).catch(err => {\n              console.error(err);\n            });\n            return {\n              ...prev,\n              current: target,\n              skip: true,\n            };\n          }\n        });\n      },\n      [router, setBase]\n    ),\n  ] as const;\n}\n","import { useAFFiNEI18N } from '@affine/i18n/hooks';\n\ninterface ShortcutTip {\n  [x: string]: string;\n}\nexport const useMacKeyboardShortcuts = (): ShortcutTip => {\n  const t = useAFFiNEI18N();\n  return {\n    [t['Undo']()]: '⌘+Z',\n    [t['Redo']()]: '⌘+⇧+Z',\n    [t['Bold']()]: '⌘+B',\n    [t['Italic']()]: '⌘+I',\n    [t['Underline']()]: '⌘+U',\n    [t['Strikethrough']()]: '⌘+⇧+S',\n    [t['Inline code']()]: ' ⌘+E',\n    [t['Code block']()]: '⌘+⌥+C',\n    [t['Link']()]: '⌘+K',\n    [t['Quick search']()]: '⌘+K',\n    [t['Body text']()]: '⌘+⌥+0',\n    [t['Heading']({ number: '1' })]: '⌘+⌥+1',\n    [t['Heading']({ number: '2' })]: '⌘+⌥+2',\n    [t['Heading']({ number: '3' })]: '⌘+⌥+3',\n    [t['Heading']({ number: '4' })]: '⌘+⌥+4',\n    [t['Heading']({ number: '5' })]: '⌘+⌥+5',\n    [t['Heading']({ number: '6' })]: '⌘+⌥+6',\n    [t['Increase indent']()]: 'Tab',\n    [t['Reduce indent']()]: '⇧+Tab',\n  };\n};\n\nexport const useMacMarkdownShortcuts = (): ShortcutTip => {\n  const t = useAFFiNEI18N();\n  return {\n    [t['Bold']()]: '**Text** ',\n    [t['Italic']()]: '*Text* ',\n    [t['Underline']()]: '~Text~ ',\n    [t['Strikethrough']()]: '~~Text~~ ',\n    [t['Divider']()]: '***',\n    [t['Inline code']()]: '`Text` ',\n    [t['Code block']()]: '``` Space',\n    [t['Heading']({ number: '1' })]: '# Text',\n    [t['Heading']({ number: '2' })]: '## Text',\n    [t['Heading']({ number: '3' })]: '### Text',\n    [t['Heading']({ number: '4' })]: '#### Text',\n    [t['Heading']({ number: '5' })]: '##### Text',\n    [t['Heading']({ number: '6' })]: '###### Text',\n  };\n};\n\nexport const useWindowsKeyboardShortcuts = (): ShortcutTip => {\n  const t = useAFFiNEI18N();\n  return {\n    [t['Undo']()]: 'Ctrl+Z',\n    [t['Redo']()]: 'Ctrl+Y',\n    [t['Bold']()]: 'Ctrl+B',\n    [t['Italic']()]: 'Ctrl+I',\n    [t['Underline']()]: 'Ctrl+U',\n    [t['Strikethrough']()]: 'Ctrl+Shift+S',\n    [t['Inline code']()]: ' Ctrl+E',\n    [t['Code block']()]: 'Ctrl+Alt+C',\n    [t['Link']()]: 'Ctrl+K',\n    [t['Quick search']()]: 'Ctrl+K',\n    [t['Body text']()]: 'Ctrl+Shift+0',\n    [t['Heading']({ number: '1' })]: 'Ctrl+Shift+1',\n    [t['Heading']({ number: '2' })]: 'Ctrl+Shift+2',\n    [t['Heading']({ number: '3' })]: 'Ctrl+Shift+3',\n    [t['Heading']({ number: '4' })]: 'Ctrl+Shift+4',\n    [t['Heading']({ number: '5' })]: 'Ctrl+Shift+5',\n    [t['Heading']({ number: '6' })]: 'Ctrl+Shift+6',\n    [t['Increase indent']()]: 'Tab',\n    [t['Reduce indent']()]: 'Shift+Tab',\n  };\n};\nexport const useWinMarkdownShortcuts = (): ShortcutTip => {\n  const t = useAFFiNEI18N();\n  return {\n    [t['Bold']()]: '**Text** ',\n    [t['Italic']()]: '*Text* ',\n    [t['Underline']()]: '~Text~ ',\n    [t['Strikethrough']()]: '~~Text~~ ',\n    [t['Divider']()]: '***',\n    [t['Inline code']()]: '`Text` ',\n    [t['Code block']()]: '``` Text',\n    [t['Heading']({ number: '1' })]: '# Text',\n    [t['Heading']({ number: '2' })]: '## Text',\n    [t['Heading']({ number: '3' })]: '### Text',\n    [t['Heading']({ number: '4' })]: '#### Text',\n    [t['Heading']({ number: '5' })]: '##### Text',\n    [t['Heading']({ number: '6' })]: '###### Text',\n  };\n};\n","export const CloseIcon = () => {\n  return (\n    <svg\n      width=\"14\"\n      height=\"14\"\n      viewBox=\"0 0 14 14\"\n      fill=\"currentColor\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <path d=\"M7.94 7.00014L13.4667 1.47348C13.5759 1.34594 13.633 1.18189 13.6265 1.01411C13.62 0.846324 13.5504 0.687165 13.4317 0.568435C13.313 0.449706 13.1538 0.38015 12.986 0.37367C12.8183 0.367189 12.6542 0.42426 12.5267 0.533477L7 6.06014L1.47334 0.526811C1.3478 0.401275 1.17754 0.33075 1 0.33075C0.822468 0.33075 0.652205 0.401275 0.526669 0.526811C0.401133 0.652346 0.330608 0.82261 0.330608 1.00014C0.330608 1.17768 0.401133 1.34794 0.526669 1.47348L6.06 7.00014L0.526669 12.5268C0.456881 12.5866 0.400201 12.6601 0.360186 12.7428C0.32017 12.8255 0.297683 12.9156 0.294137 13.0074C0.290591 13.0993 0.306061 13.1908 0.339577 13.2764C0.373094 13.3619 0.423932 13.4396 0.488902 13.5046C0.553872 13.5695 0.63157 13.6204 0.71712 13.6539C0.80267 13.6874 0.894225 13.7029 0.986038 13.6993C1.07785 13.6958 1.16794 13.6733 1.25065 13.6333C1.33336 13.5933 1.4069 13.5366 1.46667 13.4668L7 7.94014L12.5267 13.4668C12.6542 13.576 12.8183 13.6331 12.986 13.6266C13.1538 13.6201 13.313 13.5506 13.4317 13.4319C13.5504 13.3131 13.62 13.154 13.6265 12.9862C13.633 12.8184 13.5759 12.6543 13.4667 12.5268L7.94 7.00014Z\" />\n    </svg>\n  );\n};\n\nexport const KeyboardIcon = () => {\n  return (\n    <svg\n      width=\"20\"\n      height=\"15\"\n      viewBox=\"0 0 20 15\"\n      fill=\"currentColor\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <path d=\"M17.745 0C18.3417 0 18.914 0.237053 19.336 0.65901C19.7579 1.08097 19.995 1.65326 19.995 2.25V11.755C19.995 12.3517 19.7579 12.924 19.336 13.346C18.914 13.7679 18.3417 14.005 17.745 14.005H2.25C1.95453 14.005 1.66194 13.9468 1.38896 13.8337C1.11598 13.7207 0.867941 13.5549 0.65901 13.346C0.450078 13.1371 0.284344 12.889 0.171271 12.616C0.058198 12.3431 0 12.0505 0 11.755V2.25C0 1.65326 0.237053 1.08097 0.65901 0.65901C1.08097 0.237053 1.65326 0 2.25 0H17.745ZM17.745 1.5H2.25C2.05109 1.5 1.86032 1.57902 1.71967 1.71967C1.57902 1.86032 1.5 2.05109 1.5 2.25V11.755C1.5 12.169 1.836 12.505 2.25 12.505H17.745C17.9439 12.505 18.1347 12.426 18.2753 12.2853C18.416 12.1447 18.495 11.9539 18.495 11.755V2.25C18.495 2.05109 18.416 1.86032 18.2753 1.71967C18.1347 1.57902 17.9439 1.5 17.745 1.5ZM4.75 9.5H15.25C15.44 9.50006 15.6229 9.57224 15.7618 9.70197C15.9006 9.8317 15.9851 10.0093 15.998 10.1989C16.011 10.3885 15.9515 10.5759 15.8316 10.7233C15.7117 10.8707 15.5402 10.9671 15.352 10.993L15.25 11H4.75C4.55998 10.9999 4.37706 10.9278 4.23821 10.798C4.09936 10.6683 4.01493 10.4907 4.00197 10.3011C3.98902 10.1115 4.04852 9.92411 4.16843 9.7767C4.28835 9.62929 4.45975 9.5329 4.648 9.507L4.75 9.5H15.25H4.75ZM14.5 6C14.7652 6 15.0196 6.10536 15.2071 6.29289C15.3946 6.48043 15.5 6.73478 15.5 7C15.5 7.26522 15.3946 7.51957 15.2071 7.70711C15.0196 7.89464 14.7652 8 14.5 8C14.2348 8 13.9804 7.89464 13.7929 7.70711C13.6054 7.51957 13.5 7.26522 13.5 7C13.5 6.73478 13.6054 6.48043 13.7929 6.29289C13.9804 6.10536 14.2348 6 14.5 6ZM8.505 6C8.77022 6 9.02457 6.10536 9.21211 6.29289C9.39964 6.48043 9.505 6.73478 9.505 7C9.505 7.26522 9.39964 7.51957 9.21211 7.70711C9.02457 7.89464 8.77022 8 8.505 8C8.23978 8 7.98543 7.89464 7.79789 7.70711C7.61036 7.51957 7.505 7.26522 7.505 7C7.505 6.73478 7.61036 6.48043 7.79789 6.29289C7.98543 6.10536 8.23978 6 8.505 6ZM5.505 6C5.77022 6 6.02457 6.10536 6.21211 6.29289C6.39964 6.48043 6.505 6.73478 6.505 7C6.505 7.26522 6.39964 7.51957 6.21211 7.70711C6.02457 7.89464 5.77022 8 5.505 8C5.23978 8 4.98543 7.89464 4.79789 7.70711C4.61036 7.51957 4.505 7.26522 4.505 7C4.505 6.73478 4.61036 6.48043 4.79789 6.29289C4.98543 6.10536 5.23978 6 5.505 6ZM11.505 6C11.7702 6 12.0246 6.10536 12.2121 6.29289C12.3996 6.48043 12.505 6.73478 12.505 7C12.505 7.26522 12.3996 7.51957 12.2121 7.70711C12.0246 7.89464 11.7702 8 11.505 8C11.2398 8 10.9854 7.89464 10.7979 7.70711C10.6104 7.51957 10.505 7.26522 10.505 7C10.505 6.73478 10.6104 6.48043 10.7979 6.29289C10.9854 6.10536 11.2398 6 11.505 6ZM4 3C4.26522 3 4.51957 3.10536 4.70711 3.29289C4.89464 3.48043 5 3.73478 5 4C5 4.26522 4.89464 4.51957 4.70711 4.70711C4.51957 4.89464 4.26522 5 4 5C3.73478 5 3.48043 4.89464 3.29289 4.70711C3.10536 4.51957 3 4.26522 3 4C3 3.73478 3.10536 3.48043 3.29289 3.29289C3.48043 3.10536 3.73478 3 4 3ZM6.995 3C7.26022 3 7.51457 3.10536 7.70211 3.29289C7.88964 3.48043 7.995 3.73478 7.995 4C7.995 4.26522 7.88964 4.51957 7.70211 4.70711C7.51457 4.89464 7.26022 5 6.995 5C6.72978 5 6.47543 4.89464 6.28789 4.70711C6.10036 4.51957 5.995 4.26522 5.995 4C5.995 3.73478 6.10036 3.48043 6.28789 3.29289C6.47543 3.10536 6.72978 3 6.995 3ZM9.995 3C10.2602 3 10.5146 3.10536 10.7021 3.29289C10.8896 3.48043 10.995 3.73478 10.995 4C10.995 4.26522 10.8896 4.51957 10.7021 4.70711C10.5146 4.89464 10.2602 5 9.995 5C9.72978 5 9.47543 4.89464 9.28789 4.70711C9.10036 4.51957 8.995 4.26522 8.995 4C8.995 3.73478 9.10036 3.48043 9.28789 3.29289C9.47543 3.10536 9.72978 3 9.995 3ZM12.995 3C13.2602 3 13.5146 3.10536 13.7021 3.29289C13.8896 3.48043 13.995 3.73478 13.995 4C13.995 4.26522 13.8896 4.51957 13.7021 4.70711C13.5146 4.89464 13.2602 5 12.995 5C12.7298 5 12.4754 4.89464 12.2879 4.70711C12.1004 4.51957 11.995 4.26522 11.995 4C11.995 3.73478 12.1004 3.48043 12.2879 3.29289C12.4754 3.10536 12.7298 3 12.995 3ZM15.995 3C16.2602 3 16.5146 3.10536 16.7021 3.29289C16.8896 3.48043 16.995 3.73478 16.995 4C16.995 4.26522 16.8896 4.51957 16.7021 4.70711C16.5146 4.89464 16.2602 5 15.995 5C15.7298 5 15.4754 4.89464 15.2879 4.70711C15.1004 4.51957 14.995 4.26522 14.995 4C14.995 3.73478 15.1004 3.48043 15.2879 3.29289C15.4754 3.10536 15.7298 3 15.995 3Z\" />\n    </svg>\n  );\n};\n","import { displayFlex, styled } from '@affine/component';\n\nexport const StyledShortcutsModal = styled('div')(() => ({\n  width: '288px',\n  height: '74vh',\n  paddingBottom: '28px',\n  backgroundColor: 'var(--affine-white)',\n  boxShadow: 'var(--affine-popover-shadow)',\n  borderRadius: `var(--affine-popover-radius)`,\n  overflow: 'auto',\n  boxRadius: '10px',\n  position: 'fixed',\n  right: '12px',\n  top: '0',\n  bottom: '0',\n  margin: 'auto',\n  zIndex: 'var(--affine-z-index-modal)',\n}));\nexport const StyledTitle = styled('div')(() => ({\n  color: 'var(--affine-text-primary-color)',\n  fontWeight: '500',\n  fontSize: 'var(--affine-font-sm)',\n  height: '44px',\n  ...displayFlex('center', 'center'),\n  svg: {\n    width: '20px',\n    marginRight: '14px',\n    color: 'var(--affine-primary-color)',\n  },\n}));\nexport const StyledSubTitle = styled('div')(() => ({\n  fontWeight: '500',\n  fontSize: 'var(--affine-font-sm)',\n  height: '34px',\n  lineHeight: '36px',\n  marginTop: '28px',\n  padding: '0 16px',\n}));\nexport const StyledModalHeader = styled('div')(() => ({\n  ...displayFlex('space-between', 'center'),\n  paddingTop: '8px 4px 0 4px',\n  width: '100%',\n  padding: '8px 16px 0 16px',\n  position: 'sticky',\n  left: '0',\n  top: '0',\n  background: 'var(--affine-white)',\n  transition: 'background-color 0.5s',\n}));\n\nexport const StyledListItem = styled('div')(() => ({\n  height: '34px',\n  ...displayFlex('space-between', 'center'),\n  fontSize: 'var(--affine-font-sm)',\n  padding: '0 16px',\n}));\n","import {\n  ModalCloseButton,\n  MuiClickAwayListener,\n  MuiSlide,\n} from '@affine/component';\nimport { env } from '@affine/env';\nimport { useAFFiNEI18N } from '@affine/i18n/hooks';\nimport { useEffect, useState } from 'react';\n\nimport {\n  useMacKeyboardShortcuts,\n  useMacMarkdownShortcuts,\n  useWindowsKeyboardShortcuts,\n  useWinMarkdownShortcuts,\n} from './config';\nimport { KeyboardIcon } from './icons';\nimport {\n  StyledListItem,\n  StyledModalHeader,\n  StyledShortcutsModal,\n  StyledSubTitle,\n  StyledTitle,\n} from './style';\ntype ModalProps = {\n  open: boolean;\n  onClose: () => void;\n};\n\nconst checkIsMac = () => {\n  return env.isBrowser && env.isMacOs;\n};\n\nexport const ShortcutsModal = ({ open, onClose }: ModalProps) => {\n  const t = useAFFiNEI18N();\n  const macMarkdownShortcuts = useMacMarkdownShortcuts();\n  const winMarkdownShortcuts = useWinMarkdownShortcuts();\n  const macKeyboardShortcuts = useMacKeyboardShortcuts();\n  const windowsKeyboardShortcuts = useWindowsKeyboardShortcuts();\n  const [isMac, setIsMac] = useState(false);\n  const markdownShortcuts = isMac ? macMarkdownShortcuts : winMarkdownShortcuts;\n  const keyboardShortcuts = isMac\n    ? macKeyboardShortcuts\n    : windowsKeyboardShortcuts;\n\n  useEffect(() => {\n    setIsMac(checkIsMac());\n  }, []);\n\n  return (\n    <MuiSlide direction=\"left\" in={open} mountOnEnter unmountOnExit>\n      <StyledShortcutsModal data-testid=\"shortcuts-modal\">\n        <MuiClickAwayListener\n          onClickAway={() => {\n            onClose();\n          }}\n        >\n          <div>\n            <StyledModalHeader>\n              <StyledTitle>\n                <KeyboardIcon />\n                {t['Shortcuts']()}\n              </StyledTitle>\n\n              <ModalCloseButton\n                top={6}\n                right={6}\n                size={[24, 24]}\n                iconSize={[15, 15]}\n                onClick={() => {\n                  onClose();\n                }}\n              />\n            </StyledModalHeader>\n            <StyledSubTitle style={{ marginTop: 0 }}>\n              {t['Keyboard Shortcuts']()}\n            </StyledSubTitle>\n            {Object.entries(keyboardShortcuts).map(([title, shortcuts]) => {\n              return (\n                <StyledListItem key={title}>\n                  <span>{title}</span>\n                  <span>{shortcuts}</span>\n                </StyledListItem>\n              );\n            })}\n            <StyledSubTitle>{t['Markdown Syntax']()}</StyledSubTitle>\n            {Object.entries(markdownShortcuts).map(([title, shortcuts]) => {\n              return (\n                <StyledListItem key={title}>\n                  <span>{title}</span>\n                  <span>{shortcuts}</span>\n                </StyledListItem>\n              );\n            })}\n          </div>\n        </MuiClickAwayListener>\n      </StyledShortcutsModal>\n    </MuiSlide>\n  );\n};\n","export const HelpIcon = () => {\n  return (\n    <svg\n      width=\"24\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      fill=\"currentColor\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M12.0041 3.8002C7.47536 3.8002 3.8041 7.47146 3.8041 12.0002C3.8041 13.311 4.1111 14.5479 4.65639 15.6449C4.92133 16.1779 4.91348 16.8471 4.85228 17.3998C4.7869 17.9901 4.63749 18.6238 4.47572 19.1908C4.3722 19.5537 4.26086 19.8987 4.1573 20.2002H12.0041C16.5328 20.2002 20.2041 16.5289 20.2041 12.0002C20.2041 7.47146 16.5328 3.8002 12.0041 3.8002ZM2.26631 20.6926L2.2668 20.6914L2.26948 20.685L2.28104 20.6567C2.29139 20.6312 2.30687 20.5928 2.32657 20.5429C2.36599 20.4431 2.42218 20.2979 2.48795 20.1192C2.61992 19.7607 2.78833 19.2734 2.93712 18.7519C3.08715 18.226 3.21054 17.6884 3.262 17.2236C3.31765 16.7212 3.2707 16.4518 3.22364 16.3571C2.57081 15.0438 2.2041 13.5637 2.2041 12.0002C2.2041 6.58781 6.59171 2.2002 12.0041 2.2002C17.4165 2.2002 21.8041 6.5878 21.8041 12.0002C21.8041 17.4126 17.4165 21.8002 12.0041 21.8002H3.0049C2.73745 21.8002 2.4876 21.6665 2.33922 21.444C2.19087 21.2215 2.16356 20.9395 2.26631 20.6926ZM11.9672 9.0502C11.4091 9.0502 10.9382 9.43186 10.8049 9.9496C10.6948 10.3775 10.2587 10.6351 9.83079 10.5249C9.40291 10.4148 9.14532 9.97867 9.25545 9.55079C9.56623 8.3433 10.6614 7.4502 11.9672 7.4502C13.5136 7.4502 14.7672 8.7038 14.7672 10.2502C14.7672 11.1058 14.3536 11.6751 13.8978 12.115C13.7108 12.2955 13.4978 12.4721 13.2997 12.6362C13.2705 12.6604 13.2416 12.6844 13.2132 12.7081C12.982 12.9004 12.7556 13.0932 12.5329 13.3159C12.2205 13.6283 11.7139 13.6283 11.4015 13.3159C11.0891 13.0035 11.0891 12.4969 11.4015 12.1845C11.6788 11.9072 11.9525 11.6756 12.19 11.478C12.2213 11.4519 12.2517 11.4267 12.2812 11.4022C12.4849 11.2332 12.6465 11.0991 12.7866 10.9638C13.0808 10.6799 13.1672 10.4992 13.1672 10.2502C13.1672 9.58745 12.6299 9.0502 11.9672 9.0502ZM11.9772 16.5502H11.9672C11.5254 16.5502 11.1672 16.192 11.1672 15.7502C11.1672 15.3084 11.5254 14.9502 11.9672 14.9502H11.9772C12.419 14.9502 12.7772 15.3084 12.7772 15.7502C12.7772 16.192 12.419 16.5502 11.9772 16.5502Z\"\n      />\n    </svg>\n  );\n};\n\nexport const ContactIcon = () => {\n  return (\n    <svg\n      width=\"24\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      fill=\"currentColor\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M7.16957 3.25H14.8304C15.3646 3.24999 15.8104 3.24998 16.1747 3.27974C16.5546 3.31078 16.9112 3.37789 17.2485 3.54973C17.7659 3.81338 18.1866 4.23408 18.4503 4.75153C18.6221 5.08879 18.6892 5.44545 18.7203 5.82533C18.75 6.18956 18.75 6.6354 18.75 7.16955V8.36732C18.9209 8.40912 19.0869 8.46741 19.2485 8.54973C19.7659 8.81339 20.1866 9.23408 20.4503 9.75153C20.6221 10.0888 20.6892 10.4454 20.7203 10.8253C20.75 11.1896 20.75 11.6354 20.75 12.1695V20C20.75 20.2766 20.5978 20.5307 20.3539 20.6613C20.11 20.7918 19.8141 20.7775 19.584 20.624L17.3901 19.1615C17.069 18.9474 16.9819 18.8925 16.8945 18.8544C16.8046 18.8151 16.7104 18.7866 16.6138 18.7694C16.52 18.7527 16.4171 18.75 16.0311 18.75H11.1695C10.6354 18.75 10.1896 18.75 9.82533 18.7203C9.44545 18.6892 9.08879 18.6221 8.75153 18.4503C8.23408 18.1866 7.81339 17.7659 7.54973 17.2485C7.52446 17.1989 7.50144 17.1488 7.48046 17.0983L4.33541 18.6708C4.10292 18.7871 3.82681 18.7746 3.6057 18.638C3.38459 18.5013 3.25 18.2599 3.25 18L3.25 7.16957C3.24999 6.63541 3.24998 6.18956 3.27974 5.82533C3.31078 5.44545 3.37789 5.08879 3.54973 4.75153C3.81338 4.23408 4.23408 3.81338 4.75153 3.54973C5.08879 3.37789 5.44545 3.31078 5.82533 3.27974C6.18956 3.24998 6.63541 3.24999 7.16957 3.25ZM7.25322 15.5349C7.25 15.318 7.25 15.0803 7.25 14.8211L7.25 12.1696C7.24999 11.6354 7.24998 11.1896 7.27974 10.8253C7.31078 10.4454 7.37789 10.0888 7.54973 9.75153C7.81339 9.23408 8.23408 8.81339 8.75153 8.54973C9.08879 8.37789 9.44545 8.31078 9.82533 8.27974C10.1896 8.24998 10.6354 8.24999 11.1696 8.25H16.8304C16.9769 8.25 17.1167 8.24999 17.25 8.25061V7.2C17.25 6.62757 17.2494 6.24336 17.2252 5.94748C17.2018 5.66036 17.1599 5.52307 17.1138 5.43251C16.9939 5.19731 16.8027 5.00608 16.5675 4.88624C16.4769 4.8401 16.3396 4.79822 16.0525 4.77476C15.7566 4.75058 15.3724 4.75 14.8 4.75H7.2C6.62757 4.75 6.24336 4.75058 5.94748 4.77476C5.66036 4.79822 5.52307 4.8401 5.43251 4.88624C5.19731 5.00608 5.00608 5.19731 4.88624 5.43251C4.8401 5.52307 4.79822 5.66036 4.77476 5.94748C4.75058 6.24336 4.75 6.62757 4.75 7.2V16.7865L7.25322 15.5349ZM9.94748 9.77476C9.66036 9.79822 9.52307 9.8401 9.43251 9.88624C9.19731 10.0061 9.00608 10.1973 8.88624 10.4325C8.8401 10.5231 8.79822 10.6604 8.77476 10.9475C8.75058 11.2434 8.75 11.6276 8.75 12.2V14.8C8.75 15.3018 8.7503 15.6608 8.7673 15.9461C8.78877 16.3064 8.83405 16.465 8.88624 16.5675C9.00608 16.8027 9.19731 16.9939 9.43251 17.1138C9.52307 17.1599 9.66036 17.2018 9.94748 17.2252C10.2434 17.2494 10.6276 17.25 11.2 17.25H16.0311C16.049 17.25 16.0666 17.25 16.084 17.25C16.3929 17.2499 16.6362 17.2497 16.877 17.2927C17.0895 17.3306 17.2968 17.3933 17.4947 17.4797C17.7189 17.5775 17.9213 17.7126 18.1782 17.884C18.1927 17.8937 18.2073 17.9035 18.2222 17.9134L19.25 18.5986V12.2C19.25 11.6276 19.2494 11.2434 19.2252 10.9475C19.2018 10.6604 19.1599 10.5231 19.1138 10.4325C18.9939 10.1973 18.8027 10.0061 18.5675 9.88624C18.4769 9.8401 18.3396 9.79822 18.0525 9.77476C17.7566 9.75058 17.3724 9.75 16.8 9.75H11.2C10.6276 9.75 10.2434 9.75058 9.94748 9.77476Z\"\n      />\n    </svg>\n  );\n};\n\nexport const KeyboardIcon = () => {\n  return (\n    <svg\n      width=\"24\"\n      height=\"25\"\n      viewBox=\"0 0 24 25\"\n      fill=\"currentColor\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <path d=\"M19.745 5C20.3417 5 20.914 5.23705 21.336 5.65901C21.7579 6.08097 21.995 6.65326 21.995 7.25V16.755C21.995 17.3517 21.7579 17.924 21.336 18.346C20.914 18.7679 20.3417 19.005 19.745 19.005H4.25C3.95453 19.005 3.66194 18.9468 3.38896 18.8337C3.11598 18.7207 2.86794 18.5549 2.65901 18.346C2.45008 18.1371 2.28434 17.889 2.17127 17.616C2.0582 17.3431 2 17.0505 2 16.755V7.25C2 6.65326 2.23705 6.08097 2.65901 5.65901C3.08097 5.23705 3.65326 5 4.25 5H19.745ZM19.745 6.5H4.25C4.05109 6.5 3.86032 6.57902 3.71967 6.71967C3.57902 6.86032 3.5 7.05109 3.5 7.25V16.755C3.5 17.169 3.836 17.505 4.25 17.505H19.745C19.9439 17.505 20.1347 17.426 20.2753 17.2853C20.416 17.1447 20.495 16.9539 20.495 16.755V7.25C20.495 7.05109 20.416 6.86032 20.2753 6.71967C20.1347 6.57902 19.9439 6.5 19.745 6.5ZM6.75 14.5H17.25C17.44 14.5001 17.6229 14.5722 17.7618 14.702C17.9006 14.8317 17.9851 15.0093 17.998 15.1989C18.011 15.3885 17.9515 15.5759 17.8316 15.7233C17.7117 15.8707 17.5402 15.9671 17.352 15.993L17.25 16H6.75C6.55998 15.9999 6.37706 15.9278 6.23821 15.798C6.09936 15.6683 6.01493 15.4907 6.00197 15.3011C5.98902 15.1115 6.04852 14.9241 6.16843 14.7767C6.28835 14.6293 6.45975 14.5329 6.648 14.507L6.75 14.5H17.25H6.75ZM16.5 11C16.7652 11 17.0196 11.1054 17.2071 11.2929C17.3946 11.4804 17.5 11.7348 17.5 12C17.5 12.2652 17.3946 12.5196 17.2071 12.7071C17.0196 12.8946 16.7652 13 16.5 13C16.2348 13 15.9804 12.8946 15.7929 12.7071C15.6054 12.5196 15.5 12.2652 15.5 12C15.5 11.7348 15.6054 11.4804 15.7929 11.2929C15.9804 11.1054 16.2348 11 16.5 11ZM10.505 11C10.7702 11 11.0246 11.1054 11.2121 11.2929C11.3996 11.4804 11.505 11.7348 11.505 12C11.505 12.2652 11.3996 12.5196 11.2121 12.7071C11.0246 12.8946 10.7702 13 10.505 13C10.2398 13 9.98543 12.8946 9.79789 12.7071C9.61036 12.5196 9.505 12.2652 9.505 12C9.505 11.7348 9.61036 11.4804 9.79789 11.2929C9.98543 11.1054 10.2398 11 10.505 11ZM7.505 11C7.77022 11 8.02457 11.1054 8.21211 11.2929C8.39964 11.4804 8.505 11.7348 8.505 12C8.505 12.2652 8.39964 12.5196 8.21211 12.7071C8.02457 12.8946 7.77022 13 7.505 13C7.23978 13 6.98543 12.8946 6.79789 12.7071C6.61036 12.5196 6.505 12.2652 6.505 12C6.505 11.7348 6.61036 11.4804 6.79789 11.2929C6.98543 11.1054 7.23978 11 7.505 11ZM13.505 11C13.7702 11 14.0246 11.1054 14.2121 11.2929C14.3996 11.4804 14.505 11.7348 14.505 12C14.505 12.2652 14.3996 12.5196 14.2121 12.7071C14.0246 12.8946 13.7702 13 13.505 13C13.2398 13 12.9854 12.8946 12.7979 12.7071C12.6104 12.5196 12.505 12.2652 12.505 12C12.505 11.7348 12.6104 11.4804 12.7979 11.2929C12.9854 11.1054 13.2398 11 13.505 11ZM6 8C6.26522 8 6.51957 8.10536 6.70711 8.29289C6.89464 8.48043 7 8.73478 7 9C7 9.26522 6.89464 9.51957 6.70711 9.70711C6.51957 9.89464 6.26522 10 6 10C5.73478 10 5.48043 9.89464 5.29289 9.70711C5.10536 9.51957 5 9.26522 5 9C5 8.73478 5.10536 8.48043 5.29289 8.29289C5.48043 8.10536 5.73478 8 6 8ZM8.995 8C9.26022 8 9.51457 8.10536 9.70211 8.29289C9.88964 8.48043 9.995 8.73478 9.995 9C9.995 9.26522 9.88964 9.51957 9.70211 9.70711C9.51457 9.89464 9.26022 10 8.995 10C8.72978 10 8.47543 9.89464 8.28789 9.70711C8.10036 9.51957 7.995 9.26522 7.995 9C7.995 8.73478 8.10036 8.48043 8.28789 8.29289C8.47543 8.10536 8.72978 8 8.995 8ZM11.995 8C12.2602 8 12.5146 8.10536 12.7021 8.29289C12.8896 8.48043 12.995 8.73478 12.995 9C12.995 9.26522 12.8896 9.51957 12.7021 9.70711C12.5146 9.89464 12.2602 10 11.995 10C11.7298 10 11.4754 9.89464 11.2879 9.70711C11.1004 9.51957 10.995 9.26522 10.995 9C10.995 8.73478 11.1004 8.48043 11.2879 8.29289C11.4754 8.10536 11.7298 8 11.995 8ZM14.995 8C15.2602 8 15.5146 8.10536 15.7021 8.29289C15.8896 8.48043 15.995 8.73478 15.995 9C15.995 9.26522 15.8896 9.51957 15.7021 9.70711C15.5146 9.89464 15.2602 10 14.995 10C14.7298 10 14.4754 9.89464 14.2879 9.70711C14.1004 9.51957 13.995 9.26522 13.995 9C13.995 8.73478 14.1004 8.48043 14.2879 8.29289C14.4754 8.10536 14.7298 8 14.995 8ZM17.995 8C18.2602 8 18.5146 8.10536 18.7021 8.29289C18.8896 8.48043 18.995 8.73478 18.995 9C18.995 9.26522 18.8896 9.51957 18.7021 9.70711C18.5146 9.89464 18.2602 10 17.995 10C17.7298 10 17.4754 9.89464 17.2879 9.70711C17.1004 9.51957 16.995 9.26522 16.995 9C16.995 8.73478 17.1004 8.48043 17.2879 8.29289C17.4754 8.10536 17.7298 8 17.995 8Z\" />\n    </svg>\n  );\n};\n","import { displayFlex, positionAbsolute, styled } from '@affine/component';\n\nexport const StyledIsland = styled('div')<{\n  spread: boolean;\n  inEdgelessPage?: boolean;\n}>(({ spread, inEdgelessPage }) => {\n  return {\n    transition: 'box-shadow 0.2s',\n    width: '44px',\n    position: 'relative',\n    boxShadow: spread\n      ? 'var(--affine-menu-shadow)'\n      : inEdgelessPage\n      ? 'var(--affine-menu-shadow)'\n      : 'unset',\n    padding: '0 4px 44px',\n    borderRadius: '10px',\n    background: spread\n      ? 'var(--affine-background-overlay-panel-color)'\n      : 'var(--affine-background-primary-color)',\n    ':hover': {\n      background: spread ? null : 'var(--affine-white)',\n      boxShadow: spread ? null : 'var(--affine-menu-shadow)',\n    },\n    '::after': {\n      content: '\"\"',\n      width: '36px',\n      height: '1px',\n      background: spread ? 'var(--affine-border-color)' : 'transparent',\n      ...positionAbsolute({\n        left: 0,\n        right: 0,\n        bottom: '44px',\n      }),\n      margin: 'auto',\n      transition: 'background 0.15s',\n    },\n  };\n});\nexport const StyledIconWrapper = styled('div')(() => {\n  return {\n    color: 'var(--affine-icon-color)',\n    ...displayFlex('center', 'center'),\n    cursor: 'pointer',\n    fontSize: '24px',\n    borderRadius: '5px',\n    width: '36px',\n    height: '36px',\n    margin: '4px auto 4px',\n    transition: 'background-color 0.2s',\n    position: 'relative',\n    ':hover': {\n      color: 'var(--affine-primary-color)',\n      backgroundColor: 'var(--affine-hover-color)',\n    },\n  };\n});\n\nexport const StyledAnimateWrapper = styled('div')(() => ({\n  transition: 'height 0.2s cubic-bezier(0, 0, 0.55, 1.6)',\n  overflow: 'hidden',\n}));\n\nexport const StyledTriggerWrapper = styled('div')<{\n  spread?: boolean;\n}>(({ spread }) => {\n  return {\n    width: '36px',\n    height: '36px',\n    cursor: 'pointer',\n    color: 'var(--affine-icon-color)',\n    borderRadius: '5px',\n    fontSize: '24px',\n    ...displayFlex('center', 'center'),\n    ...positionAbsolute({ left: '4px', bottom: '4px' }),\n    ':hover': {\n      color: 'var(--affine-primary-color)',\n      backgroundColor: spread ? 'var(--affine-hover-color)' : null,\n    },\n  };\n});\n","import { MuiFade, Tooltip } from '@affine/component';\nimport { config, env } from '@affine/env';\nimport { useAFFiNEI18N } from '@affine/i18n/hooks';\nimport { CloseIcon, NewIcon, UserGuideIcon } from '@blocksuite/icons';\nimport { useAtom } from 'jotai';\nimport { lazy, Suspense, useState } from 'react';\n\nimport { openOnboardingModalAtom } from '../../../atoms';\nimport { useCurrentMode } from '../../../hooks/current/use-current-mode';\nimport { ShortcutsModal } from '../shortcuts-modal';\nimport { ContactIcon, HelpIcon, KeyboardIcon } from './icons';\nimport {\n  StyledAnimateWrapper,\n  StyledIconWrapper,\n  StyledIsland,\n  StyledTriggerWrapper,\n} from './style';\nconst ContactModal = lazy(() =>\n  import('@affine/component/contact-modal').then(({ ContactModal }) => ({\n    default: ContactModal,\n  }))\n);\nconst DEFAULT_SHOW_LIST: IslandItemNames[] = [\n  'whatNew',\n  'contact',\n  'shortcuts',\n];\nconst DESKTOP_SHOW_LIST: IslandItemNames[] = [...DEFAULT_SHOW_LIST, 'guide'];\nexport type IslandItemNames = 'whatNew' | 'contact' | 'shortcuts' | 'guide';\nexport const HelpIsland = ({\n  showList = env.isDesktop ? DESKTOP_SHOW_LIST : DEFAULT_SHOW_LIST,\n}: {\n  showList?: IslandItemNames[];\n}) => {\n  const mode = useCurrentMode();\n  const [, setOpenOnboarding] = useAtom(openOnboardingModalAtom);\n  const [spread, setShowSpread] = useState(false);\n  // const { triggerShortcutsModal, triggerContactModal } = useModal();\n  // const blockHub = useGlobalState(store => store.blockHub);\n  const t = useAFFiNEI18N();\n  //\n  // useEffect(() => {\n  //   blockHub?.blockHubStatusUpdated.on(status => {\n  //     if (status) {\n  //       setShowSpread(false);\n  //     }\n  //   });\n  //   return () => {\n  //     blockHub?.blockHubStatusUpdated.dispose();\n  //   };\n  // }, [blockHub]);\n  //\n  // useEffect(() => {\n  //   spread && blockHub?.toggleMenu(false);\n  // }, [blockHub, spread]);\n  const [open, setOpen] = useState(false);\n  const [openShortCut, setOpenShortCut] = useState(false);\n  return (\n    <>\n      <StyledIsland\n        spread={spread}\n        data-testid=\"help-island\"\n        onClick={() => {\n          setShowSpread(!spread);\n        }}\n        inEdgelessPage={mode === 'edgeless'}\n      >\n        <StyledAnimateWrapper\n          style={{ height: spread ? `${showList.length * 44}px` : 0 }}\n        >\n          {showList.includes('whatNew') && (\n            <Tooltip content={t[\"Discover what's new!\"]()} placement=\"left-end\">\n              <StyledIconWrapper\n                data-testid=\"right-bottom-change-log-icon\"\n                onClick={() => {\n                  window.open(config.changelogUrl, '_blank');\n                }}\n              >\n                <NewIcon />\n              </StyledIconWrapper>\n            </Tooltip>\n          )}\n          {showList.includes('contact') && (\n            <Tooltip content={t['Contact Us']()} placement=\"left-end\">\n              <StyledIconWrapper\n                data-testid=\"right-bottom-contact-us-icon\"\n                onClick={() => {\n                  setShowSpread(false);\n                  setOpen(true);\n                }}\n              >\n                <ContactIcon />\n              </StyledIconWrapper>\n            </Tooltip>\n          )}\n          {showList.includes('shortcuts') && (\n            <Tooltip content={t['Keyboard Shortcuts']()} placement=\"left-end\">\n              <StyledIconWrapper\n                data-testid=\"shortcuts-icon\"\n                onClick={() => {\n                  setShowSpread(false);\n                  setOpenShortCut(true);\n                }}\n              >\n                <KeyboardIcon />\n              </StyledIconWrapper>\n            </Tooltip>\n          )}\n          {showList.includes('guide') && (\n            <Tooltip\n              content={t['com.affine.helpIsland.gettingStarted']()}\n              placement=\"left-end\"\n            >\n              <StyledIconWrapper\n                data-testid=\"easy-guide\"\n                onClick={() => {\n                  setShowSpread(false);\n                  setOpenOnboarding(true);\n                }}\n              >\n                <UserGuideIcon />\n              </StyledIconWrapper>\n            </Tooltip>\n          )}\n        </StyledAnimateWrapper>\n\n        <Tooltip content={t['Help and Feedback']()} placement=\"left-end\">\n          <MuiFade in={!spread} data-testid=\"faq-icon\">\n            <StyledTriggerWrapper>\n              <HelpIcon />\n            </StyledTriggerWrapper>\n          </MuiFade>\n        </Tooltip>\n        <MuiFade in={spread}>\n          <StyledTriggerWrapper spread>\n            <CloseIcon />\n          </StyledTriggerWrapper>\n        </MuiFade>\n      </StyledIsland>\n      <Suspense>\n        <ContactModal\n          open={open}\n          onClose={() => setOpen(false)}\n          logoSrc=\"/imgs/affine-text-logo.png\"\n        />\n      </Suspense>\n      <ShortcutsModal\n        open={openShortCut}\n        onClose={() => setOpenShortCut(false)}\n      />\n    </>\n  );\n};\n","import type { Page, Workspace } from '@blocksuite/store';\nimport { atom, useAtomValue } from 'jotai';\nimport { atomFamily } from 'jotai/utils';\n\nimport { useBlockSuiteWorkspacePage } from './use-block-suite-workspace-page';\n\nfunction getPageReferences(page: Page): string[] {\n  // todo: is there a way to use page indexer to get all references?\n  return page\n    .getBlockByFlavour('affine:paragraph')\n    .flatMap(b => b.text?.toDelta())\n    .map(v => v?.attributes?.reference?.pageId)\n    .filter(Boolean);\n}\n\nconst pageReferencesAtomFamily = atomFamily((page: Page | null) => {\n  if (page === null) {\n    return atom([]);\n  }\n  const baseAtom = atom<string[]>(getPageReferences(page));\n  baseAtom.onMount = set => {\n    const dispose = page.slots.yUpdated.on(() => {\n      set(getPageReferences(page));\n    });\n    return () => {\n      dispose.dispose();\n    };\n  };\n  return baseAtom;\n});\n\nexport function useBlockSuitePageReferences(\n  blockSuiteWorkspace: Workspace,\n  pageId: string\n): string[] {\n  const page = useBlockSuiteWorkspacePage(blockSuiteWorkspace, pageId);\n  return useAtomValue(pageReferencesAtomFamily(page));\n}\n","import { MenuItem } from '@affine/component/app-sidebar';\nimport { useAFFiNEI18N } from '@affine/i18n/hooks';\n\nexport const EmptyItem = () => {\n  const t = useAFFiNEI18N();\n  return (\n    <MenuItem disabled={true}>{t['Favorite pages for easy access']()}</MenuItem>\n  );\n};\n\nexport default EmptyItem;\n","import \"src/components/pure/workspace-slider-bar/favorite/styles.css.ts.vanilla.css!=!../../../../../../../node_modules/@vanilla-extract/webpack-plugin/virtualFileLoader/dist/vanilla-extract-webpack-plugin-virtualFileLoader.cjs.js?{\\\"fileName\\\":\\\"src/components/pure/workspace-slider-bar/favorite/styles.css.ts.vanilla.css\\\",\\\"source\\\":\\\"QGtleWZyYW1lcyBzbnp4Y3gyIHsKICAwJSB7CiAgICBoZWlnaHQ6IDBweDsKICB9CiAgMTAwJSB7CiAgICBoZWlnaHQ6IHZhcigtLXJhZGl4LWNvbGxhcHNpYmxlLWNvbnRlbnQtaGVpZ2h0KTsKICB9Cn0KQGtleWZyYW1lcyBzbnp4Y3gzIHsKICAwJSB7CiAgICBoZWlnaHQ6IHZhcigtLXJhZGl4LWNvbGxhcHNpYmxlLWNvbnRlbnQtaGVpZ2h0KTsKICB9CiAgMTAwJSB7CiAgICBoZWlnaHQ6IDBweDsKICB9Cn0KLnNuenhjeDBbZGF0YS11bnRpdGxlZD0idHJ1ZSJdIHsKICBvcGFjaXR5OiAwLjY7Cn0KLnNuenhjeDEgewogIGRpc3BsYXk6IGZsZXg7CiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICBnYXA6IDRweDsKfQouc256eGN4MVtkYXRhLW5lc3RlZD0idHJ1ZSJdIHsKICBtYXJnaW4tbGVmdDogMTJweDsKICB3aWR0aDogY2FsYygxMDAlIC0gMTJweCk7Cn0KLnNuenhjeDQgewogIG92ZXJmbG93OiBoaWRkZW47Cn0KLnNuenhjeDRbZGF0YS1zdGF0ZT0ib3BlbiJdIHsKICBhbmltYXRpb246IHNuenhjeDIgMC4ycyBlYXNlLW91dDsKfQouc256eGN4NFtkYXRhLXN0YXRlPSJjbG9zZWQiXSB7CiAgYW5pbWF0aW9uOiBzbnp4Y3gzIDAuMnMgZWFzZS1vdXQ7Cn0KLnNuenhjeDUgewogIGRpc3BsYXk6IGZsZXg7CiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICBnYXA6IDRweDsKfQ==\\\"}!../../../../../../../node_modules/@vanilla-extract/webpack-plugin/extracted.js\"\nexport var collapsibleContent = 'snzxcx4';\nexport var collapsibleContentInner = 'snzxcx5';\nexport var favItemWrapper = 'snzxcx1';\nexport var label = 'snzxcx0';","import { MenuLinkItem } from '@affine/component/app-sidebar';\nimport { EdgelessIcon, PageIcon } from '@blocksuite/icons';\nimport type { PageMeta, Workspace } from '@blocksuite/store';\nimport * as Collapsible from '@radix-ui/react-collapsible';\nimport { useBlockSuitePageMeta } from '@toeverything/hooks/use-block-suite-page-meta';\nimport { useBlockSuitePageReferences } from '@toeverything/hooks/use-block-suite-page-references';\nimport { useAtomValue } from 'jotai';\nimport { useRouter } from 'next/router';\nimport { useMemo, useState } from 'react';\n\nimport { pageSettingFamily } from '../../../../atoms';\nimport type { FavoriteListProps } from '../index';\nimport EmptyItem from './empty-item';\nimport * as styles from './styles.css';\n\ninterface FavoriteMenuItemProps {\n  workspace: Workspace;\n  pageId: string;\n  metaMapping: Record<string, PageMeta>;\n  parentIds: Set<string>;\n}\n\nfunction FavoriteMenuItem({\n  workspace,\n  pageId,\n  metaMapping,\n  parentIds,\n}: FavoriteMenuItemProps) {\n  const router = useRouter();\n  const setting = useAtomValue(pageSettingFamily(pageId));\n  const active = router.query.pageId === pageId;\n  const icon = setting?.mode === 'edgeless' ? <EdgelessIcon /> : <PageIcon />;\n  const references = useBlockSuitePageReferences(workspace, pageId);\n  const referencesToShow = useMemo(() => {\n    return [\n      ...new Set(\n        references.filter(\n          ref => !parentIds.has(ref) && !metaMapping[ref]?.trash\n        )\n      ),\n    ];\n  }, [references, parentIds, metaMapping]);\n  const [collapsed, setCollapsed] = useState(true);\n  const collapsible = referencesToShow.length > 0;\n  const nestedItem = parentIds.size > 0;\n  const untitled = !metaMapping[pageId]?.title;\n  return (\n    <Collapsible.Root\n      className={styles.favItemWrapper}\n      data-nested={nestedItem}\n      open={!collapsed}\n    >\n      <MenuLinkItem\n        data-type=\"favorite-list-item\"\n        data-testid={`favorite-list-item-${pageId}`}\n        active={active}\n        href={`/workspace/${workspace.id}/${pageId}`}\n        icon={icon}\n        collapsed={collapsible ? collapsed : undefined}\n        onCollapsedChange={setCollapsed}\n      >\n        <span className={styles.label} data-untitled={untitled}>\n          {metaMapping[pageId]?.title || 'Untitled'}\n        </span>\n      </MenuLinkItem>\n      {collapsible && (\n        <Collapsible.Content className={styles.collapsibleContent}>\n          <div className={styles.collapsibleContentInner}>\n            {referencesToShow.map(ref => {\n              return (\n                <FavoriteMenuItem\n                  key={ref}\n                  workspace={workspace}\n                  pageId={ref}\n                  metaMapping={metaMapping}\n                  parentIds={new Set([...parentIds, pageId])}\n                />\n              );\n            })}\n          </div>\n        </Collapsible.Content>\n      )}\n    </Collapsible.Root>\n  );\n}\n\nexport const FavoriteList = ({ currentWorkspace }: FavoriteListProps) => {\n  const metas = useBlockSuitePageMeta(currentWorkspace.blockSuiteWorkspace);\n\n  const favoriteList = useMemo(\n    () => metas.filter(p => p.favorite && !p.trash),\n    [metas]\n  );\n\n  const metaMapping = useMemo(\n    () =>\n      metas.reduce((acc, meta) => {\n        acc[meta.id] = meta;\n        return acc;\n      }, {} as Record<string, PageMeta>),\n    [metas]\n  );\n\n  return (\n    <>\n      {favoriteList.map((pageMeta, index) => {\n        return (\n          <FavoriteMenuItem\n            key={`${pageMeta}-${index}`}\n            metaMapping={metaMapping}\n            pageId={pageMeta.id}\n            // memo?\n            parentIds={new Set()}\n            workspace={currentWorkspace.blockSuiteWorkspace}\n          />\n        );\n      })}\n      {favoriteList.length === 0 && <EmptyItem />}\n    </>\n  );\n};\n\nexport default FavoriteList;\n","import \"src/components/pure/workspace-slider-bar/WorkspaceSelector/index.css.ts.vanilla.css!=!../../../../../../../node_modules/@vanilla-extract/webpack-plugin/virtualFileLoader/dist/vanilla-extract-webpack-plugin-virtualFileLoader.cjs.js?{\\\"fileName\\\":\\\"src/components/pure/workspace-slider-bar/WorkspaceSelector/index.css.ts.vanilla.css\\\",\\\"source\\\":\\\"Ll81cGl6emcwIHsKICBmbGV4LXNocmluazogMDsKfQ==\\\"}!../../../../../../../node_modules/@vanilla-extract/webpack-plugin/extracted.js\"\nexport var workspaceAvatarStyle = '_5pizzg0';","import { displayFlex, textEllipsis } from '@affine/component';\nimport { styled } from '@affine/component';\nexport const StyledSelectorContainer = styled('div')(() => {\n  return {\n    height: '58px',\n    display: 'flex',\n    alignItems: 'center',\n    padding: '0 6px',\n    margin: '0 -6px',\n    borderRadius: '8px',\n    color: 'var(--affine-text-primary-color)',\n    ':hover': {\n      cursor: 'pointer',\n      background: 'var(--affine-hover-color)',\n    },\n  };\n});\n\nexport const StyledSelectorWrapper = styled('div')(() => {\n  return {\n    marginLeft: '8px',\n    flexGrow: 1,\n    overflow: 'hidden',\n  };\n});\nexport const StyledWorkspaceName = styled('div')(() => {\n  return {\n    lineHeight: '24px',\n    fontWeight: 600,\n    userSelect: 'none',\n    ...textEllipsis(1),\n  };\n});\n\nexport const StyledWorkspaceStatus = styled('div')(() => {\n  return {\n    height: '22px',\n    ...displayFlex('flex-start', 'center'),\n    fontSize: 'var(--affine-font-sm)',\n    color: 'var(--affine-text-secondary-color)',\n    userSelect: 'none',\n    svg: {\n      color: 'var(--affine-icon-color)',\n      fontSize: 'var(--affine-font-base)',\n      marginRight: '4px',\n    },\n  };\n});\n","import { WorkspaceAvatar } from '@affine/component/workspace-avatar';\nimport { CloudWorkspaceIcon, LocalWorkspaceIcon } from '@blocksuite/icons';\nimport { useBlockSuiteWorkspaceName } from '@toeverything/hooks/use-block-suite-workspace-name';\nimport type React from 'react';\nimport { useCallback } from 'react';\n\nimport { useCurrentWorkspace } from '../../../../hooks/current/use-current-workspace';\nimport type { AllWorkspace } from '../../../../shared';\nimport { workspaceAvatarStyle } from './index.css';\nimport {\n  StyledSelectorContainer,\n  StyledSelectorWrapper,\n  StyledWorkspaceName,\n  StyledWorkspaceStatus,\n} from './styles';\n\nexport type WorkspaceSelectorProps = {\n  currentWorkspace: AllWorkspace | null;\n  onClick: () => void;\n};\n\n/**\n * @todo-Doma Co-locate WorkspaceListModal with {@link WorkspaceSelector},\n *            because it's never used elsewhere.\n */\nexport const WorkspaceSelector: React.FC<WorkspaceSelectorProps> = ({\n  currentWorkspace,\n  onClick,\n}) => {\n  const [name] = useBlockSuiteWorkspaceName(\n    currentWorkspace?.blockSuiteWorkspace ?? null\n  );\n  const [workspace] = useCurrentWorkspace();\n\n  // Open dialog when `Enter` or `Space` pressed\n  // TODO-Doma Refactor with `@radix-ui/react-dialog` or other libraries that handle these out of the box and be accessible by default\n  const handleKeyDown = useCallback(\n    (e: React.KeyboardEvent) => {\n      if (e.key === 'Enter' || e.key === ' ') {\n        e.preventDefault();\n        // TODO-Doma Rename this callback to `onOpenDialog` or something to reduce ambiguity.\n        onClick();\n      }\n    },\n    [onClick]\n  );\n\n  return (\n    <StyledSelectorContainer\n      role=\"button\"\n      tabIndex={0}\n      onClick={onClick}\n      onKeyDown={handleKeyDown}\n      data-testid=\"current-workspace\"\n    >\n      <WorkspaceAvatar\n        data-testid=\"workspace-avatar\"\n        className={workspaceAvatarStyle}\n        size={40}\n        workspace={currentWorkspace}\n      />\n      <StyledSelectorWrapper>\n        <StyledWorkspaceName data-testid=\"workspace-name\">\n          {name}\n        </StyledWorkspaceName>\n        {workspace && (\n          <StyledWorkspaceStatus>\n            {workspace.flavour === 'local' ? (\n              <LocalWorkspaceIcon />\n            ) : (\n              <CloudWorkspaceIcon />\n            )}\n            {workspace.flavour === 'local' ? 'Local' : 'AFFiNE Cloud'}\n          </StyledWorkspaceStatus>\n        )}\n      </StyledSelectorWrapper>\n    </StyledSelectorContainer>\n  );\n};\n","export * from './workspace-selector';\n","import {\n  AddPageButton,\n  AppSidebar,\n  appSidebarOpenAtom,\n  AppUpdaterButton,\n  CategoryDivider,\n  MenuLinkItem,\n  QuickSearchInput,\n  SidebarContainer,\n  SidebarScrollableContainer,\n} from '@affine/component/app-sidebar';\nimport { config } from '@affine/env';\nimport { WorkspaceFlavour } from '@affine/env/workspace';\nimport { useAFFiNEI18N } from '@affine/i18n/hooks';\nimport {\n  DeleteTemporarilyIcon,\n  FolderIcon,\n  SettingsIcon,\n  ShareIcon,\n} from '@blocksuite/icons';\nimport type { Page } from '@blocksuite/store';\nimport { useDroppable } from '@dnd-kit/core';\nimport { useAtom } from 'jotai';\nimport type { ReactElement } from 'react';\nimport React, { useCallback, useEffect, useMemo } from 'react';\n\nimport { useHistoryAtom } from '../../atoms/history';\nimport type { AllWorkspace } from '../../shared';\nimport FavoriteList from '../pure/workspace-slider-bar/favorite/favorite-list';\nimport { WorkspaceSelector } from '../pure/workspace-slider-bar/WorkspaceSelector';\n\nexport type RootAppSidebarProps = {\n  isPublicWorkspace: boolean;\n  onOpenQuickSearchModal: () => void;\n  onOpenWorkspaceListModal: () => void;\n  currentWorkspace: AllWorkspace | null;\n  openPage: (pageId: string) => void;\n  createPage: () => Page;\n  currentPath: string;\n  paths: {\n    all: (workspaceId: string) => string;\n    trash: (workspaceId: string) => string;\n    setting: (workspaceId: string) => string;\n    shared: (workspaceId: string) => string;\n  };\n};\n\nconst RouteMenuLinkItem = React.forwardRef<\n  HTMLDivElement,\n  {\n    currentPath: string; // todo: pass through useRouter?\n    path?: string | null;\n    icon: ReactElement;\n    children?: ReactElement;\n    isDraggedOver?: boolean;\n  } & React.HTMLAttributes<HTMLDivElement>\n>(({ currentPath, path, icon, children, isDraggedOver, ...props }, ref) => {\n  // Force active style when a page is dragged over\n  const active = isDraggedOver || currentPath === path;\n  return (\n    <MenuLinkItem\n      ref={ref}\n      {...props}\n      active={active}\n      href={path ?? ''}\n      icon={icon}\n    >\n      {children}\n    </MenuLinkItem>\n  );\n});\nRouteMenuLinkItem.displayName = 'RouteMenuLinkItem';\n\n// Unique droppable IDs\nexport const DROPPABLE_SIDEBAR_TRASH = 'trash-folder';\n\n/**\n * This is for the whole affine app sidebar.\n * This component wraps the app sidebar in `@affine/component` with logic and data.\n *\n * @todo(himself65): rewrite all styled component into @vanilla-extract/css\n */\nexport const RootAppSidebar = ({\n  currentWorkspace,\n  openPage,\n  createPage,\n  currentPath,\n  paths,\n  onOpenQuickSearchModal,\n  onOpenWorkspaceListModal,\n}: RootAppSidebarProps): ReactElement => {\n  const currentWorkspaceId = currentWorkspace?.id || null;\n  const blockSuiteWorkspace = currentWorkspace?.blockSuiteWorkspace;\n  const t = useAFFiNEI18N();\n  const onClickNewPage = useCallback(async () => {\n    const page = createPage();\n    openPage(page.id);\n  }, [createPage, openPage]);\n\n  // Listen to the \"New Page\" action from the menu\n  useEffect(() => {\n    if (environment.isDesktop) {\n      return window.events?.applicationMenu.onNewPageAction(onClickNewPage);\n    }\n  }, [onClickNewPage]);\n\n  const [sidebarOpen, setSidebarOpen] = useAtom(appSidebarOpenAtom);\n  useEffect(() => {\n    if (environment.isDesktop && typeof sidebarOpen === 'boolean') {\n      window.apis?.ui.handleSidebarVisibilityChange(sidebarOpen).catch(err => {\n        console.error(err);\n      });\n    }\n  }, [sidebarOpen]);\n\n  useEffect(() => {\n    const keydown = (e: KeyboardEvent) => {\n      if ((e.key === '/' && e.metaKey) || (e.key === '/' && e.ctrlKey)) {\n        setSidebarOpen(!sidebarOpen);\n      }\n    };\n    document.addEventListener('keydown', keydown, { capture: true });\n    return () =>\n      document.removeEventListener('keydown', keydown, { capture: true });\n  }, [sidebarOpen, setSidebarOpen]);\n\n  const [history, setHistory] = useHistoryAtom();\n  const router = useMemo(() => {\n    return {\n      forward: () => {\n        setHistory(true);\n      },\n      back: () => {\n        setHistory(false);\n      },\n      history,\n    };\n  }, [history, setHistory]);\n\n  const trashDroppable = useDroppable({\n    id: DROPPABLE_SIDEBAR_TRASH,\n  });\n\n  return (\n    <>\n      <AppSidebar router={router}>\n        <SidebarContainer>\n          <WorkspaceSelector\n            currentWorkspace={currentWorkspace}\n            onClick={onOpenWorkspaceListModal}\n          />\n          <QuickSearchInput\n            data-testid=\"slider-bar-quick-search-button\"\n            onClick={onOpenQuickSearchModal}\n          />\n          <RouteMenuLinkItem\n            icon={<FolderIcon />}\n            currentPath={currentPath}\n            path={currentWorkspaceId && paths.all(currentWorkspaceId)}\n          >\n            <span data-testid=\"all-pages\">{t['All pages']()}</span>\n          </RouteMenuLinkItem>\n          <RouteMenuLinkItem\n            data-testid=\"slider-bar-workspace-setting-button\"\n            icon={<SettingsIcon />}\n            currentPath={currentPath}\n            path={currentWorkspaceId && paths.setting(currentWorkspaceId)}\n          >\n            <span data-testid=\"settings\">{t['Settings']()}</span>\n          </RouteMenuLinkItem>\n        </SidebarContainer>\n\n        <SidebarScrollableContainer>\n          <CategoryDivider label={t['Favorites']()} />\n          {blockSuiteWorkspace && (\n            <FavoriteList currentWorkspace={currentWorkspace} />\n          )}\n          {config.enableLegacyCloud &&\n            (currentWorkspace?.flavour === WorkspaceFlavour.AFFINE &&\n            currentWorkspace.public ? (\n              <RouteMenuLinkItem\n                icon={<ShareIcon />}\n                currentPath={currentPath}\n                path={currentWorkspaceId && paths.setting(currentWorkspaceId)}\n              >\n                <span data-testid=\"Published-to-web\">Published to web</span>\n              </RouteMenuLinkItem>\n            ) : (\n              <RouteMenuLinkItem\n                icon={<ShareIcon />}\n                currentPath={currentPath}\n                path={currentWorkspaceId && paths.shared(currentWorkspaceId)}\n              >\n                <span data-testid=\"shared-pages\">{t['Shared Pages']()}</span>\n              </RouteMenuLinkItem>\n            ))}\n\n          <CategoryDivider label={t['others']()} />\n          <RouteMenuLinkItem\n            ref={trashDroppable.setNodeRef}\n            isDraggedOver={trashDroppable.isOver}\n            icon={<DeleteTemporarilyIcon />}\n            currentPath={currentPath}\n            path={currentWorkspaceId && paths.trash(currentWorkspaceId)}\n          >\n            <span data-testid=\"trash-page\">{t['Trash']()}</span>\n          </RouteMenuLinkItem>\n        </SidebarScrollableContainer>\n        <SidebarContainer>\n          {environment.isDesktop && <AppUpdaterButton />}\n          <div />\n          <AddPageButton onClick={onClickNewPage} />\n        </SidebarContainer>\n      </AppSidebar>\n    </>\n  );\n};\n","import { Content, displayFlex } from '@affine/component';\nimport { AffineWatermark } from '@affine/component/affine-watermark';\nimport { appSidebarResizingAtom } from '@affine/component/app-sidebar';\nimport type { DraggableTitleCellData } from '@affine/component/page-list';\nimport { StyledTitleLink } from '@affine/component/page-list';\nimport {\n  AppContainer,\n  MainContainer,\n  ToolContainer,\n  WorkspaceFallback,\n} from '@affine/component/workspace';\nimport { DebugLogger } from '@affine/debug';\nimport { config, DEFAULT_HELLO_WORLD_PAGE_ID, env } from '@affine/env';\nimport { initEmptyPage, initPageWithPreloading } from '@affine/env/blocksuite';\nimport type { BackgroundProvider } from '@affine/env/workspace';\nimport { WorkspaceFlavour } from '@affine/env/workspace';\nimport { setUpLanguage, useI18N } from '@affine/i18n';\nimport { useAFFiNEI18N } from '@affine/i18n/hooks';\nimport { createAffineGlobalChannel } from '@affine/workspace/affine/sync';\nimport {\n  rootCurrentPageIdAtom,\n  rootCurrentWorkspaceIdAtom,\n  rootWorkspacesMetadataAtom,\n} from '@affine/workspace/atom';\nimport { assertEquals, assertExists, nanoid } from '@blocksuite/store';\nimport type { DragEndEvent } from '@dnd-kit/core';\nimport {\n  DndContext,\n  DragOverlay,\n  MouseSensor,\n  pointerWithin,\n  useDndContext,\n  useSensor,\n  useSensors,\n} from '@dnd-kit/core';\nimport { useBlockSuiteWorkspaceHelper } from '@toeverything/hooks/use-block-suite-workspace-helper';\nimport { rootStore } from '@toeverything/plugin-infra/manager';\nimport { useAtom, useAtomValue, useSetAtom } from 'jotai';\nimport Head from 'next/head';\nimport { useRouter } from 'next/router';\nimport type { FC, PropsWithChildren, ReactElement } from 'react';\nimport { lazy, Suspense, useCallback, useEffect, useMemo } from 'react';\n\nimport { WorkspaceAdapters } from '../adapters/workspace';\nimport { openQuickSearchModalAtom, openWorkspacesModalAtom } from '../atoms';\nimport { useTrackRouterHistoryEffect } from '../atoms/history';\nimport {\n  publicWorkspaceAtom,\n  publicWorkspaceIdAtom,\n} from '../atoms/public-workspace';\nimport type { IslandItemNames } from '../components/pure/help-island';\nimport { HelpIsland } from '../components/pure/help-island';\nimport {\n  DROPPABLE_SIDEBAR_TRASH,\n  RootAppSidebar,\n} from '../components/root-app-sidebar';\nimport { useBlockSuiteMetaHelper } from '../hooks/affine/use-block-suite-meta-helper';\nimport { useCurrentWorkspace } from '../hooks/current/use-current-workspace';\nimport { useRouterHelper } from '../hooks/use-router-helper';\nimport { useRouterTitle } from '../hooks/use-router-title';\nimport { useWorkspaces } from '../hooks/use-workspaces';\nimport {\n  AllWorkspaceModals,\n  CurrentWorkspaceModals,\n} from '../providers/modal-provider';\nimport { pathGenerator, publicPathGenerator } from '../shared';\nimport { toast } from '../utils';\n\nconst QuickSearchModal = lazy(() =>\n  import('../components/pure/quick-search-modal').then(module => ({\n    default: module.QuickSearchModal,\n  }))\n);\n\nexport const PublicQuickSearch: FC = () => {\n  const publicWorkspace = useAtomValue(publicWorkspaceAtom);\n  const router = useRouter();\n  const [openQuickSearchModal, setOpenQuickSearchModalAtom] = useAtom(\n    openQuickSearchModalAtom\n  );\n  return (\n    <Suspense>\n      <QuickSearchModal\n        blockSuiteWorkspace={publicWorkspace.blockSuiteWorkspace}\n        open={openQuickSearchModal}\n        setOpen={setOpenQuickSearchModalAtom}\n        router={router}\n      />\n    </Suspense>\n  );\n};\n\nfunction DefaultProvider({ children }: PropsWithChildren) {\n  return <>{children}</>;\n}\n\nexport const QuickSearch: FC = () => {\n  const [currentWorkspace] = useCurrentWorkspace();\n  const router = useRouter();\n  const [openQuickSearchModal, setOpenQuickSearchModalAtom] = useAtom(\n    openQuickSearchModalAtom\n  );\n  const blockSuiteWorkspace = currentWorkspace?.blockSuiteWorkspace;\n  const isPublicWorkspace =\n    router.pathname.split('/')[1] === 'public-workspace';\n  const publicWorkspaceId = useAtomValue(publicWorkspaceIdAtom);\n  if (!blockSuiteWorkspace) {\n    if (isPublicWorkspace && publicWorkspaceId) {\n      return <PublicQuickSearch />;\n    }\n    return null;\n  }\n  return (\n    <QuickSearchModal\n      blockSuiteWorkspace={currentWorkspace?.blockSuiteWorkspace}\n      open={openQuickSearchModal}\n      setOpen={setOpenQuickSearchModalAtom}\n      router={router}\n    />\n  );\n};\n\nconst logger = new DebugLogger('workspace-layout');\n\nconst affineGlobalChannel = createAffineGlobalChannel(\n  WorkspaceAdapters[WorkspaceFlavour.AFFINE].CRUD\n);\n\nexport const AllWorkspaceContext = ({\n  children,\n}: PropsWithChildren): ReactElement => {\n  const currentWorkspaceId = useAtomValue(rootCurrentWorkspaceIdAtom);\n  const workspaces = useWorkspaces();\n  useEffect(() => {\n    const providers = workspaces\n      // ignore current workspace\n      .filter(workspace => workspace.id !== currentWorkspaceId)\n      .flatMap(workspace =>\n        workspace.providers.filter(\n          (provider): provider is BackgroundProvider =>\n            'background' in provider && provider.background\n        )\n      );\n    providers.forEach(provider => {\n      provider.connect();\n    });\n    return () => {\n      providers.forEach(provider => {\n        provider.disconnect();\n      });\n    };\n  }, [currentWorkspaceId, workspaces]);\n  return <>{children}</>;\n};\n\ndeclare global {\n  // eslint-disable-next-line no-var\n  var HALTING_PROBLEM_TIMEOUT: number;\n}\n\nif (globalThis.HALTING_PROBLEM_TIMEOUT === undefined) {\n  globalThis.HALTING_PROBLEM_TIMEOUT = 1000;\n}\n\nexport const CurrentWorkspaceContext = ({\n  children,\n}: PropsWithChildren): ReactElement => {\n  const workspaceId = useAtomValue(rootCurrentWorkspaceIdAtom);\n  const metadata = useAtomValue(rootWorkspacesMetadataAtom);\n  const exist = metadata.find(m => m.id === workspaceId);\n  const router = useRouter();\n  const push = router.push;\n  // fixme(himself65): this is not a good way to handle this,\n  //  need a better way to check whether this workspace really exist.\n  useEffect(() => {\n    const id = setTimeout(() => {\n      if (!exist) {\n        push('/').catch(err => {\n          console.error(err);\n        });\n        globalThis.HALTING_PROBLEM_TIMEOUT <<= 1;\n      }\n    }, globalThis.HALTING_PROBLEM_TIMEOUT);\n    return () => {\n      clearTimeout(id);\n    };\n  }, [push, exist, metadata.length]);\n  if (metadata.length === 0) {\n    return <WorkspaceFallback key=\"no-workspace\" />;\n  }\n  if (!router.isReady) {\n    return <WorkspaceFallback key=\"router-is-loading\" />;\n  }\n  if (!workspaceId) {\n    return <WorkspaceFallback key=\"finding-workspace-id\" />;\n  }\n  if (!exist) {\n    return <WorkspaceFallback key=\"workspace-not-found\" />;\n  }\n  return <>{children}</>;\n};\n\nexport const WorkspaceLayout: FC<PropsWithChildren> =\n  function WorkspacesSuspense({ children }) {\n    const i18n = useI18N();\n    useEffect(() => {\n      document.documentElement.lang = i18n.language;\n      // todo(himself65): this is a hack, we should use a better way to set the language\n      setUpLanguage(i18n)?.catch(error => {\n        console.error(error);\n      });\n    }, [i18n]);\n    useTrackRouterHistoryEffect();\n    const currentWorkspaceId = useAtomValue(rootCurrentWorkspaceIdAtom);\n    const jotaiWorkspaces = useAtomValue(rootWorkspacesMetadataAtom);\n    const meta = useMemo(\n      () => jotaiWorkspaces.find(x => x.id === currentWorkspaceId),\n      [currentWorkspaceId, jotaiWorkspaces]\n    );\n    const set = useSetAtom(rootWorkspacesMetadataAtom);\n    useEffect(() => {\n      logger.info('mount');\n      const controller = new AbortController();\n      const lists = Object.values(WorkspaceAdapters)\n        .sort((a, b) => a.loadPriority - b.loadPriority)\n        .map(({ CRUD }) => CRUD.list);\n\n      async function fetch() {\n        const jotaiWorkspaces = rootStore.get(rootWorkspacesMetadataAtom);\n        const items = [];\n        for (const list of lists) {\n          try {\n            const item = await list();\n            if (jotaiWorkspaces.length) {\n              item.sort((a, b) => {\n                return (\n                  jotaiWorkspaces.findIndex(x => x.id === a.id) -\n                  jotaiWorkspaces.findIndex(x => x.id === b.id)\n                );\n              });\n            }\n            items.push(...item.map(x => ({ id: x.id, flavour: x.flavour })));\n          } catch (e) {\n            logger.error('list data error:', e);\n          }\n        }\n        if (controller.signal.aborted) {\n          return;\n        }\n        set([...items]);\n        logger.info('mount first data:', items);\n      }\n\n      fetch().catch(e => {\n        logger.error('fetch error:', e);\n      });\n      return () => {\n        controller.abort();\n        logger.info('unmount');\n      };\n    }, [set]);\n\n    useEffect(() => {\n      const flavour = jotaiWorkspaces.find(\n        x => x.id === currentWorkspaceId\n      )?.flavour;\n      if (flavour === WorkspaceFlavour.AFFINE) {\n        affineGlobalChannel.connect();\n        return () => {\n          affineGlobalChannel.disconnect();\n        };\n      }\n      return;\n    }, [currentWorkspaceId, jotaiWorkspaces]);\n\n    const Provider =\n      (meta && WorkspaceAdapters[meta.flavour].UI.Provider) ?? DefaultProvider;\n    return (\n      <>\n        {/* load all workspaces is costly, do not block the whole UI */}\n        <Suspense fallback={null}>\n          <AllWorkspaceContext>\n            <AllWorkspaceModals />\n            <CurrentWorkspaceContext>\n              {/* fixme(himself65): don't re-render whole modals */}\n              <CurrentWorkspaceModals key={currentWorkspaceId} />\n            </CurrentWorkspaceContext>\n          </AllWorkspaceContext>\n        </Suspense>\n        <CurrentWorkspaceContext>\n          <Suspense fallback={<WorkspaceFallback />}>\n            <Provider>\n              <WorkspaceLayoutInner>{children}</WorkspaceLayoutInner>\n            </Provider>\n          </Suspense>\n        </CurrentWorkspaceContext>\n      </>\n    );\n  };\n\nexport const WorkspaceLayoutInner: FC<PropsWithChildren> = ({ children }) => {\n  const [currentWorkspace] = useCurrentWorkspace();\n  const setCurrentPageId = useSetAtom(rootCurrentPageIdAtom);\n  const currentPageId = useAtomValue(rootCurrentPageIdAtom);\n  const router = useRouter();\n  const { jumpToPage } = useRouterHelper(router);\n\n  //#region init workspace\n  if (currentWorkspace.blockSuiteWorkspace.isEmpty) {\n    // this is a new workspace, so we should redirect to the new page\n    const pageId = DEFAULT_HELLO_WORLD_PAGE_ID;\n    const page = currentWorkspace.blockSuiteWorkspace.createPage({\n      id: pageId,\n    });\n    assertEquals(page.id, pageId);\n    if (config.enablePreloading) {\n      initPageWithPreloading(page).catch(error => {\n        console.error('import error:', error);\n      });\n    } else {\n      initEmptyPage(page);\n    }\n    if (!router.query.pageId) {\n      setCurrentPageId(pageId);\n      jumpToPage(currentWorkspace.id, pageId).catch(err => {\n        console.error(err);\n      });\n    }\n  }\n  //#endregion\n\n  useEffect(() => {\n    const backgroundProviders = currentWorkspace.providers.filter(\n      (provider): provider is BackgroundProvider => 'background' in provider\n    );\n    backgroundProviders.forEach(provider => {\n      provider.connect();\n    });\n    return () => {\n      backgroundProviders.forEach(provider => {\n        provider.disconnect();\n      });\n    };\n  }, [currentWorkspace]);\n\n  useEffect(() => {\n    if (!currentWorkspace) {\n      return;\n    }\n    const page = currentWorkspace.blockSuiteWorkspace.getPage(\n      DEFAULT_HELLO_WORLD_PAGE_ID\n    );\n    if (page && page.meta.jumpOnce) {\n      currentWorkspace.blockSuiteWorkspace.meta.setPageMeta(\n        DEFAULT_HELLO_WORLD_PAGE_ID,\n        {\n          jumpOnce: false,\n        }\n      );\n      setCurrentPageId(currentPageId);\n      jumpToPage(currentWorkspace.id, page.id).catch(err => {\n        console.error(err);\n      });\n    }\n  }, [\n    currentPageId,\n    currentWorkspace,\n    jumpToPage,\n    router.query.pageId,\n    setCurrentPageId,\n  ]);\n\n  const { openPage } = useRouterHelper(router);\n  const [, setOpenWorkspacesModal] = useAtom(openWorkspacesModalAtom);\n  const helper = useBlockSuiteWorkspaceHelper(\n    currentWorkspace.blockSuiteWorkspace\n  );\n  const isPublicWorkspace =\n    router.pathname.split('/')[1] === 'public-workspace';\n  const title = useRouterTitle(router);\n  const handleCreatePage = useCallback(() => {\n    return helper.createPage(nanoid());\n  }, [helper]);\n  const handleOpenWorkspaceListModal = useCallback(() => {\n    setOpenWorkspacesModal(true);\n  }, [setOpenWorkspacesModal]);\n\n  const [, setOpenQuickSearchModalAtom] = useAtom(openQuickSearchModalAtom);\n  const handleOpenQuickSearchModal = useCallback(() => {\n    setOpenQuickSearchModalAtom(true);\n  }, [setOpenQuickSearchModalAtom]);\n\n  const resizing = useAtomValue(appSidebarResizingAtom);\n\n  const sensors = useSensors(\n    // Delay 10ms after mousedown\n    // Otherwise clicks would be intercepted\n    useSensor(MouseSensor, {\n      activationConstraint: {\n        delay: 500,\n        tolerance: 10,\n      },\n    })\n  );\n\n  const { removeToTrash: moveToTrash } = useBlockSuiteMetaHelper(\n    currentWorkspace.blockSuiteWorkspace\n  );\n  const t = useAFFiNEI18N();\n\n  const showList: IslandItemNames[] = env.isDesktop\n    ? ['whatNew', 'contact', 'guide']\n    : ['whatNew', 'contact'];\n\n  const handleDragEnd = useCallback(\n    (e: DragEndEvent) => {\n      // Drag page into trash folder\n      if (\n        e.over?.id === DROPPABLE_SIDEBAR_TRASH &&\n        String(e.active.id).startsWith('page-list-item-')\n      ) {\n        const { pageId } = e.active.data.current as DraggableTitleCellData;\n        // TODO-Doma\n        // Co-locate `moveToTrash` with the toast for reuse, as they're always used together\n        moveToTrash(pageId);\n        toast(t['Successfully deleted']());\n      }\n    },\n    [moveToTrash, t]\n  );\n\n  return (\n    <>\n      <Head>\n        <title>{title}</title>\n      </Head>\n      {/* This DndContext is used for drag page from all-pages list into a folder in sidebar */}\n      <DndContext\n        sensors={sensors}\n        collisionDetection={pointerWithin}\n        onDragEnd={handleDragEnd}\n      >\n        <AppContainer resizing={resizing}>\n          <RootAppSidebar\n            isPublicWorkspace={isPublicWorkspace}\n            onOpenQuickSearchModal={handleOpenQuickSearchModal}\n            currentWorkspace={currentWorkspace}\n            onOpenWorkspaceListModal={handleOpenWorkspaceListModal}\n            openPage={useCallback(\n              (pageId: string) => {\n                assertExists(currentWorkspace);\n                return openPage(currentWorkspace.id, pageId);\n              },\n              [currentWorkspace, openPage]\n            )}\n            createPage={handleCreatePage}\n            currentPath={router.asPath.split('?')[0]}\n            paths={isPublicWorkspace ? publicPathGenerator : pathGenerator}\n          />\n          <MainContainer>\n            {children}\n            <ToolContainer>\n              {/* fixme(himself65): remove this */}\n              <div id=\"toolWrapper\" style={{ marginBottom: '12px' }}>\n                {/* Slot for block hub */}\n              </div>\n              {!isPublicWorkspace && (\n                <HelpIsland\n                  showList={router.query.pageId ? undefined : showList}\n                />\n              )}\n            </ToolContainer>\n            <AffineWatermark />\n          </MainContainer>\n        </AppContainer>\n        <PageListTitleCellDragOverlay />\n      </DndContext>\n      <QuickSearch />\n    </>\n  );\n};\n\nfunction PageListTitleCellDragOverlay() {\n  const { active } = useDndContext();\n\n  const renderChildren = useCallback(\n    ({ icon, pageTitle }: DraggableTitleCellData) => {\n      return (\n        <StyledTitleLink>\n          {icon}\n          <Content ellipsis={true} color=\"inherit\">\n            {pageTitle}\n          </Content>\n        </StyledTitleLink>\n      );\n    },\n    []\n  );\n\n  return (\n    <DragOverlay\n      style={{\n        zIndex: 1001,\n        backgroundColor: 'var(--affine-black-10)',\n        padding: '0 30px',\n        cursor: 'default',\n        borderRadius: 10,\n        ...displayFlex('flex-start', 'center'),\n      }}\n      dropAnimation={null}\n    >\n      {active\n        ? renderChildren(active.data.current as DraggableTitleCellData)\n        : null}\n    </DragOverlay>\n  );\n}\n","import { WorkspaceFlavour } from '@affine/env/workspace';\nimport { useRouter } from 'next/router';\nimport { useCallback } from 'react';\n\nimport { WorkspaceAdapters } from '../../adapters/workspace';\n\nexport function useAffineLogIn() {\n  const router = useRouter();\n  return useCallback(async () => {\n    await WorkspaceAdapters[WorkspaceFlavour.AFFINE].Events[\n      'workspace:access'\n    ]?.();\n    // todo: remove reload page requirement\n    router.reload();\n  }, [router]);\n}\n","import { env } from '@affine/env';\nimport { WorkspaceSubPath } from '@affine/env/workspace';\nimport {\n  rootCurrentWorkspaceIdAtom,\n  rootWorkspacesMetadataAtom,\n} from '@affine/workspace/atom';\nimport { arrayMove } from '@dnd-kit/sortable';\nimport { useAtom, useSetAtom } from 'jotai';\nimport { useRouter } from 'next/router';\nimport type { ReactElement } from 'react';\nimport { lazy, Suspense, useCallback, useTransition } from 'react';\n\nimport {\n  openCreateWorkspaceModalAtom,\n  openDisableCloudAlertModalAtom,\n  openOnboardingModalAtom,\n  openWorkspacesModalAtom,\n} from '../atoms';\nimport { useAffineLogIn } from '../hooks/affine/use-affine-log-in';\nimport { useAffineLogOut } from '../hooks/affine/use-affine-log-out';\nimport { useCurrentUser } from '../hooks/current/use-current-user';\nimport { useRouterHelper } from '../hooks/use-router-helper';\nimport { useWorkspaces } from '../hooks/use-workspaces';\n\nconst WorkspaceListModal = lazy(() =>\n  import('../components/pure/workspace-list-modal').then(module => ({\n    default: module.WorkspaceListModal,\n  }))\n);\n\nconst CreateWorkspaceModal = lazy(() =>\n  import('../components/affine/create-workspace-modal').then(module => ({\n    default: module.CreateWorkspaceModal,\n  }))\n);\n\nconst TmpDisableAffineCloudModal = lazy(() =>\n  import('../components/affine/tmp-disable-affine-cloud-modal').then(\n    module => ({\n      default: module.TmpDisableAffineCloudModal,\n    })\n  )\n);\n\nconst OnboardingModal = lazy(() =>\n  import('../components/pure/onboarding-modal').then(module => ({\n    default: module.OnboardingModal,\n  }))\n);\n\nexport function CurrentWorkspaceModals() {\n  const [openDisableCloudAlertModal, setOpenDisableCloudAlertModal] = useAtom(\n    openDisableCloudAlertModalAtom\n  );\n  const [openOnboardingModal, setOpenOnboardingModal] = useAtom(\n    openOnboardingModalAtom\n  );\n\n  const onCloseOnboardingModal = useCallback(() => {\n    setOpenOnboardingModal(false);\n  }, [setOpenOnboardingModal]);\n  return (\n    <>\n      <Suspense>\n        <TmpDisableAffineCloudModal\n          open={openDisableCloudAlertModal}\n          onClose={useCallback(() => {\n            setOpenDisableCloudAlertModal(false);\n          }, [setOpenDisableCloudAlertModal])}\n        />\n      </Suspense>\n      {env.isDesktop && (\n        <Suspense>\n          <OnboardingModal\n            open={openOnboardingModal}\n            onClose={onCloseOnboardingModal}\n          />\n        </Suspense>\n      )}\n    </>\n  );\n}\n\nexport const AllWorkspaceModals = (): ReactElement => {\n  const [openWorkspacesModal, setOpenWorkspacesModal] = useAtom(\n    openWorkspacesModalAtom\n  );\n  const [isOpenCreateWorkspaceModal, setOpenCreateWorkspaceModal] = useAtom(\n    openCreateWorkspaceModalAtom\n  );\n\n  const router = useRouter();\n  const { jumpToSubPath } = useRouterHelper(router);\n  const user = useCurrentUser();\n  const workspaces = useWorkspaces();\n  const setWorkspaces = useSetAtom(rootWorkspacesMetadataAtom);\n  const [currentWorkspaceId, setCurrentWorkspaceId] = useAtom(\n    rootCurrentWorkspaceIdAtom\n  );\n  const [transitioning, transition] = useTransition();\n  return (\n    <>\n      <Suspense>\n        <WorkspaceListModal\n          disabled={transitioning}\n          user={user}\n          workspaces={workspaces}\n          currentWorkspaceId={currentWorkspaceId}\n          open={\n            (openWorkspacesModal || workspaces.length === 0) &&\n            isOpenCreateWorkspaceModal === false\n          }\n          onClose={useCallback(() => {\n            setOpenWorkspacesModal(false);\n          }, [setOpenWorkspacesModal])}\n          onMoveWorkspace={useCallback(\n            (activeId, overId) => {\n              const oldIndex = workspaces.findIndex(w => w.id === activeId);\n              const newIndex = workspaces.findIndex(w => w.id === overId);\n              transition(() =>\n                setWorkspaces(workspaces =>\n                  arrayMove(workspaces, oldIndex, newIndex)\n                )\n              );\n            },\n            [setWorkspaces, workspaces]\n          )}\n          onClickWorkspace={useCallback(\n            workspace => {\n              setOpenWorkspacesModal(false);\n              setCurrentWorkspaceId(workspace.id);\n              jumpToSubPath(workspace.id, WorkspaceSubPath.ALL).catch(error => {\n                console.error(error);\n              });\n            },\n            [jumpToSubPath, setCurrentWorkspaceId, setOpenWorkspacesModal]\n          )}\n          onClickWorkspaceSetting={useCallback(\n            workspace => {\n              setOpenWorkspacesModal(false);\n              setCurrentWorkspaceId(workspace.id);\n              jumpToSubPath(workspace.id, WorkspaceSubPath.SETTING).catch(\n                error => {\n                  console.error(error);\n                }\n              );\n            },\n            [jumpToSubPath, setCurrentWorkspaceId, setOpenWorkspacesModal]\n          )}\n          onClickLogin={useAffineLogIn()}\n          onClickLogout={useAffineLogOut()}\n          onNewWorkspace={useCallback(() => {\n            setOpenCreateWorkspaceModal('new');\n          }, [setOpenCreateWorkspaceModal])}\n          onAddWorkspace={useCallback(async () => {\n            setOpenCreateWorkspaceModal('add');\n          }, [setOpenCreateWorkspaceModal])}\n        />\n      </Suspense>\n      <Suspense>\n        <CreateWorkspaceModal\n          mode={isOpenCreateWorkspaceModal}\n          onClose={useCallback(() => {\n            setOpenCreateWorkspaceModal(false);\n          }, [setOpenCreateWorkspaceModal])}\n          onCreate={useCallback(\n            async id => {\n              setOpenCreateWorkspaceModal(false);\n              setOpenWorkspacesModal(false);\n              setCurrentWorkspaceId(id);\n              return jumpToSubPath(id, WorkspaceSubPath.ALL);\n            },\n            [\n              jumpToSubPath,\n              setCurrentWorkspaceId,\n              setOpenCreateWorkspaceModal,\n              setOpenWorkspacesModal,\n            ]\n          )}\n        />\n      </Suspense>\n    </>\n  );\n};\n","import \"../../packages/component/src/components/workspace-avatar/index.css.ts.vanilla.css!=!../../../../../node_modules/@vanilla-extract/webpack-plugin/virtualFileLoader/dist/vanilla-extract-webpack-plugin-virtualFileLoader.cjs.js?{\\\"fileName\\\":\\\"../../packages/component/src/components/workspace-avatar/index.css.ts.vanilla.css\\\",\\\"source\\\":\\\"#H4sIAAAAAAAAE7WW226jMBCG7/MUllaVWilUnDH0pm+ycsAks3VsZEzSapV3X9vkgGmWJlEiJUED4/k88/8E3j/oVy3Jmrbod1Cvs3wDIfo7Q8h/sgeElGgK5MXx05sNGa2VjoNgHytJeFsLuS7QmigJn8+e/xrmc6QPeTpH+je2QZToQH9ezLqd/gbpAXGoiQ81LTKZRGSRrZrmBpH2iCwbIaJwhMgcQuxPEfLMFg0jQwjSvqN8RIjxuInEQUT5FAJjUzvGfSv2F48AafzoFrD/cB0C/9F22s3evzs5cp28Z0V+8+lIdIrPwffq9FIdlZp2cpSNENkkAvfKJKFBRPtmw5+8HI76CKb6CGxRP7SHILzQzOGoj3C6jRvcfP8mvtn5EWIMDP0gV+1mrwcb+5a0hUqtCks2GSsKy5U6xaVgQhboV13XJlwIWVHpSVJB1xYo6ZPEhsqaiW2BVlBVlJtzFbQNI18FAs6AU2/BRPlhLuhcBSVhHmGw5Hrzegmjb8OdBZfsTCz+0FJ5NehzpdnB4GQjWlAgdPWScmUuDarHl1Q/VZCUEQUbek37A1oypOHIgeFgxCKLVrBOWdbRADbnoH4f3CC9aEgJSuuhL5q4BqYHU6AF6+RzoO/AF6eyJyQs4TjA4xwRIhw01G739IcYtYiSlnrAPdEppCtsiaxaLX4NHPqGjgs9YwyvVUTRAjWka2nljCy1IzufLjvOgS+d/Gw44hw7I86ziRE7Dw33kXHbA+NuQ94CY165InypezY7m5vNzk9L/6NEeF8l8JVK5O6tFbtSxBNSyD7nrN2vnKqjGB4q1r9TRMPXiB+12P0DR+wZG8sKAAA=\\\"}!../../../../../node_modules/@vanilla-extract/webpack-plugin/extracted.js\"\nexport var DefaultAvatarBottomItemStyle = '_1fm79vi7';\nexport var DefaultAvatarBottomItemWithAnimationStyle = '_1fm79vi8';\nexport var DefaultAvatarContainerStyle = '_1fm79vi4';\nexport var DefaultAvatarMiddleItemStyle = '_1fm79vi5';\nexport var DefaultAvatarMiddleItemWithAnimationStyle = '_1fm79vi6';\nexport var DefaultAvatarTopItemStyle = '_1fm79vi9';\nexport var avatarImageStyle = '_1fm79vi1';\nexport var avatarStyle = '_1fm79vi0';","import clsx from 'clsx';\nimport { useMemo, useRef, useState } from 'react';\n\nimport {\n  DefaultAvatarBottomItemStyle,\n  DefaultAvatarBottomItemWithAnimationStyle,\n  DefaultAvatarContainerStyle,\n  DefaultAvatarMiddleItemStyle,\n  DefaultAvatarMiddleItemWithAnimationStyle,\n  DefaultAvatarTopItemStyle,\n} from './index.css';\n\nconst colorsSchema = [\n  ['#FF0000', '#FF00E5', '#FFAE73'],\n  ['#FF5C00', '#FFC700', '#FFE073'],\n  ['#FFDA16', '#FFFBA6', '#FFBE73'],\n  ['#8CD317', '#FCFF5C', '#67CAE9'],\n  ['#28E19F', '#89FFC6', '#39A880'],\n  ['#35B7E0', '#77FFCE', '#5076FF'],\n  ['#3D39FF', '#77BEFF', '#3502FF'],\n  ['#BD08EB', '#755FFF', '#6967E4'],\n];\n\nexport const DefaultAvatar = ({ name: propsName }: { name: string }) => {\n  // Sometimes name is ' '\n  const name = propsName || 'A';\n  const colors = useMemo(() => {\n    const index = name[0].toUpperCase().charCodeAt(0);\n    return colorsSchema[index % colorsSchema.length];\n  }, [name]);\n\n  const timer = useRef<ReturnType<typeof setTimeout>>();\n\n  const [topColor, middleColor, bottomColor] = colors;\n  const [isHover, setIsHover] = useState(false);\n\n  return (\n    <div\n      className={DefaultAvatarContainerStyle}\n      onMouseEnter={() => {\n        timer.current = setTimeout(() => {\n          setIsHover(true);\n        }, 300);\n      }}\n      onMouseLeave={() => {\n        clearTimeout(timer.current);\n        setIsHover(false);\n      }}\n    >\n      <div\n        className={DefaultAvatarTopItemStyle}\n        style={{ background: bottomColor }}\n      ></div>\n      <div\n        className={clsx(DefaultAvatarMiddleItemStyle, {\n          [DefaultAvatarMiddleItemWithAnimationStyle]: isHover,\n        })}\n        style={{ background: middleColor }}\n      ></div>\n      <div\n        className={clsx(DefaultAvatarBottomItemStyle, {\n          [DefaultAvatarBottomItemWithAnimationStyle]: isHover,\n        })}\n        style={{ background: topColor }}\n      ></div>\n    </div>\n  );\n};\nexport default DefaultAvatar;\n","import type {\n  AffineLegacyCloudWorkspace,\n  AffinePublicWorkspace,\n  LocalWorkspace,\n} from '@affine/env/workspace';\nimport type { Workspace } from '@blocksuite/store';\nimport * as RadixAvatar from '@radix-ui/react-avatar';\nimport { useBlockSuiteWorkspaceAvatarUrl } from '@toeverything/hooks/use-block-suite-workspace-avatar-url';\nimport { useBlockSuiteWorkspaceName } from '@toeverything/hooks/use-block-suite-workspace-name';\nimport clsx from 'clsx';\nimport type React from 'react';\n\nimport { DefaultAvatar } from './default-avatar';\nimport { avatarImageStyle, avatarStyle } from './index.css';\n\nexport type WorkspaceAvatarProps = {\n  size?: number;\n  workspace:\n    | AffineLegacyCloudWorkspace\n    | LocalWorkspace\n    | AffinePublicWorkspace\n    | null;\n  className?: string;\n};\n\nexport type BlockSuiteWorkspaceAvatar = Omit<\n  WorkspaceAvatarProps,\n  'workspace'\n> & {\n  workspace: Workspace;\n};\n\nexport const BlockSuiteWorkspaceAvatar: React.FC<BlockSuiteWorkspaceAvatar> = ({\n  size,\n  workspace,\n  ...props\n}) => {\n  const [avatar] = useBlockSuiteWorkspaceAvatarUrl(workspace);\n  const [name] = useBlockSuiteWorkspaceName(workspace);\n\n  return (\n    <RadixAvatar.Root\n      {...props}\n      className={clsx(avatarStyle, props.className)}\n      style={{\n        height: size,\n        width: size,\n      }}\n    >\n      <RadixAvatar.Image className={avatarImageStyle} src={avatar} alt={name} />\n      <RadixAvatar.Fallback>\n        <DefaultAvatar name={name}></DefaultAvatar>\n      </RadixAvatar.Fallback>\n    </RadixAvatar.Root>\n  );\n};\n\nexport const WorkspaceAvatar: React.FC<WorkspaceAvatarProps> = ({\n  size = 20,\n  workspace,\n  ...props\n}) => {\n  if (workspace && 'blockSuiteWorkspace' in workspace) {\n    return (\n      <BlockSuiteWorkspaceAvatar\n        {...props}\n        size={size}\n        workspace={workspace.blockSuiteWorkspace}\n      />\n    );\n  }\n  return (\n    <RadixAvatar.Root\n      {...props}\n      className={clsx(avatarStyle, props.className)}\n      style={{\n        height: size,\n        width: size,\n      }}\n    >\n      <RadixAvatar.Fallback>\n        <DefaultAvatar name=\"A\"></DefaultAvatar>\n      </RadixAvatar.Fallback>\n    </RadixAvatar.Root>\n  );\n};\n","import { z } from 'zod';\n\nexport interface User {\n  id: string;\n  name: string;\n  email: string;\n  avatar_url: string;\n  create_at: string;\n}\n\nexport interface GetUserByEmailParams {\n  email: string;\n  workspace_id: string;\n}\n\nexport const usageResponseSchema = z.object({\n  blob_usage: z.object({\n    usage: z.number(),\n    max_usage: z.number(),\n  }),\n});\n\nexport type UsageResponse = z.infer<typeof usageResponseSchema>;\n\nexport interface GetWorkspaceDetailParams {\n  id: string;\n}\n\nexport enum WorkspaceType {\n  Private = 0,\n  Normal = 1,\n}\n\nexport enum PermissionType {\n  Read = 0,\n  Write = 1,\n  Admin = 10,\n  Owner = 99,\n}\n\nexport const userSchema = z.object({\n  id: z.string(),\n  name: z.string(),\n  email: z.string(),\n  avatar_url: z.string(),\n  created_at: z.number(),\n});\n\nexport const workspaceSchema = z.object({\n  id: z.string(),\n  type: z.nativeEnum(WorkspaceType),\n  public: z.boolean(),\n  permission: z.nativeEnum(PermissionType),\n});\n\nexport type Workspace = z.infer<typeof workspaceSchema>;\n\nexport const workspaceDetailSchema = z.object({\n  ...workspaceSchema.shape,\n  permission: z.undefined(),\n  owner: userSchema,\n  member_count: z.number(),\n});\n\nexport type WorkspaceDetail = z.infer<typeof workspaceDetailSchema>;\n\nexport interface Permission {\n  id: string;\n  type: PermissionType;\n  workspace_id: string;\n  user_id: string;\n  user_email: string;\n  accepted: boolean;\n  create_at: number;\n}\n\nexport interface RegisteredUser extends User {\n  type: 'Registered';\n}\n\nexport interface UnregisteredUser {\n  type: 'Unregistered';\n  email: string;\n}\n\nexport interface Member extends Permission {\n  user: RegisteredUser | UnregisteredUser;\n}\n\nexport interface GetWorkspaceMembersParams {\n  id: string;\n}\n\nexport interface CreateWorkspaceParams {\n  name: string;\n}\n\nexport interface UpdateWorkspaceParams {\n  id: string;\n  public: boolean;\n}\n\nexport interface DeleteWorkspaceParams {\n  id: string;\n}\n\nexport interface InviteMemberParams {\n  id: string;\n  email: string;\n}\n\nexport interface RemoveMemberParams {\n  permissionId: number;\n}\n\nexport interface AcceptInvitingParams {\n  invitingCode: string;\n}\n\nexport interface LeaveWorkspaceParams {\n  id: number | string;\n}\n\nexport const createWorkspaceResponseSchema = z.object({\n  id: z.string(),\n  public: z.boolean(),\n  type: z.nativeEnum(WorkspaceType),\n  created_at: z.number(),\n});\n","import type { Workspace } from '@blocksuite/store';\nimport { assertExists } from '@blocksuite/store';\nimport { useCallback, useEffect, useState } from 'react';\nimport useSWR from 'swr';\n\nexport function useBlockSuiteWorkspaceAvatarUrl(\n  blockSuiteWorkspace: Workspace\n) {\n  const [url, set] = useState(() => blockSuiteWorkspace.meta.avatar);\n  if (url !== blockSuiteWorkspace.meta.avatar) {\n    set(blockSuiteWorkspace.meta.avatar);\n  }\n  const { data: avatar, mutate } = useSWR(url, {\n    fetcher: async avatar => {\n      assertExists(blockSuiteWorkspace);\n      const blobs = await blockSuiteWorkspace.blobs;\n      const blob = await blobs.get(avatar);\n      if (blob) {\n        return URL.createObjectURL(blob);\n      }\n      return null;\n    },\n    suspense: true,\n    fallbackData: null,\n  });\n  const setAvatar = useCallback(\n    async (file: File) => {\n      assertExists(blockSuiteWorkspace);\n      const blob = new Blob([file], { type: file.type });\n      const blobs = await blockSuiteWorkspace.blobs;\n      const blobId = await blobs.set(blob);\n      blockSuiteWorkspace.meta.setAvatar(blobId);\n      await mutate(blobId);\n    },\n    [blockSuiteWorkspace, mutate]\n  );\n  useEffect(() => {\n    if (blockSuiteWorkspace) {\n      const dispose = blockSuiteWorkspace.meta.commonFieldsUpdated.on(() => {\n        set(blockSuiteWorkspace.meta.avatar);\n      });\n      return () => {\n        dispose.dispose();\n      };\n    }\n    return;\n  }, [blockSuiteWorkspace]);\n  return [avatar ?? null, setAvatar] as const;\n}\n","import type { Page, Workspace } from '@blocksuite/store';\nimport { assertExists } from '@blocksuite/store';\nimport {\n  getMilestones,\n  markMilestone,\n  revertUpdate,\n} from '@toeverything/y-indexeddb';\nimport { useMemo } from 'react';\n\nexport function useBlockSuiteWorkspaceHelper(blockSuiteWorkspace: Workspace) {\n  return useMemo(\n    () => ({\n      createPage: (pageId?: string): Page => {\n        assertExists(blockSuiteWorkspace);\n        return blockSuiteWorkspace.createPage({ id: pageId });\n      },\n      markMilestone: async (name: string) => {\n        assertExists(blockSuiteWorkspace);\n        const doc = blockSuiteWorkspace.doc;\n        await markMilestone(blockSuiteWorkspace.id, doc, name);\n      },\n      revertMilestone: async (name: string) => {\n        assertExists(blockSuiteWorkspace);\n        const doc = blockSuiteWorkspace.doc;\n        const list = await getMilestones(blockSuiteWorkspace.id);\n        if (!list) {\n          throw new Error('no milestone');\n        }\n        const milestone = list[name];\n        if (milestone) {\n          revertUpdate(doc, milestone, () => 'Map');\n        }\n      },\n      listMilestone: async () => {\n        assertExists(blockSuiteWorkspace);\n        return await getMilestones(blockSuiteWorkspace.id);\n      },\n    }),\n    [blockSuiteWorkspace]\n  );\n}\n","import { UNTITLED_WORKSPACE_NAME } from '@affine/env';\nimport type { Workspace } from '@blocksuite/store';\nimport { assertExists } from '@blocksuite/store';\nimport type { Atom, WritableAtom } from 'jotai';\nimport { atom, useAtom } from 'jotai';\n\nconst weakMap = new WeakMap<\n  Workspace,\n  WritableAtom<string, [string], void> & Atom<string>\n>();\n\nconst emptyWorkspaceNameAtom = atom(UNTITLED_WORKSPACE_NAME, () => {\n  console.warn('you cannot set the name of an null workspace.');\n  console.warn('this is a bug in the code.');\n});\n\nexport function useBlockSuiteWorkspaceName(\n  blockSuiteWorkspace: Workspace | null\n) {\n  let nameAtom:\n    | (WritableAtom<string, [string], void> & Atom<string>)\n    | undefined;\n  if (!blockSuiteWorkspace) {\n    nameAtom = emptyWorkspaceNameAtom;\n  } else if (!weakMap.has(blockSuiteWorkspace)) {\n    const baseAtom = atom<string>(\n      blockSuiteWorkspace.meta.name ?? UNTITLED_WORKSPACE_NAME\n    );\n    const writableAtom = atom(\n      get => get(baseAtom),\n      (get, set, name: string) => {\n        blockSuiteWorkspace.meta.setName(name);\n        set(baseAtom, name);\n      }\n    );\n    baseAtom.onMount = set => {\n      const dispose = blockSuiteWorkspace.meta.commonFieldsUpdated.on(() => {\n        set(blockSuiteWorkspace.meta.name ?? '');\n      });\n      return () => {\n        dispose.dispose();\n      };\n    };\n    weakMap.set(blockSuiteWorkspace, writableAtom);\n    nameAtom = writableAtom;\n  } else {\n    nameAtom = weakMap.get(blockSuiteWorkspace);\n    assertExists(nameAtom);\n  }\n  return useAtom(nameAtom);\n}\n","import type { Page, Workspace } from '@blocksuite/store';\nimport { assertExists, DisposableGroup } from '@blocksuite/store';\nimport type { Atom } from 'jotai';\nimport { atom, useAtomValue } from 'jotai';\n\nconst weakMap = new WeakMap<Workspace, Map<string, Atom<Page | null>>>();\n\nconst emptyAtom = atom<Page | null>(null);\n\nfunction getAtom(w: Workspace, pageId: string | null): Atom<Page | null> {\n  if (!pageId) {\n    return emptyAtom;\n  }\n  if (!weakMap.has(w)) {\n    weakMap.set(w, new Map());\n  }\n  const map = weakMap.get(w);\n  assertExists(map);\n  if (!map.has(pageId)) {\n    const baseAtom = atom(w.getPage(pageId));\n    baseAtom.onMount = set => {\n      const group = new DisposableGroup();\n      group.add(\n        w.slots.pageAdded.on(id => {\n          if (pageId === id) {\n            set(w.getPage(id));\n          }\n        })\n      );\n      group.add(\n        w.slots.pageRemoved.on(id => {\n          if (pageId === id) {\n            set(null);\n          }\n        })\n      );\n      return () => {\n        group.dispose();\n      };\n    };\n    map.set(pageId, baseAtom);\n    return baseAtom;\n  } else {\n    return map.get(pageId) as Atom<Page | null>;\n  }\n}\n\nexport function useBlockSuiteWorkspacePage(\n  blockSuiteWorkspace: Workspace,\n  pageId: string | null\n): Page | null {\n  const pageAtom = getAtom(blockSuiteWorkspace, pageId);\n  assertExists(pageAtom);\n  return useAtomValue(pageAtom);\n}\n","// extracted by mini-css-extract-plugin","// extracted by mini-css-extract-plugin","// extracted by mini-css-extract-plugin","// extracted by mini-css-extract-plugin"],"names":["createPublicWorkspace","workspaceId","binary","singlePage","blockSuiteWorkspace","createEmptyBlockSuiteWorkspace","WorkspaceFlavour","workspaceApis","affineApis","cachePrefix","BlockSuiteWorkspace","doc","Uint8Array","Object","entries","config","forEach","key","value","param","awarenessStore","setFlag","flavour","id","providers","publicWorkspaceIdAtom","atom","publicWorkspacePageIdAtom","publicPageBlockSuiteAtom","get","pageId","publicWorkspaceAtom","currentModeAtom","rootCurrentPageIdAtom","pageSettingFamily","mode","useCurrentMode","useAtomValue","useCurrentUser","currentAffineUserAtom","useCurrentWorkspace","currentWorkspace","rootCurrentWorkspaceAtom","setId","useAtom","rootCurrentWorkspaceIdAtom","setPageId","useCallback","localStorage","setItem","useRouterTitle","router","useMemo","isReady","query","pathname","startsWith","subPath","split","at","WorkspaceSubPathName","useWorkspaces","workspacesAtom","logger","DebugLogger","useAppHelper","workspaces","jotaiWorkspaces","rootWorkspacesMetadataAtom","set","useSetAtom","createWorkspacePage","workspace","find","ws","createPage","addLocalWorkspace","saveWorkspaceToLocalStorage","debug","createLocalWorkspace","name","nanoid","meta","setName","LocalAdapter","deleteWorkspace","targetJotaiWorkspace","targetWorkspace","WorkspaceAdapters","CRUD","delete","filter","AffineLogoIcon","emotion_react_jsx_runtime_browser_esm","tZ","svg","xmlns","viewBox","BX","g","path","d","rect","fill","width","height","AffineWatermark","t","useAFFiNEI18N","div","className","clsx","data-testid","a","href","WebsocketClient","connect","callback","loginResponse","getLoginStorage","isExpired","parseIdToken","token","cleanupWorkspace","assertExists","encodedParams","url","serverUrl","baseServerUrl","length","_client","websocket","_callback","_setupChannel","on","disconnect","off","destroy","client","_logger","shouldReconnect","_retryTimes","error","isLogin","connected","setTimeout","info","concat","e","constructor","_define_property","_","endsWith","slice","channelMessageSchema","z","ws_list","workspaceSchema","ws_details","workspaceDetailSchema","metadata","search_index","historyBaseAtom","stack","current","skip","useMacKeyboardShortcuts","number","useMacMarkdownShortcuts","useWindowsKeyboardShortcuts","useWinMarkdownShortcuts","KeyboardIcon","StyledShortcutsModal","styled","paddingBottom","backgroundColor","boxShadow","borderRadius","overflow","boxRadius","position","right","top","bottom","margin","zIndex","StyledTitle","color","fontWeight","fontSize","displayFlex","marginRight","StyledSubTitle","lineHeight","marginTop","padding","StyledModalHeader","paddingTop","left","background","transition","StyledListItem","checkIsMac","env","ShortcutsModal","open","onClose","macMarkdownShortcuts","winMarkdownShortcuts","macKeyboardShortcuts","windowsKeyboardShortcuts","isMac","setIsMac","useState","useEffect","MuiSlide","direction","in","mountOnEnter","unmountOnExit","MuiClickAwayListener","onClickAway","ModalCloseButton","size","iconSize","onClick","style","map","title","shortcuts","span","HelpIcon","fillRule","clipRule","ContactIcon","StyledIsland","spread","inEdgelessPage","content","positionAbsolute","StyledIconWrapper","cursor","StyledAnimateWrapper","StyledTriggerWrapper","ContactModal","lazy","__webpack_require__","then","bind","default","DEFAULT_SHOW_LIST","DESKTOP_SHOW_LIST","HelpIsland","showList","setOpenOnboarding","openOnboardingModalAtom","setShowSpread","setOpen","openShortCut","setOpenShortCut","HY","includes","Tooltip","placement","window","NewIcon","UserGuideIcon","MuiFade","CloseIcon","Suspense","logoSrc","getPageReferences","page","getBlockByFlavour","flatMap","b","text","toDelta","v","attributes","reference","Boolean","pageReferencesAtomFamily","atomFamily","baseAtom","onMount","dispose","slots","yUpdated","EmptyItem","MenuItem","disabled","FavoriteMenuItem","metaMapping","parentIds","useRouter","setting","active","icon","EdgelessIcon","PageIcon","references","useBlockSuitePageReferences","useBlockSuiteWorkspacePage","referencesToShow","Set","ref","has","trash","collapsed","setCollapsed","collapsible","nestedItem","untitled","Collapsible","data-nested","MenuLinkItem","data-type","undefined","onCollapsedChange","data-untitled","FavoriteList","metas","useBlockSuitePageMeta","favoriteList","p","favorite","reduce","acc","pageMeta","index","StyledSelectorContainer","display","alignItems","StyledSelectorWrapper","marginLeft","flexGrow","StyledWorkspaceName","userSelect","textEllipsis","StyledWorkspaceStatus","WorkspaceSelector","useBlockSuiteWorkspaceName","handleKeyDown","preventDefault","role","tabIndex","onKeyDown","WorkspaceAvatar","LocalWorkspaceIcon","CloudWorkspaceIcon","RouteMenuLinkItem","React","currentPath","children","isDraggedOver","props","displayName","DROPPABLE_SIDEBAR_TRASH","RootAppSidebar","openPage","paths","onOpenQuickSearchModal","onOpenWorkspaceListModal","currentWorkspaceId","onClickNewPage","environment","isDesktop","events","applicationMenu","onNewPageAction","sidebarOpen","setSidebarOpen","appSidebarOpenAtom","apis","ui","handleSidebarVisibilityChange","catch","err","console","keydown","metaKey","ctrlKey","document","addEventListener","capture","removeEventListener","history","setHistory","useHistoryAtom","base","setBase","prev","forward","target","Math","min","push","max","back","trashDroppable","useDroppable","AppSidebar","SidebarContainer","QuickSearchInput","FolderIcon","all","SettingsIcon","SidebarScrollableContainer","CategoryDivider","label","public","ShareIcon","shared","setNodeRef","isOver","DeleteTemporarilyIcon","AppUpdaterButton","AddPageButton","QuickSearchModal","Promise","module","PublicQuickSearch","publicWorkspace","openQuickSearchModal","setOpenQuickSearchModalAtom","openQuickSearchModalAtom","DefaultProvider","QuickSearch","isPublicWorkspace","publicWorkspaceId","affineGlobalChannel","createAffineGlobalChannel","crud","handleMessage","channelMessage","parseResult","safeParse","success","currentWorkspaces","list","workspaceIndex","findIndex","rootStore","idx","splice","websocketPrefixUrl","storageChangeSlot","AllWorkspaceContext","provider","globalThis","HALTING_PROBLEM_TIMEOUT","CurrentWorkspaceContext","exist","m","clearTimeout","WorkspaceFallback","WorkspaceLayout","i18n","useI18N","setUpLanguage","documentElement","lang","language","useTrackRouterHistoryEffect","log","newStack","shift","x","controller","AbortController","lists","values","sort","loadPriority","fetch","items","item","signal","aborted","abort","Provider","UI","fallback","AllWorkspaceModals","CurrentWorkspaceModals","WorkspaceLayoutInner","setCurrentPageId","currentPageId","jumpToPage","useRouterHelper","isEmpty","DEFAULT_HELLO_WORLD_PAGE_ID","assertEquals","initPageWithPreloading","initEmptyPage","backgroundProviders","getPage","jumpOnce","setPageMeta","setOpenWorkspacesModal","openWorkspacesModalAtom","helper","useBlockSuiteWorkspaceHelper","handleCreatePage","handleOpenWorkspaceListModal","handleOpenQuickSearchModal","resizing","appSidebarResizingAtom","sensors","useSensors","useSensor","MouseSensor","activationConstraint","delay","tolerance","removeToTrash","moveToTrash","useBlockSuiteMetaHelper","handleDragEnd","over","String","data","toast","Head","DndContext","collisionDetection","pointerWithin","onDragEnd","AppContainer","asPath","publicPathGenerator","pathGenerator","MainContainer","ToolContainer","marginBottom","PageListTitleCellDragOverlay","useDndContext","renderChildren","pageTitle","StyledTitleLink","Content","ellipsis","DragOverlay","dropAnimation","WorkspaceListModal","CreateWorkspaceModal","TmpDisableAffineCloudModal","OnboardingModal","openDisableCloudAlertModal","setOpenDisableCloudAlertModal","openDisableCloudAlertModalAtom","openOnboardingModal","setOpenOnboardingModal","onCloseOnboardingModal","openWorkspacesModal","isOpenCreateWorkspaceModal","setOpenCreateWorkspaceModal","openCreateWorkspaceModalAtom","jumpToSubPath","user","setWorkspaces","setCurrentWorkspaceId","transitioning","useTransition","onMoveWorkspace","activeId","overId","oldIndex","w","newIndex","arrayMove","onClickWorkspace","WorkspaceSubPath","onClickWorkspaceSetting","onClickLogin","useAffineLogIn","Events","reload","onClickLogout","useAffineLogOut","onNewWorkspace","onAddWorkspace","onCreate","avatarStyle","colorsSchema","DefaultAvatar","propsName","colors","toUpperCase","charCodeAt","timer","useRef","topColor","middleColor","bottomColor","isHover","setIsHover","onMouseEnter","onMouseLeave","BlockSuiteWorkspaceAvatar","avatar","useBlockSuiteWorkspaceAvatarUrl","RadixAvatar","src","alt","WorkspaceType","PermissionType","blob_usage","usage","max_usage","Private","Normal","Read","Write","Admin","Owner","userSchema","email","avatar_url","created_at","type","permission","shape","owner","member_count","mutate","useSWR","fetcher","blobs","blob","URL","createObjectURL","suspense","fallbackData","setAvatar","file","Blob","blobId","commonFieldsUpdated","markMilestone","revertMilestone","getMilestones","milestone","revertUpdate","listMilestone","weakMap","WeakMap","emptyWorkspaceNameAtom","UNTITLED_WORKSPACE_NAME","warn","nameAtom","writableAtom","emptyAtom","pageAtom","getAtom","Map","group","DisposableGroup","add","pageAdded","pageRemoved"],"sourceRoot":""}