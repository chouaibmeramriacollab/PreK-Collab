(self.webpackChunk_N_E = self.webpackChunk_N_E || []).push([
  [1264],
  {
    43631: function (e, t, n) {
      'use strict';
      n.d(t, {
        Uv: function () {
          return d;
        },
        _c: function () {
          return u;
        },
        bq: function () {
          return h;
        },
        sd: function () {
          return C;
        },
      });
      var r = n(96893),
        a = n(91337),
        i = n(78981),
        o = n(62980),
        l = n(65058),
        c = n(84610);
      function s(e, t) {
        let n = arguments.length > 2 && void 0 !== arguments[2] && arguments[2],
          l = (0, o.LM)(e, a.b8.AFFINE, {
            workspaceApis: i._,
            cachePrefix: a.b8.PUBLIC + (n ? '-single-page' : ''),
          });
        return (
          c.w_.Y.applyUpdate(l.doc, new Uint8Array(t)),
          Object.entries(r.vc.editorFlags).forEach(e => {
            let [t, n] = e;
            l.awarenessStore.setFlag(t, n);
          }),
          l.awarenessStore.setFlag('enable_block_hub', !1),
          l.awarenessStore.setFlag('enable_drag_handle', !1),
          { flavour: a.b8.PUBLIC, id: e, blockSuiteWorkspace: l, providers: [] }
        );
      }
      let d = (0, l.cn)(null),
        u = (0, l.cn)(null),
        h = (0, l.cn)(async e => {
          let t = e(d),
            n = e(u);
          if (!t || !n) throw Error('No workspace id or page id');
          let r = await i._.downloadPublicWorkspacePage(t, n);
          return s(t, r, !0);
        }),
        C = (0, l.cn)(async e => {
          let t = e(d);
          if (!t) throw Error('No workspace id');
          let n = await i._.downloadWorkspace(t, !0);
          return s(t, n, !1);
        });
    },
    14762: function (e, t, n) {
      'use strict';
      n.d(t, {
        D: function () {
          return c;
        },
      });
      var r = n(14192),
        a = n(65058),
        i = n(752),
        o = n(74090);
      let l = (0, a.cn)(e => {
          var t, n;
          let a = e(r.dv);
          return a &&
            null !==
              (n =
                null === (t = e((0, o.G9)(a))) || void 0 === t
                  ? void 0
                  : t.mode) &&
            void 0 !== n
            ? n
            : 'page';
        }),
        c = () => (0, i.Dv)(l);
    },
    76641: function (e, t, n) {
      'use strict';
      n.d(t, {
        x: function () {
          return i;
        },
      });
      var r = n(42049),
        a = n(752);
      function i() {
        return (0, a.Dv)(r.j);
      }
    },
    96450: function (e, t, n) {
      'use strict';
      n.d(t, {
        $: function () {
          return l;
        },
      });
      var r = n(14192),
        a = n(752),
        i = n(2784),
        o = n(37956);
      function l() {
        let e = (0, a.Dv)(o.x),
          [, t] = (0, a.KO)(r.At),
          [, n] = (0, a.KO)(r.dv);
        return [
          e,
          (0, i.useCallback)(
            e => {
              e && localStorage.setItem('last_workspace_id', e), n(null), t(e);
            },
            [t, n]
          ),
        ];
      }
    },
    53430: function (e, t, n) {
      'use strict';
      n.d(t, {
        d: function () {
          return i;
        },
      });
      var r = n(2784),
        a = n(84610);
      function i(e) {
        return (0, r.useMemo)(() => {
          if (!e.isReady) return 'Loading...';
          if (
            !e.query.pageId &&
            e.pathname.startsWith('/workspace/[workspaceId]/')
          ) {
            let t = e.pathname.split('/').at(-1);
            if (t && t in a.HY) return a.HY[t] + ' - AFFiNE';
          }
          return 'AFFiNE';
        }, [e]);
      }
    },
    87175: function (e, t, n) {
      'use strict';
      n.d(t, {
        _: function () {
          return p;
        },
        z: function () {
          return v;
        },
      });
      var r = n(5587),
        a = n(91337),
        i = n(14192),
        o = n(3040),
        l = n(62980),
        c = n(13246),
        s = n(752),
        d = n(2784),
        u = n(1788),
        h = n(66844),
        C = n(74090);
      function p() {
        return (0, s.Dv)(C.l4);
      }
      let f = new r.b('use-workspaces');
      function v() {
        let e = p(),
          t = (0, s.Dv)(i.nn),
          n = (0, s.b9)(i.nn);
        return {
          createWorkspacePage: (0, d.useCallback)(
            (t, n) => {
              let r = e.find(e => e.id === t);
              if (r && 'blockSuiteWorkspace' in r)
                r.blockSuiteWorkspace.createPage({ id: n });
              else
                throw Error(
                  'cannot create page. blockSuiteWorkspace not found'
                );
            },
            [e]
          ),
          addLocalWorkspace: (0, d.useCallback)(
            async e => (
              (0, o.q)(e),
              n(t => [...t, { id: e, flavour: a.b8.LOCAL }]),
              f.debug('imported local workspace', e),
              e
            ),
            [n]
          ),
          createLocalWorkspace: (0, d.useCallback)(
            async e => {
              let t = (0, l.LM)((0, c.x0)(), a.b8.LOCAL);
              t.meta.setName(e);
              let r = await u.M.CRUD.create(t);
              return (
                n(e => [...e, { id: r, flavour: a.b8.LOCAL }]),
                f.debug('created local workspace', r),
                r
              );
            },
            [n]
          ),
          deleteWorkspace: (0, d.useCallback)(
            async r => {
              let a = t.find(e => e.id === r),
                i = e.find(e => e.id === r);
              if (!a || !i) throw Error('page cannot be found');
              await h.WorkspaceAdapters[i.flavour].CRUD.delete(i),
                n(e => e.filter(e => e.id !== r));
            },
            [t, n, e]
          ),
        };
      }
    },
    11264: function (e, t, n) {
      'use strict';
      n.d(t, {
        rz: function () {
          return eV;
        },
        PJ: function () {
          return e$;
        },
      });
      var r = n(52903),
        a = n(37565),
        i = n(72013),
        o = n(6277);
      n(89365);
      let l = () =>
          (0, r.tZ)('svg', {
            id: 'Layer_2',
            xmlns: 'http://www.w3.org/2000/svg',
            viewBox: '0 0 1459.61 470',
            children: (0, r.BX)('g', {
              id: '_6_export',
              children: [
                (0, r.tZ)('path', {
                  id: 'logo-black',
                  d: 'm404.14,350.34c-5.95-10.33-15.86-27.48-25.65-44.42-2.97-5.14-5.92-10.25-8.75-15.15-5.82-10.08-11.12-19.27-14.9-25.83-26.23-45.33-77.87-135.08-103.67-179.46-7.95-12.37-26.37-11.39-33.21,1.42-7.76,13.45-16.3,28.24-25.32,43.87-2.86,4.96-5.78,10.01-8.73,15.12-37.58,65.08-81.56,141.26-112.89,195.52-1.6,2.9-4.58,7.63-6.07,10.76-2.61,5.65-2.1,12.69,1.19,17.91,3.71,6.18,10.65,9.57,17.74,9.22,8.53,0,26.62-.01,50.01,0,5.55,0,11.4,0,17.49,0,81.33,0,205.57.05,236.06,0,14.81.03,24.1-16.21,16.72-28.97Zm-175.07-57.64l-14.97-25.93c-2.63-4.56.66-10.26,5.92-10.26h29.94c5.27,0,8.56,5.7,5.92,10.26l-14.97,25.93c-2.63,4.56-9.21,4.56-11.85,0Zm-25.08-48.29c-1.24-3.16-2.31-6.37-3.19-9.63l49.53,9.63h-46.34Zm22.62,68.22c-2.11,2.66-4.36,5.19-6.74,7.59l-16.43-47.71,23.16,40.12Zm47.78-53.7c3.35.5,6.67,1.19,9.93,2.05l-33.1,38.08,23.17-40.13Zm-76.64-40.4c-.53-4.82-.76-9.69-.74-14.57l65.41,31.91-64.68-17.33Zm-7.76,47.77l17.32,64.65c-3.91,2.87-8.01,5.51-12.25,7.93l-5.08-72.58Zm109.93.17c4.44,1.95,8.77,4.19,12.99,6.65l-60.34,40.7,47.35-47.35Zm-101.41-83.09c1.2-8.86,3.05-17.59,5.29-25.96l99.37,86.38-104.65-60.42Zm-22.02,164.51c-8.27,3.39-16.75,6.15-25.12,8.39l25.12-129.23v120.84Zm153.49-63.19c7.07,5.47,13.71,11.44,19.84,17.56l-124.49,42.86,104.65-60.42Zm-90.64-175.85c18.32,31.79,44.92,77.89,70.26,121.77l-94.61-94.61c5.56-9.62,10.83-18.75,15.69-27.18,1.93-3.33,6.73-3.33,8.66,0Zm-147.77,240.92c5.21-8.99,12.37-21.32,13.96-24.16,15.08-26.12,35.39-61.29,56.37-97.63l-34.65,129.3c-12.41,0-23.11,0-31.35,0-3.85,0-6.26-4.17-4.33-7.5Zm282.54,7.53c-28.89,0-84.98,0-140.67,0l129.31-34.65c6.78,11.74,12.21,21.14,15.69,27.16,1.93,3.33-.48,7.49-4.32,7.49Z',
                }),
                (0, r.tZ)('rect', {
                  fill: 'none',
                  width: '1459.61',
                  height: '470',
                }),
                (0, r.tZ)('path', {
                  d: 'm594.24,116.6c-1.17-4.72-5.41-8.03-10.27-8.03h-16.41c-4.86,0-9.1,3.31-10.27,8.03l-55.64,224.39c-1.65,6.67,3.39,13.12,10.27,13.12h5.66c4.92,0,9.19-3.39,10.3-8.18l11.85-50.91c1.11-4.79,5.38-8.18,10.3-8.18h51.46c4.92,0,9.19,3.39,10.3,8.18l11.85,50.91c1.11,4.79,5.38,8.18,10.3,8.18h5.66c6.87,0,11.92-6.45,10.27-13.12l-55.64-224.39Zm-3.15,146.69h-30.65c-6.81,0-11.85-6.34-10.3-12.97l20.48-98.57c1.27-5.45,9.03-5.45,10.3,0l20.48,98.57c1.54,6.63-3.49,12.97-10.3,12.97Z',
                }),
                (0, r.tZ)('path', {
                  d: 'm994.58,215.86h-126.97c-5.84,0-10.58-4.74-10.58-10.58v-53.08c0-11.1,9-20.1,20.1-20.1h62.83c5.84,0,10.58-4.74,10.58-10.58v-2.39c0-5.84-4.74-10.58-10.58-10.58h-70.32c-22.2,0-40.19,18-40.19,40.19v67.1h-113.04c-5.84,0-10.58-4.74-10.58-10.58v-53.08c0-11.1,9-20.1,20.1-20.1h62.83c5.84,0,10.58-4.74,10.58-10.58v-2.39c0-5.84-4.74-10.58-10.58-10.58h-70.32c-22.2,0-40.19,18-40.19,40.19v194.77c0,5.84,4.74,10.58,10.58,10.58h6.43c5.84,0,10.58-4.74,10.58-10.58v-93.54c0-5.84,4.74-10.58,10.58-10.58h113.04v104.12c0,5.84,4.74,10.58,10.58,10.58h6.43c5.84,0,10.58-4.74,10.58-10.58v-93.54c0-5.84,4.74-10.58,10.58-10.58h120.16c11.1,0,20.1,9,20.1,20.1v84.14c0,5.84,4.74,10.58,10.58,10.58h5.75c5.84,0,10.58-4.74,10.58-10.58v-87.59c0-22.2-18-40.19-40.19-40.19Z',
                }),
                (0, r.tZ)('path', {
                  d: 'm1202.87,108.57h-5.79c-5.83,0-10.56,4.72-10.58,10.54l-.64,201.36-57.7-204.2c-1.29-4.56-5.44-7.7-10.18-7.7h-25.15c-5.84,0-10.58,4.74-10.58,10.58v224.39c0,5.84,4.74,10.58,10.58,10.58h5.79c5.83,0,10.56-4.72,10.58-10.54l.64-201.36,57.7,204.2c1.29,4.56,5.44,7.7,10.18,7.7h25.15c5.84,0,10.58-4.74,10.58-10.58V119.14c0-5.84-4.74-10.58-10.58-10.58Z',
                }),
                (0, r.tZ)('path', {
                  d: 'm1293.92,132.11h59.81c5.84,0,10.58-4.74,10.58-10.58v-2.39c0-5.84-4.74-10.58-10.58-10.58h-66.95c-22.2,0-40.19,18-40.19,40.19v165.15c0,22.2,18,40.19,40.19,40.19h66.95c5.84,0,10.58-4.74,10.58-10.58v-2.39c0-5.84-4.74-10.58-10.58-10.58h-59.81c-11.1,0-20.1-9-20.1-20.1v-63.84c0-5.84,4.74-10.58,10.58-10.58h65.96c5.84,0,10.58-4.74,10.58-10.58v-2.39c0-5.84-4.74-10.58-10.58-10.58h-65.96c-5.84,0-10.58-4.74-10.58-10.58v-49.72c0-11.1,9-20.1,20.1-20.1Z',
                }),
                (0, r.tZ)('path', {
                  d: 'm1018.67,138.5c-4.7-4.7-12.71-2.55-14.43,3.87l-7.77,29.01c-1.72,6.41,4.15,12.28,10.57,10.57l29.01-7.77c6.42-1.72,8.56-9.74,3.87-14.43l-21.23-21.23Z',
                }),
              ],
            }),
          }),
        c = () => {
          let e = (0, i.X)();
          return (0, r.tZ)('div', {
            className: (0, o.Z)(),
            children: (0, r.tZ)('div', {
              'data-testid': 'affine-watermark',
              className: (0, o.Z)('_16fs3wi0'),
              children: (0, r.BX)('a', {
                className: '_16fs3wi1',
                href: 'https://affine.pro',
                children: [
                  (0, r.tZ)('div', {
                    className: '_16fs3wi2',
                    children: e['Created with'](),
                  }),
                  (0, r.tZ)(l, {}),
                ],
              }),
            }),
          });
        };
      var s = n(90301),
        d = n(8183),
        u = n(90643),
        h = n(5587),
        C = n(96893),
        p = n(33027),
        f = n(91337),
        v = n(44502),
        g = n(16844),
        b = n(49889),
        k = n(31054),
        m = n(1347),
        Z = n(30195),
        w = n(87612),
        x = n(74195),
        y = n(91530),
        S = n(22903),
        _ = n(62980);
      class M {
        connect(e) {
          let t = (0, S.Ut)();
          if (!t || (0, S.Bw)((0, S.X4)(t.token))) {
            (0, _.W0)(f.b8.AFFINE);
            return;
          }
          (0, k.kP)(t, 'loginResponse is null');
          let n = x.b({ token: t.token }),
            r = this.baseServerUrl + (0 === n.length ? '' : '?' + n);
          (this._client = new y.W(r)),
            (this._callback = e),
            this._setupChannel(),
            this._client.on('message', this._callback);
        }
        disconnect() {
          (0, k.kP)(this._client, 'client is null'),
            this._callback && this._client.off('message', this._callback),
            this._client.disconnect(),
            this._client.destroy(),
            (this._client = null);
        }
        _setupChannel() {
          (0, k.kP)(this._client, 'client is null');
          let e = this._client;
          e.on('connect', () => {
            this._logger.debug('Affine channel connected'),
              (this.shouldReconnect = !0),
              (this._retryTimes = 0);
          }),
            e.on('disconnect', t => {
              let { error: n } = t;
              if (n) {
                let t = (0, S.Ut)(),
                  n = !!t && (0, S.Bw)((0, S.X4)(t.token));
                if (this.shouldReconnect && n && !e.connected)
                  try {
                    setTimeout(() => {
                      this._retryTimes <= 50
                        ? ((0, k.kP)(this._callback, 'callback is null'),
                          this.connect(this._callback),
                          this._logger.info(
                            'try reconnect channel '.concat(
                              ++this._retryTimes,
                              ' times'
                            )
                          ))
                        : this._logger.error(
                            'reconnect failed, max reconnect times reached'
                          );
                    }, 500);
                  } catch (e) {
                    this._logger.error('reconnect failed', e);
                  }
              }
            });
        }
        constructor(e) {
          for (
            (0, w._)(this, 'baseServerUrl', void 0),
              (0, w._)(this, '_client', null),
              (0, w._)(this, 'shouldReconnect', !1),
              (0, w._)(this, '_retryTimes', 0),
              (0, w._)(this, '_logger', new h.b('affine:channel')),
              (0, w._)(this, '_callback', null);
            e.endsWith('/');

          )
            e = e.slice(0, e.length - 1);
          this.baseServerUrl = e;
        }
      }
      var z = n(14192);
      let H = new h.b('affine-sync'),
        E = Z.z.object({
          ws_list: Z.z.array(b.TN),
          ws_details: Z.z.record(b.ib),
          metadata: Z.z.record(
            Z.z.object({
              search_index: Z.z.array(Z.z.string()),
              name: Z.z.string(),
            })
          ),
        });
      var B = n(13246),
        F = n(23094),
        I = n(36054),
        T = n(752),
        P = n(97729),
        A = n.n(P),
        W = n(5632),
        L = n(2784),
        N = n(66844),
        O = n(74090),
        D = n(65058);
      let R = (0, D.cn)({ stack: [], current: 0, skip: !1 });
      var X = n(43631),
        U = n(31921),
        j = n(14762);
      let K = () => {
          let e = (0, i.X)();
          return {
            [e.Undo()]: '⌘+Z',
            [e.Redo()]: '⌘+⇧+Z',
            [e.Bold()]: '⌘+B',
            [e.Italic()]: '⌘+I',
            [e.Underline()]: '⌘+U',
            [e.Strikethrough()]: '⌘+⇧+S',
            [e['Inline code']()]: ' ⌘+E',
            [e['Code block']()]: '⌘+⌥+C',
            [e.Link()]: '⌘+K',
            [e['Quick search']()]: '⌘+K',
            [e['Body text']()]: '⌘+⌥+0',
            [e.Heading({ number: '1' })]: '⌘+⌥+1',
            [e.Heading({ number: '2' })]: '⌘+⌥+2',
            [e.Heading({ number: '3' })]: '⌘+⌥+3',
            [e.Heading({ number: '4' })]: '⌘+⌥+4',
            [e.Heading({ number: '5' })]: '⌘+⌥+5',
            [e.Heading({ number: '6' })]: '⌘+⌥+6',
            [e['Increase indent']()]: 'Tab',
            [e['Reduce indent']()]: '⇧+Tab',
          };
        },
        Y = () => {
          let e = (0, i.X)();
          return {
            [e.Bold()]: '**Text** ',
            [e.Italic()]: '*Text* ',
            [e.Underline()]: '~Text~ ',
            [e.Strikethrough()]: '~~Text~~ ',
            [e.Divider()]: '***',
            [e['Inline code']()]: '`Text` ',
            [e['Code block']()]: '``` Space',
            [e.Heading({ number: '1' })]: '# Text',
            [e.Heading({ number: '2' })]: '## Text',
            [e.Heading({ number: '3' })]: '### Text',
            [e.Heading({ number: '4' })]: '#### Text',
            [e.Heading({ number: '5' })]: '##### Text',
            [e.Heading({ number: '6' })]: '###### Text',
          };
        },
        V = () => {
          let e = (0, i.X)();
          return {
            [e.Undo()]: 'Ctrl+Z',
            [e.Redo()]: 'Ctrl+Y',
            [e.Bold()]: 'Ctrl+B',
            [e.Italic()]: 'Ctrl+I',
            [e.Underline()]: 'Ctrl+U',
            [e.Strikethrough()]: 'Ctrl+Shift+S',
            [e['Inline code']()]: ' Ctrl+E',
            [e['Code block']()]: 'Ctrl+Alt+C',
            [e.Link()]: 'Ctrl+K',
            [e['Quick search']()]: 'Ctrl+K',
            [e['Body text']()]: 'Ctrl+Shift+0',
            [e.Heading({ number: '1' })]: 'Ctrl+Shift+1',
            [e.Heading({ number: '2' })]: 'Ctrl+Shift+2',
            [e.Heading({ number: '3' })]: 'Ctrl+Shift+3',
            [e.Heading({ number: '4' })]: 'Ctrl+Shift+4',
            [e.Heading({ number: '5' })]: 'Ctrl+Shift+5',
            [e.Heading({ number: '6' })]: 'Ctrl+Shift+6',
            [e['Increase indent']()]: 'Tab',
            [e['Reduce indent']()]: 'Shift+Tab',
          };
        },
        G = () => {
          let e = (0, i.X)();
          return {
            [e.Bold()]: '**Text** ',
            [e.Italic()]: '*Text* ',
            [e.Underline()]: '~Text~ ',
            [e.Strikethrough()]: '~~Text~~ ',
            [e.Divider()]: '***',
            [e['Inline code']()]: '`Text` ',
            [e['Code block']()]: '``` Text',
            [e.Heading({ number: '1' })]: '# Text',
            [e.Heading({ number: '2' })]: '## Text',
            [e.Heading({ number: '3' })]: '### Text',
            [e.Heading({ number: '4' })]: '#### Text',
            [e.Heading({ number: '5' })]: '##### Text',
            [e.Heading({ number: '6' })]: '###### Text',
          };
        },
        $ = () =>
          (0, r.tZ)('svg', {
            width: '20',
            height: '15',
            viewBox: '0 0 20 15',
            fill: 'currentColor',
            xmlns: 'http://www.w3.org/2000/svg',
            children: (0, r.tZ)('path', {
              d: 'M17.745 0C18.3417 0 18.914 0.237053 19.336 0.65901C19.7579 1.08097 19.995 1.65326 19.995 2.25V11.755C19.995 12.3517 19.7579 12.924 19.336 13.346C18.914 13.7679 18.3417 14.005 17.745 14.005H2.25C1.95453 14.005 1.66194 13.9468 1.38896 13.8337C1.11598 13.7207 0.867941 13.5549 0.65901 13.346C0.450078 13.1371 0.284344 12.889 0.171271 12.616C0.058198 12.3431 0 12.0505 0 11.755V2.25C0 1.65326 0.237053 1.08097 0.65901 0.65901C1.08097 0.237053 1.65326 0 2.25 0H17.745ZM17.745 1.5H2.25C2.05109 1.5 1.86032 1.57902 1.71967 1.71967C1.57902 1.86032 1.5 2.05109 1.5 2.25V11.755C1.5 12.169 1.836 12.505 2.25 12.505H17.745C17.9439 12.505 18.1347 12.426 18.2753 12.2853C18.416 12.1447 18.495 11.9539 18.495 11.755V2.25C18.495 2.05109 18.416 1.86032 18.2753 1.71967C18.1347 1.57902 17.9439 1.5 17.745 1.5ZM4.75 9.5H15.25C15.44 9.50006 15.6229 9.57224 15.7618 9.70197C15.9006 9.8317 15.9851 10.0093 15.998 10.1989C16.011 10.3885 15.9515 10.5759 15.8316 10.7233C15.7117 10.8707 15.5402 10.9671 15.352 10.993L15.25 11H4.75C4.55998 10.9999 4.37706 10.9278 4.23821 10.798C4.09936 10.6683 4.01493 10.4907 4.00197 10.3011C3.98902 10.1115 4.04852 9.92411 4.16843 9.7767C4.28835 9.62929 4.45975 9.5329 4.648 9.507L4.75 9.5H15.25H4.75ZM14.5 6C14.7652 6 15.0196 6.10536 15.2071 6.29289C15.3946 6.48043 15.5 6.73478 15.5 7C15.5 7.26522 15.3946 7.51957 15.2071 7.70711C15.0196 7.89464 14.7652 8 14.5 8C14.2348 8 13.9804 7.89464 13.7929 7.70711C13.6054 7.51957 13.5 7.26522 13.5 7C13.5 6.73478 13.6054 6.48043 13.7929 6.29289C13.9804 6.10536 14.2348 6 14.5 6ZM8.505 6C8.77022 6 9.02457 6.10536 9.21211 6.29289C9.39964 6.48043 9.505 6.73478 9.505 7C9.505 7.26522 9.39964 7.51957 9.21211 7.70711C9.02457 7.89464 8.77022 8 8.505 8C8.23978 8 7.98543 7.89464 7.79789 7.70711C7.61036 7.51957 7.505 7.26522 7.505 7C7.505 6.73478 7.61036 6.48043 7.79789 6.29289C7.98543 6.10536 8.23978 6 8.505 6ZM5.505 6C5.77022 6 6.02457 6.10536 6.21211 6.29289C6.39964 6.48043 6.505 6.73478 6.505 7C6.505 7.26522 6.39964 7.51957 6.21211 7.70711C6.02457 7.89464 5.77022 8 5.505 8C5.23978 8 4.98543 7.89464 4.79789 7.70711C4.61036 7.51957 4.505 7.26522 4.505 7C4.505 6.73478 4.61036 6.48043 4.79789 6.29289C4.98543 6.10536 5.23978 6 5.505 6ZM11.505 6C11.7702 6 12.0246 6.10536 12.2121 6.29289C12.3996 6.48043 12.505 6.73478 12.505 7C12.505 7.26522 12.3996 7.51957 12.2121 7.70711C12.0246 7.89464 11.7702 8 11.505 8C11.2398 8 10.9854 7.89464 10.7979 7.70711C10.6104 7.51957 10.505 7.26522 10.505 7C10.505 6.73478 10.6104 6.48043 10.7979 6.29289C10.9854 6.10536 11.2398 6 11.505 6ZM4 3C4.26522 3 4.51957 3.10536 4.70711 3.29289C4.89464 3.48043 5 3.73478 5 4C5 4.26522 4.89464 4.51957 4.70711 4.70711C4.51957 4.89464 4.26522 5 4 5C3.73478 5 3.48043 4.89464 3.29289 4.70711C3.10536 4.51957 3 4.26522 3 4C3 3.73478 3.10536 3.48043 3.29289 3.29289C3.48043 3.10536 3.73478 3 4 3ZM6.995 3C7.26022 3 7.51457 3.10536 7.70211 3.29289C7.88964 3.48043 7.995 3.73478 7.995 4C7.995 4.26522 7.88964 4.51957 7.70211 4.70711C7.51457 4.89464 7.26022 5 6.995 5C6.72978 5 6.47543 4.89464 6.28789 4.70711C6.10036 4.51957 5.995 4.26522 5.995 4C5.995 3.73478 6.10036 3.48043 6.28789 3.29289C6.47543 3.10536 6.72978 3 6.995 3ZM9.995 3C10.2602 3 10.5146 3.10536 10.7021 3.29289C10.8896 3.48043 10.995 3.73478 10.995 4C10.995 4.26522 10.8896 4.51957 10.7021 4.70711C10.5146 4.89464 10.2602 5 9.995 5C9.72978 5 9.47543 4.89464 9.28789 4.70711C9.10036 4.51957 8.995 4.26522 8.995 4C8.995 3.73478 9.10036 3.48043 9.28789 3.29289C9.47543 3.10536 9.72978 3 9.995 3ZM12.995 3C13.2602 3 13.5146 3.10536 13.7021 3.29289C13.8896 3.48043 13.995 3.73478 13.995 4C13.995 4.26522 13.8896 4.51957 13.7021 4.70711C13.5146 4.89464 13.2602 5 12.995 5C12.7298 5 12.4754 4.89464 12.2879 4.70711C12.1004 4.51957 11.995 4.26522 11.995 4C11.995 3.73478 12.1004 3.48043 12.2879 3.29289C12.4754 3.10536 12.7298 3 12.995 3ZM15.995 3C16.2602 3 16.5146 3.10536 16.7021 3.29289C16.8896 3.48043 16.995 3.73478 16.995 4C16.995 4.26522 16.8896 4.51957 16.7021 4.70711C16.5146 4.89464 16.2602 5 15.995 5C15.7298 5 15.4754 4.89464 15.2879 4.70711C15.1004 4.51957 14.995 4.26522 14.995 4C14.995 3.73478 15.1004 3.48043 15.2879 3.29289C15.4754 3.10536 15.7298 3 15.995 3Z',
            }),
          }),
        q = (0, a.zo)('div')(() => ({
          width: '288px',
          height: '74vh',
          paddingBottom: '28px',
          backgroundColor: 'var(--affine-white)',
          boxShadow: 'var(--affine-popover-shadow)',
          borderRadius: 'var(--affine-popover-radius)',
          overflow: 'auto',
          boxRadius: '10px',
          position: 'fixed',
          right: '12px',
          top: '0',
          bottom: '0',
          margin: 'auto',
          zIndex: 'var(--affine-z-index-modal)',
        })),
        Q = (0, a.zo)('div')(() => ({
          color: 'var(--affine-text-primary-color)',
          fontWeight: '500',
          fontSize: 'var(--affine-font-sm)',
          height: '44px',
          ...(0, a.j2)('center', 'center'),
          svg: {
            width: '20px',
            marginRight: '14px',
            color: 'var(--affine-primary-color)',
          },
        })),
        J = (0, a.zo)('div')(() => ({
          fontWeight: '500',
          fontSize: 'var(--affine-font-sm)',
          height: '34px',
          lineHeight: '36px',
          marginTop: '28px',
          padding: '0 16px',
        })),
        ee = (0, a.zo)('div')(() => ({
          ...(0, a.j2)('space-between', 'center'),
          paddingTop: '8px 4px 0 4px',
          width: '100%',
          padding: '8px 16px 0 16px',
          position: 'sticky',
          left: '0',
          top: '0',
          background: 'var(--affine-white)',
          transition: 'background-color 0.5s',
        })),
        et = (0, a.zo)('div')(() => ({
          height: '34px',
          ...(0, a.j2)('space-between', 'center'),
          fontSize: 'var(--affine-font-sm)',
          padding: '0 16px',
        })),
        en = () => C.OB.isBrowser && C.OB.isMacOs,
        er = e => {
          let { open: t, onClose: n } = e,
            o = (0, i.X)(),
            l = Y(),
            c = G(),
            s = K(),
            d = V(),
            [u, h] = (0, L.useState)(!1);
          return (
            (0, L.useEffect)(() => {
              h(en());
            }, []),
            (0, r.tZ)(a.O$, {
              direction: 'left',
              in: t,
              mountOnEnter: !0,
              unmountOnExit: !0,
              children: (0, r.tZ)(q, {
                'data-testid': 'shortcuts-modal',
                children: (0, r.tZ)(a.$Q, {
                  onClickAway: () => {
                    n();
                  },
                  children: (0, r.BX)('div', {
                    children: [
                      (0, r.BX)(ee, {
                        children: [
                          (0, r.BX)(Q, {
                            children: [(0, r.tZ)($, {}), o.Shortcuts()],
                          }),
                          (0, r.tZ)(a.ol, {
                            top: 6,
                            right: 6,
                            size: [24, 24],
                            iconSize: [15, 15],
                            onClick: () => {
                              n();
                            },
                          }),
                        ],
                      }),
                      (0, r.tZ)(J, {
                        style: { marginTop: 0 },
                        children: o['Keyboard Shortcuts'](),
                      }),
                      Object.entries(u ? s : d).map(e => {
                        let [t, n] = e;
                        return (0, r.BX)(
                          et,
                          {
                            children: [
                              (0, r.tZ)('span', { children: t }),
                              (0, r.tZ)('span', { children: n }),
                            ],
                          },
                          t
                        );
                      }),
                      (0, r.tZ)(J, { children: o['Markdown Syntax']() }),
                      Object.entries(u ? l : c).map(e => {
                        let [t, n] = e;
                        return (0, r.BX)(
                          et,
                          {
                            children: [
                              (0, r.tZ)('span', { children: t }),
                              (0, r.tZ)('span', { children: n }),
                            ],
                          },
                          t
                        );
                      }),
                    ],
                  }),
                }),
              }),
            })
          );
        },
        ea = () =>
          (0, r.tZ)('svg', {
            width: '24',
            height: '24',
            viewBox: '0 0 24 24',
            fill: 'currentColor',
            xmlns: 'http://www.w3.org/2000/svg',
            children: (0, r.tZ)('path', {
              fillRule: 'evenodd',
              clipRule: 'evenodd',
              d: 'M12.0041 3.8002C7.47536 3.8002 3.8041 7.47146 3.8041 12.0002C3.8041 13.311 4.1111 14.5479 4.65639 15.6449C4.92133 16.1779 4.91348 16.8471 4.85228 17.3998C4.7869 17.9901 4.63749 18.6238 4.47572 19.1908C4.3722 19.5537 4.26086 19.8987 4.1573 20.2002H12.0041C16.5328 20.2002 20.2041 16.5289 20.2041 12.0002C20.2041 7.47146 16.5328 3.8002 12.0041 3.8002ZM2.26631 20.6926L2.2668 20.6914L2.26948 20.685L2.28104 20.6567C2.29139 20.6312 2.30687 20.5928 2.32657 20.5429C2.36599 20.4431 2.42218 20.2979 2.48795 20.1192C2.61992 19.7607 2.78833 19.2734 2.93712 18.7519C3.08715 18.226 3.21054 17.6884 3.262 17.2236C3.31765 16.7212 3.2707 16.4518 3.22364 16.3571C2.57081 15.0438 2.2041 13.5637 2.2041 12.0002C2.2041 6.58781 6.59171 2.2002 12.0041 2.2002C17.4165 2.2002 21.8041 6.5878 21.8041 12.0002C21.8041 17.4126 17.4165 21.8002 12.0041 21.8002H3.0049C2.73745 21.8002 2.4876 21.6665 2.33922 21.444C2.19087 21.2215 2.16356 20.9395 2.26631 20.6926ZM11.9672 9.0502C11.4091 9.0502 10.9382 9.43186 10.8049 9.9496C10.6948 10.3775 10.2587 10.6351 9.83079 10.5249C9.40291 10.4148 9.14532 9.97867 9.25545 9.55079C9.56623 8.3433 10.6614 7.4502 11.9672 7.4502C13.5136 7.4502 14.7672 8.7038 14.7672 10.2502C14.7672 11.1058 14.3536 11.6751 13.8978 12.115C13.7108 12.2955 13.4978 12.4721 13.2997 12.6362C13.2705 12.6604 13.2416 12.6844 13.2132 12.7081C12.982 12.9004 12.7556 13.0932 12.5329 13.3159C12.2205 13.6283 11.7139 13.6283 11.4015 13.3159C11.0891 13.0035 11.0891 12.4969 11.4015 12.1845C11.6788 11.9072 11.9525 11.6756 12.19 11.478C12.2213 11.4519 12.2517 11.4267 12.2812 11.4022C12.4849 11.2332 12.6465 11.0991 12.7866 10.9638C13.0808 10.6799 13.1672 10.4992 13.1672 10.2502C13.1672 9.58745 12.6299 9.0502 11.9672 9.0502ZM11.9772 16.5502H11.9672C11.5254 16.5502 11.1672 16.192 11.1672 15.7502C11.1672 15.3084 11.5254 14.9502 11.9672 14.9502H11.9772C12.419 14.9502 12.7772 15.3084 12.7772 15.7502C12.7772 16.192 12.419 16.5502 11.9772 16.5502Z',
            }),
          }),
        ei = () =>
          (0, r.tZ)('svg', {
            width: '24',
            height: '24',
            viewBox: '0 0 24 24',
            fill: 'currentColor',
            xmlns: 'http://www.w3.org/2000/svg',
            children: (0, r.tZ)('path', {
              fillRule: 'evenodd',
              clipRule: 'evenodd',
              d: 'M7.16957 3.25H14.8304C15.3646 3.24999 15.8104 3.24998 16.1747 3.27974C16.5546 3.31078 16.9112 3.37789 17.2485 3.54973C17.7659 3.81338 18.1866 4.23408 18.4503 4.75153C18.6221 5.08879 18.6892 5.44545 18.7203 5.82533C18.75 6.18956 18.75 6.6354 18.75 7.16955V8.36732C18.9209 8.40912 19.0869 8.46741 19.2485 8.54973C19.7659 8.81339 20.1866 9.23408 20.4503 9.75153C20.6221 10.0888 20.6892 10.4454 20.7203 10.8253C20.75 11.1896 20.75 11.6354 20.75 12.1695V20C20.75 20.2766 20.5978 20.5307 20.3539 20.6613C20.11 20.7918 19.8141 20.7775 19.584 20.624L17.3901 19.1615C17.069 18.9474 16.9819 18.8925 16.8945 18.8544C16.8046 18.8151 16.7104 18.7866 16.6138 18.7694C16.52 18.7527 16.4171 18.75 16.0311 18.75H11.1695C10.6354 18.75 10.1896 18.75 9.82533 18.7203C9.44545 18.6892 9.08879 18.6221 8.75153 18.4503C8.23408 18.1866 7.81339 17.7659 7.54973 17.2485C7.52446 17.1989 7.50144 17.1488 7.48046 17.0983L4.33541 18.6708C4.10292 18.7871 3.82681 18.7746 3.6057 18.638C3.38459 18.5013 3.25 18.2599 3.25 18L3.25 7.16957C3.24999 6.63541 3.24998 6.18956 3.27974 5.82533C3.31078 5.44545 3.37789 5.08879 3.54973 4.75153C3.81338 4.23408 4.23408 3.81338 4.75153 3.54973C5.08879 3.37789 5.44545 3.31078 5.82533 3.27974C6.18956 3.24998 6.63541 3.24999 7.16957 3.25ZM7.25322 15.5349C7.25 15.318 7.25 15.0803 7.25 14.8211L7.25 12.1696C7.24999 11.6354 7.24998 11.1896 7.27974 10.8253C7.31078 10.4454 7.37789 10.0888 7.54973 9.75153C7.81339 9.23408 8.23408 8.81339 8.75153 8.54973C9.08879 8.37789 9.44545 8.31078 9.82533 8.27974C10.1896 8.24998 10.6354 8.24999 11.1696 8.25H16.8304C16.9769 8.25 17.1167 8.24999 17.25 8.25061V7.2C17.25 6.62757 17.2494 6.24336 17.2252 5.94748C17.2018 5.66036 17.1599 5.52307 17.1138 5.43251C16.9939 5.19731 16.8027 5.00608 16.5675 4.88624C16.4769 4.8401 16.3396 4.79822 16.0525 4.77476C15.7566 4.75058 15.3724 4.75 14.8 4.75H7.2C6.62757 4.75 6.24336 4.75058 5.94748 4.77476C5.66036 4.79822 5.52307 4.8401 5.43251 4.88624C5.19731 5.00608 5.00608 5.19731 4.88624 5.43251C4.8401 5.52307 4.79822 5.66036 4.77476 5.94748C4.75058 6.24336 4.75 6.62757 4.75 7.2V16.7865L7.25322 15.5349ZM9.94748 9.77476C9.66036 9.79822 9.52307 9.8401 9.43251 9.88624C9.19731 10.0061 9.00608 10.1973 8.88624 10.4325C8.8401 10.5231 8.79822 10.6604 8.77476 10.9475C8.75058 11.2434 8.75 11.6276 8.75 12.2V14.8C8.75 15.3018 8.7503 15.6608 8.7673 15.9461C8.78877 16.3064 8.83405 16.465 8.88624 16.5675C9.00608 16.8027 9.19731 16.9939 9.43251 17.1138C9.52307 17.1599 9.66036 17.2018 9.94748 17.2252C10.2434 17.2494 10.6276 17.25 11.2 17.25H16.0311C16.049 17.25 16.0666 17.25 16.084 17.25C16.3929 17.2499 16.6362 17.2497 16.877 17.2927C17.0895 17.3306 17.2968 17.3933 17.4947 17.4797C17.7189 17.5775 17.9213 17.7126 18.1782 17.884C18.1927 17.8937 18.2073 17.9035 18.2222 17.9134L19.25 18.5986V12.2C19.25 11.6276 19.2494 11.2434 19.2252 10.9475C19.2018 10.6604 19.1599 10.5231 19.1138 10.4325C18.9939 10.1973 18.8027 10.0061 18.5675 9.88624C18.4769 9.8401 18.3396 9.79822 18.0525 9.77476C17.7566 9.75058 17.3724 9.75 16.8 9.75H11.2C10.6276 9.75 10.2434 9.75058 9.94748 9.77476Z',
            }),
          }),
        eo = () =>
          (0, r.tZ)('svg', {
            width: '24',
            height: '25',
            viewBox: '0 0 24 25',
            fill: 'currentColor',
            xmlns: 'http://www.w3.org/2000/svg',
            children: (0, r.tZ)('path', {
              d: 'M19.745 5C20.3417 5 20.914 5.23705 21.336 5.65901C21.7579 6.08097 21.995 6.65326 21.995 7.25V16.755C21.995 17.3517 21.7579 17.924 21.336 18.346C20.914 18.7679 20.3417 19.005 19.745 19.005H4.25C3.95453 19.005 3.66194 18.9468 3.38896 18.8337C3.11598 18.7207 2.86794 18.5549 2.65901 18.346C2.45008 18.1371 2.28434 17.889 2.17127 17.616C2.0582 17.3431 2 17.0505 2 16.755V7.25C2 6.65326 2.23705 6.08097 2.65901 5.65901C3.08097 5.23705 3.65326 5 4.25 5H19.745ZM19.745 6.5H4.25C4.05109 6.5 3.86032 6.57902 3.71967 6.71967C3.57902 6.86032 3.5 7.05109 3.5 7.25V16.755C3.5 17.169 3.836 17.505 4.25 17.505H19.745C19.9439 17.505 20.1347 17.426 20.2753 17.2853C20.416 17.1447 20.495 16.9539 20.495 16.755V7.25C20.495 7.05109 20.416 6.86032 20.2753 6.71967C20.1347 6.57902 19.9439 6.5 19.745 6.5ZM6.75 14.5H17.25C17.44 14.5001 17.6229 14.5722 17.7618 14.702C17.9006 14.8317 17.9851 15.0093 17.998 15.1989C18.011 15.3885 17.9515 15.5759 17.8316 15.7233C17.7117 15.8707 17.5402 15.9671 17.352 15.993L17.25 16H6.75C6.55998 15.9999 6.37706 15.9278 6.23821 15.798C6.09936 15.6683 6.01493 15.4907 6.00197 15.3011C5.98902 15.1115 6.04852 14.9241 6.16843 14.7767C6.28835 14.6293 6.45975 14.5329 6.648 14.507L6.75 14.5H17.25H6.75ZM16.5 11C16.7652 11 17.0196 11.1054 17.2071 11.2929C17.3946 11.4804 17.5 11.7348 17.5 12C17.5 12.2652 17.3946 12.5196 17.2071 12.7071C17.0196 12.8946 16.7652 13 16.5 13C16.2348 13 15.9804 12.8946 15.7929 12.7071C15.6054 12.5196 15.5 12.2652 15.5 12C15.5 11.7348 15.6054 11.4804 15.7929 11.2929C15.9804 11.1054 16.2348 11 16.5 11ZM10.505 11C10.7702 11 11.0246 11.1054 11.2121 11.2929C11.3996 11.4804 11.505 11.7348 11.505 12C11.505 12.2652 11.3996 12.5196 11.2121 12.7071C11.0246 12.8946 10.7702 13 10.505 13C10.2398 13 9.98543 12.8946 9.79789 12.7071C9.61036 12.5196 9.505 12.2652 9.505 12C9.505 11.7348 9.61036 11.4804 9.79789 11.2929C9.98543 11.1054 10.2398 11 10.505 11ZM7.505 11C7.77022 11 8.02457 11.1054 8.21211 11.2929C8.39964 11.4804 8.505 11.7348 8.505 12C8.505 12.2652 8.39964 12.5196 8.21211 12.7071C8.02457 12.8946 7.77022 13 7.505 13C7.23978 13 6.98543 12.8946 6.79789 12.7071C6.61036 12.5196 6.505 12.2652 6.505 12C6.505 11.7348 6.61036 11.4804 6.79789 11.2929C6.98543 11.1054 7.23978 11 7.505 11ZM13.505 11C13.7702 11 14.0246 11.1054 14.2121 11.2929C14.3996 11.4804 14.505 11.7348 14.505 12C14.505 12.2652 14.3996 12.5196 14.2121 12.7071C14.0246 12.8946 13.7702 13 13.505 13C13.2398 13 12.9854 12.8946 12.7979 12.7071C12.6104 12.5196 12.505 12.2652 12.505 12C12.505 11.7348 12.6104 11.4804 12.7979 11.2929C12.9854 11.1054 13.2398 11 13.505 11ZM6 8C6.26522 8 6.51957 8.10536 6.70711 8.29289C6.89464 8.48043 7 8.73478 7 9C7 9.26522 6.89464 9.51957 6.70711 9.70711C6.51957 9.89464 6.26522 10 6 10C5.73478 10 5.48043 9.89464 5.29289 9.70711C5.10536 9.51957 5 9.26522 5 9C5 8.73478 5.10536 8.48043 5.29289 8.29289C5.48043 8.10536 5.73478 8 6 8ZM8.995 8C9.26022 8 9.51457 8.10536 9.70211 8.29289C9.88964 8.48043 9.995 8.73478 9.995 9C9.995 9.26522 9.88964 9.51957 9.70211 9.70711C9.51457 9.89464 9.26022 10 8.995 10C8.72978 10 8.47543 9.89464 8.28789 9.70711C8.10036 9.51957 7.995 9.26522 7.995 9C7.995 8.73478 8.10036 8.48043 8.28789 8.29289C8.47543 8.10536 8.72978 8 8.995 8ZM11.995 8C12.2602 8 12.5146 8.10536 12.7021 8.29289C12.8896 8.48043 12.995 8.73478 12.995 9C12.995 9.26522 12.8896 9.51957 12.7021 9.70711C12.5146 9.89464 12.2602 10 11.995 10C11.7298 10 11.4754 9.89464 11.2879 9.70711C11.1004 9.51957 10.995 9.26522 10.995 9C10.995 8.73478 11.1004 8.48043 11.2879 8.29289C11.4754 8.10536 11.7298 8 11.995 8ZM14.995 8C15.2602 8 15.5146 8.10536 15.7021 8.29289C15.8896 8.48043 15.995 8.73478 15.995 9C15.995 9.26522 15.8896 9.51957 15.7021 9.70711C15.5146 9.89464 15.2602 10 14.995 10C14.7298 10 14.4754 9.89464 14.2879 9.70711C14.1004 9.51957 13.995 9.26522 13.995 9C13.995 8.73478 14.1004 8.48043 14.2879 8.29289C14.4754 8.10536 14.7298 8 14.995 8ZM17.995 8C18.2602 8 18.5146 8.10536 18.7021 8.29289C18.8896 8.48043 18.995 8.73478 18.995 9C18.995 9.26522 18.8896 9.51957 18.7021 9.70711C18.5146 9.89464 18.2602 10 17.995 10C17.7298 10 17.4754 9.89464 17.2879 9.70711C17.1004 9.51957 16.995 9.26522 16.995 9C16.995 8.73478 17.1004 8.48043 17.2879 8.29289C17.4754 8.10536 17.7298 8 17.995 8Z',
            }),
          }),
        el = (0, a.zo)('div')(e => {
          let { spread: t, inEdgelessPage: n } = e;
          return {
            transition: 'box-shadow 0.2s',
            width: '44px',
            position: 'relative',
            boxShadow: t
              ? 'var(--affine-menu-shadow)'
              : n
              ? 'var(--affine-menu-shadow)'
              : 'unset',
            padding: '0 4px 44px',
            borderRadius: '10px',
            background: t
              ? 'var(--affine-background-overlay-panel-color)'
              : 'var(--affine-background-primary-color)',
            ':hover': {
              background: t ? null : 'var(--affine-white)',
              boxShadow: t ? null : 'var(--affine-menu-shadow)',
            },
            '::after': {
              content: '""',
              width: '36px',
              height: '1px',
              background: t ? 'var(--affine-border-color)' : 'transparent',
              ...(0, a.vK)({ left: 0, right: 0, bottom: '44px' }),
              margin: 'auto',
              transition: 'background 0.15s',
            },
          };
        }),
        ec = (0, a.zo)('div')(() => ({
          color: 'var(--affine-icon-color)',
          ...(0, a.j2)('center', 'center'),
          cursor: 'pointer',
          fontSize: '24px',
          borderRadius: '5px',
          width: '36px',
          height: '36px',
          margin: '4px auto 4px',
          transition: 'background-color 0.2s',
          position: 'relative',
          ':hover': {
            color: 'var(--affine-primary-color)',
            backgroundColor: 'var(--affine-hover-color)',
          },
        })),
        es = (0, a.zo)('div')(() => ({
          transition: 'height 0.2s cubic-bezier(0, 0, 0.55, 1.6)',
          overflow: 'hidden',
        })),
        ed = (0, a.zo)('div')(e => {
          let { spread: t } = e;
          return {
            width: '36px',
            height: '36px',
            cursor: 'pointer',
            color: 'var(--affine-icon-color)',
            borderRadius: '5px',
            fontSize: '24px',
            ...(0, a.j2)('center', 'center'),
            ...(0, a.vK)({ left: '4px', bottom: '4px' }),
            ':hover': {
              color: 'var(--affine-primary-color)',
              backgroundColor: t ? 'var(--affine-hover-color)' : null,
            },
          };
        }),
        eu = (0, L.lazy)(() =>
          n
            .e(6057)
            .then(n.bind(n, 16057))
            .then(e => {
              let { ContactModal: t } = e;
              return { default: t };
            })
        ),
        eh = ['whatNew', 'contact', 'shortcuts'],
        eC = [...eh, 'guide'],
        ep = e => {
          let { showList: t = C.OB.isDesktop ? eC : eh } = e,
            n = (0, j.D)(),
            [, o] = (0, T.KO)(O.Yt),
            [l, c] = (0, L.useState)(!1),
            s = (0, i.X)(),
            [d, u] = (0, L.useState)(!1),
            [h, p] = (0, L.useState)(!1);
          return (0, r.BX)(r.HY, {
            children: [
              (0, r.BX)(el, {
                spread: l,
                'data-testid': 'help-island',
                onClick: () => {
                  c(!l);
                },
                inEdgelessPage: 'edgeless' === n,
                children: [
                  (0, r.BX)(es, {
                    style: { height: l ? ''.concat(44 * t.length, 'px') : 0 },
                    children: [
                      t.includes('whatNew') &&
                        (0, r.tZ)(a.u, {
                          content: s["Discover what's new!"](),
                          placement: 'left-end',
                          children: (0, r.tZ)(ec, {
                            'data-testid': 'right-bottom-change-log-icon',
                            onClick: () => {
                              window.open(C.vc.changelogUrl, '_blank');
                            },
                            children: (0, r.tZ)(U.NewIcon, {}),
                          }),
                        }),
                      t.includes('contact') &&
                        (0, r.tZ)(a.u, {
                          content: s['Contact Us'](),
                          placement: 'left-end',
                          children: (0, r.tZ)(ec, {
                            'data-testid': 'right-bottom-contact-us-icon',
                            onClick: () => {
                              c(!1), u(!0);
                            },
                            children: (0, r.tZ)(ei, {}),
                          }),
                        }),
                      t.includes('shortcuts') &&
                        (0, r.tZ)(a.u, {
                          content: s['Keyboard Shortcuts'](),
                          placement: 'left-end',
                          children: (0, r.tZ)(ec, {
                            'data-testid': 'shortcuts-icon',
                            onClick: () => {
                              c(!1), p(!0);
                            },
                            children: (0, r.tZ)(eo, {}),
                          }),
                        }),
                      t.includes('guide') &&
                        (0, r.tZ)(a.u, {
                          content: s['com.affine.helpIsland.gettingStarted'](),
                          placement: 'left-end',
                          children: (0, r.tZ)(ec, {
                            'data-testid': 'easy-guide',
                            onClick: () => {
                              c(!1), o(!0);
                            },
                            children: (0, r.tZ)(U.UserGuideIcon, {}),
                          }),
                        }),
                    ],
                  }),
                  (0, r.tZ)(a.u, {
                    content: s['Help and Feedback'](),
                    placement: 'left-end',
                    children: (0, r.tZ)(a.Co, {
                      in: !l,
                      'data-testid': 'faq-icon',
                      children: (0, r.tZ)(ed, { children: (0, r.tZ)(ea, {}) }),
                    }),
                  }),
                  (0, r.tZ)(a.Co, {
                    in: l,
                    children: (0, r.tZ)(ed, {
                      spread: !0,
                      children: (0, r.tZ)(U.CloseIcon, {}),
                    }),
                  }),
                ],
              }),
              (0, r.tZ)(L.Suspense, {
                children: (0, r.tZ)(eu, {
                  open: d,
                  onClose: () => u(!1),
                  logoSrc: '/imgs/affine-text-logo.png',
                }),
              }),
              (0, r.tZ)(er, { open: h, onClose: () => p(!1) }),
            ],
          });
        };
      var ef = n(69557),
        ev = n(91013),
        eg = n(87809),
        eb = n(85245);
      function ek(e) {
        return e
          .getBlockByFlavour('affine:paragraph')
          .flatMap(e => {
            var t;
            return null === (t = e.text) || void 0 === t ? void 0 : t.toDelta();
          })
          .map(e => {
            var t, n;
            return null == e
              ? void 0
              : null === (t = e.attributes) || void 0 === t
              ? void 0
              : null === (n = t.reference) || void 0 === n
              ? void 0
              : n.pageId;
          })
          .filter(Boolean);
      }
      let em = (0, eg.xu)(e => {
          if (null === e) return (0, D.cn)([]);
          let t = (0, D.cn)(ek(e));
          return (
            (t.onMount = t => {
              let n = e.slots.yUpdated.on(() => {
                t(ek(e));
              });
              return () => {
                n.dispose();
              };
            }),
            t
          );
        }),
        eZ = () => {
          let e = (0, i.X)();
          return (0, r.tZ)(s.sN, {
            disabled: !0,
            children: e['Favorite pages for easy access'](),
          });
        };
      function ew(e) {
        var t, n;
        let { workspace: a, pageId: i, metaMapping: o, parentIds: l } = e,
          c = (0, W.useRouter)(),
          d = (0, T.Dv)((0, O.G9)(i)),
          u = c.query.pageId === i,
          h =
            (null == d ? void 0 : d.mode) === 'edgeless'
              ? (0, r.tZ)(U.EdgelessIcon, {})
              : (0, r.tZ)(U.PageIcon, {}),
          C = (function (e, t) {
            let n = (0, eb.j)(e, t);
            return (0, T.Dv)(em(n));
          })(a, i),
          p = (0, L.useMemo)(
            () => [
              ...new Set(
                C.filter(e => {
                  var t;
                  return (
                    !l.has(e) &&
                    !(null === (t = o[e]) || void 0 === t ? void 0 : t.trash)
                  );
                })
              ),
            ],
            [C, l, o]
          ),
          [f, v] = (0, L.useState)(!0),
          g = p.length > 0,
          b = l.size > 0,
          k = !(null === (t = o[i]) || void 0 === t ? void 0 : t.title);
        return (0, r.BX)(ef.fC, {
          className: 'snzxcx1',
          'data-nested': b,
          open: !f,
          children: [
            (0, r.tZ)(s.OA, {
              'data-type': 'favorite-list-item',
              'data-testid': 'favorite-list-item-'.concat(i),
              active: u,
              href: '/workspace/'.concat(a.id, '/').concat(i),
              icon: h,
              collapsed: g ? f : void 0,
              onCollapsedChange: v,
              children: (0, r.tZ)('span', {
                className: 'snzxcx0',
                'data-untitled': k,
                children:
                  (null === (n = o[i]) || void 0 === n ? void 0 : n.title) ||
                  'Untitled',
              }),
            }),
            g &&
              (0, r.tZ)(ef.VY, {
                className: 'snzxcx4',
                children: (0, r.tZ)('div', {
                  className: 'snzxcx5',
                  children: p.map(e =>
                    (0, r.tZ)(
                      ew,
                      {
                        workspace: a,
                        pageId: e,
                        metaMapping: o,
                        parentIds: new Set([...l, i]),
                      },
                      e
                    )
                  ),
                }),
              }),
          ],
        });
      }
      n(53745);
      let ex = e => {
        let { currentWorkspace: t } = e,
          n = (0, ev.r)(t.blockSuiteWorkspace),
          a = (0, L.useMemo)(() => n.filter(e => e.favorite && !e.trash), [n]),
          i = (0, L.useMemo)(
            () => n.reduce((e, t) => ((e[t.id] = t), e), {}),
            [n]
          );
        return (0, r.BX)(r.HY, {
          children: [
            a.map((e, n) =>
              (0, r.tZ)(
                ew,
                {
                  metaMapping: i,
                  pageId: e.id,
                  parentIds: new Set(),
                  workspace: t.blockSuiteWorkspace,
                },
                ''.concat(e, '-').concat(n)
              )
            ),
            0 === a.length && (0, r.tZ)(eZ, {}),
          ],
        });
      };
      var ey = n(5329),
        eS = n(78365),
        e_ = n(96450);
      n(32420);
      let eM = (0, a.zo)('div')(() => ({
          height: '58px',
          display: 'flex',
          alignItems: 'center',
          padding: '0 6px',
          margin: '0 -6px',
          borderRadius: '8px',
          color: 'var(--affine-text-primary-color)',
          ':hover': {
            cursor: 'pointer',
            background: 'var(--affine-hover-color)',
          },
        })),
        ez = (0, a.zo)('div')(() => ({
          marginLeft: '8px',
          flexGrow: 1,
          overflow: 'hidden',
        })),
        eH = (0, a.zo)('div')(() => ({
          lineHeight: '24px',
          fontWeight: 600,
          userSelect: 'none',
          ...(0, a.vS)(1),
        })),
        eE = (0, a.zo)('div')(() => ({
          height: '22px',
          ...(0, a.j2)('flex-start', 'center'),
          fontSize: 'var(--affine-font-sm)',
          color: 'var(--affine-text-secondary-color)',
          userSelect: 'none',
          svg: {
            color: 'var(--affine-icon-color)',
            fontSize: 'var(--affine-font-base)',
            marginRight: '4px',
          },
        })),
        eB = e => {
          var t;
          let { currentWorkspace: n, onClick: a } = e,
            [i] = (0, eS.H)(
              null !== (t = null == n ? void 0 : n.blockSuiteWorkspace) &&
                void 0 !== t
                ? t
                : null
            ),
            [o] = (0, e_.$)(),
            l = (0, L.useCallback)(
              e => {
                ('Enter' === e.key || ' ' === e.key) &&
                  (e.preventDefault(), a());
              },
              [a]
            );
          return (0, r.BX)(eM, {
            role: 'button',
            tabIndex: 0,
            onClick: a,
            onKeyDown: l,
            'data-testid': 'current-workspace',
            children: [
              (0, r.tZ)(ey.z, {
                'data-testid': 'workspace-avatar',
                className: '_5pizzg0',
                size: 40,
                workspace: n,
              }),
              (0, r.BX)(ez, {
                children: [
                  (0, r.tZ)(eH, {
                    'data-testid': 'workspace-name',
                    children: i,
                  }),
                  o &&
                    (0, r.BX)(eE, {
                      children: [
                        'local' === o.flavour
                          ? (0, r.tZ)(U.LocalWorkspaceIcon, {})
                          : (0, r.tZ)(U.CloudWorkspaceIcon, {}),
                        'local' === o.flavour ? 'Local' : 'AFFiNE Cloud',
                      ],
                    }),
                ],
              }),
            ],
          });
        },
        eF = L.forwardRef((e, t) => {
          let {
            currentPath: n,
            path: a,
            icon: i,
            children: o,
            isDraggedOver: l,
            ...c
          } = e;
          return (0, r.tZ)(s.OA, {
            ref: t,
            ...c,
            active: l || n === a,
            href: null != a ? a : '',
            icon: i,
            children: o,
          });
        });
      eF.displayName = 'RouteMenuLinkItem';
      let eI = 'trash-folder',
        eT = e => {
          let {
              currentWorkspace: t,
              openPage: n,
              createPage: a,
              currentPath: o,
              paths: l,
              onOpenQuickSearchModal: c,
              onOpenWorkspaceListModal: d,
            } = e,
            u = (null == t ? void 0 : t.id) || null,
            h = null == t ? void 0 : t.blockSuiteWorkspace,
            p = (0, i.X)(),
            v = (0, L.useCallback)(async () => {
              let e = a();
              n(e.id);
            }, [a, n]);
          (0, L.useEffect)(() => {
            if (environment.isDesktop) {
              var e;
              return null === (e = window.events) || void 0 === e
                ? void 0
                : e.applicationMenu.onNewPageAction(v);
            }
          }, [v]);
          let [g, b] = (0, T.KO)(s.Hw);
          (0, L.useEffect)(() => {
            if (environment.isDesktop && 'boolean' == typeof g) {
              var e;
              null === (e = window.apis) ||
                void 0 === e ||
                e.ui.handleSidebarVisibilityChange(g).catch(e => {
                  console.error(e);
                });
            }
          }, [g]),
            (0, L.useEffect)(() => {
              let e = e => {
                (('/' === e.key && e.metaKey) ||
                  ('/' === e.key && e.ctrlKey)) &&
                  b(!g);
              };
              return (
                document.addEventListener('keydown', e, { capture: !0 }),
                () =>
                  document.removeEventListener('keydown', e, { capture: !0 })
              );
            }, [g, b]);
          let [k, m] = (function () {
              let e = (0, W.useRouter)(),
                [t, n] = (0, T.KO)(R);
              return [
                t,
                (0, L.useCallback)(
                  t => {
                    n(n => {
                      if (t) {
                        let t = Math.min(n.stack.length - 1, n.current + 1),
                          r = n.stack[t];
                        return (
                          e.push(r).catch(e => {
                            console.error(e);
                          }),
                          { ...n, current: t, skip: !0 }
                        );
                      }
                      {
                        let t = Math.max(0, n.current - 1),
                          r = n.stack[t];
                        return (
                          e.push(r).catch(e => {
                            console.error(e);
                          }),
                          { ...n, current: t, skip: !0 }
                        );
                      }
                    });
                  },
                  [e, n]
                ),
              ];
            })(),
            Z = (0, L.useMemo)(
              () => ({
                forward: () => {
                  m(!0);
                },
                back: () => {
                  m(!1);
                },
                history: k,
              }),
              [k, m]
            ),
            w = (0, F.Zj)({ id: eI });
          return (0, r.tZ)(r.HY, {
            children: (0, r.BX)(s.S8, {
              router: Z,
              children: [
                (0, r.BX)(s._G, {
                  children: [
                    (0, r.tZ)(eB, { currentWorkspace: t, onClick: d }),
                    (0, r.tZ)(s.zU, {
                      'data-testid': 'slider-bar-quick-search-button',
                      onClick: c,
                    }),
                    (0, r.tZ)(eF, {
                      icon: (0, r.tZ)(U.FolderIcon, {}),
                      currentPath: o,
                      path: u && l.all(u),
                      children: (0, r.tZ)('span', {
                        'data-testid': 'all-pages',
                        children: p['All pages'](),
                      }),
                    }),
                    (0, r.tZ)(eF, {
                      'data-testid': 'slider-bar-workspace-setting-button',
                      icon: (0, r.tZ)(U.SettingsIcon, {}),
                      currentPath: o,
                      path: u && l.setting(u),
                      children: (0, r.tZ)('span', {
                        'data-testid': 'settings',
                        children: p.Settings(),
                      }),
                    }),
                  ],
                }),
                (0, r.BX)(s.Ee, {
                  children: [
                    (0, r.tZ)(s.es, { label: p.Favorites() }),
                    h && (0, r.tZ)(ex, { currentWorkspace: t }),
                    C.vc.enableLegacyCloud &&
                      ((null == t ? void 0 : t.flavour) === f.b8.AFFINE &&
                      t.public
                        ? (0, r.tZ)(eF, {
                            icon: (0, r.tZ)(U.ShareIcon, {}),
                            currentPath: o,
                            path: u && l.setting(u),
                            children: (0, r.tZ)('span', {
                              'data-testid': 'Published-to-web',
                              children: 'Published to web',
                            }),
                          })
                        : (0, r.tZ)(eF, {
                            icon: (0, r.tZ)(U.ShareIcon, {}),
                            currentPath: o,
                            path: u && l.shared(u),
                            children: (0, r.tZ)('span', {
                              'data-testid': 'shared-pages',
                              children: p['Shared Pages'](),
                            }),
                          })),
                    (0, r.tZ)(s.es, { label: p.others() }),
                    (0, r.tZ)(eF, {
                      ref: w.setNodeRef,
                      isDraggedOver: w.isOver,
                      icon: (0, r.tZ)(U.DeleteTemporarilyIcon, {}),
                      currentPath: o,
                      path: u && l.trash(u),
                      children: (0, r.tZ)('span', {
                        'data-testid': 'trash-page',
                        children: p.Trash(),
                      }),
                    }),
                  ],
                }),
                (0, r.BX)(s._G, {
                  children: [
                    environment.isDesktop && (0, r.tZ)(s.lc, {}),
                    (0, r.tZ)('div', {}),
                    (0, r.tZ)(s.xH, { onClick: v }),
                  ],
                }),
              ],
            }),
          });
        };
      var eP = n(64813),
        eA = n(31747),
        eW = n(53430),
        eL = n(87175),
        eN = n(99341),
        eO = n(84610),
        eD = n(53137);
      let eR = (0, L.lazy)(() =>
          Promise.all([n.e(8421), n.e(6546), n.e(2513)])
            .then(n.bind(n, 32513))
            .then(e => ({ default: e.QuickSearchModal }))
        ),
        eX = () => {
          let e = (0, T.Dv)(X.sd),
            t = (0, W.useRouter)(),
            [n, a] = (0, T.KO)(O.A8);
          return (0, r.tZ)(L.Suspense, {
            children: (0, r.tZ)(eR, {
              blockSuiteWorkspace: e.blockSuiteWorkspace,
              open: n,
              setOpen: a,
              router: t,
            }),
          });
        };
      function eU(e) {
        let { children: t } = e;
        return (0, r.tZ)(r.HY, { children: t });
      }
      let ej = () => {
          let [e] = (0, e_.$)(),
            t = (0, W.useRouter)(),
            [n, a] = (0, T.KO)(O.A8),
            i = null == e ? void 0 : e.blockSuiteWorkspace,
            o = 'public-workspace' === t.pathname.split('/')[1],
            l = (0, T.Dv)(X.Uv);
          return i
            ? (0, r.tZ)(eR, {
                blockSuiteWorkspace: null == e ? void 0 : e.blockSuiteWorkspace,
                open: n,
                setOpen: a,
                router: t,
              })
            : o && l
            ? (0, r.tZ)(eX, {})
            : null;
        },
        eK = new h.b('workspace-layout'),
        eY = (function (e) {
          let t, n;
          async function r(t) {
            H.debug('channelMessage', t);
            let n = E.safeParse(t);
            n.success ||
              console.error(
                'channelMessageSchema.safeParse(channelMessage) failed',
                n
              );
            let { ws_details: r } = t,
              a = await e.list();
            for (let [e] of Object.entries(r)) {
              let t = a.findIndex(t => t.id === e);
              -1 === t &&
                m.Ux.set(z.nn, t => {
                  let n = t.findIndex(t => t.id === e);
                  return t.splice(n, 1), [...t];
                });
            }
          }
          let a = {
            connect: () => {
              (t = new M(g.A + '/api/global/sync/')).connect(r),
                (n = S.vJ.on(() => {
                  a.disconnect(), a.connect();
                }));
            },
            disconnect: () => {
              (0, k.kP)(t, 'client is null'),
                t.disconnect(),
                null == n || n.dispose(),
                (t = null);
            },
          };
          return a;
        })(N.WorkspaceAdapters[f.b8.AFFINE].CRUD),
        eV = e => {
          let { children: t } = e,
            n = (0, T.Dv)(z.At),
            a = (0, eL._)();
          return (
            (0, L.useEffect)(() => {
              let e = a
                .filter(e => e.id !== n)
                .flatMap(e =>
                  e.providers.filter(e => 'background' in e && e.background)
                );
              return (
                e.forEach(e => {
                  e.connect();
                }),
                () => {
                  e.forEach(e => {
                    e.disconnect();
                  });
                }
              );
            }, [n, a]),
            (0, r.tZ)(r.HY, { children: t })
          );
        };
      void 0 === globalThis.HALTING_PROBLEM_TIMEOUT &&
        (globalThis.HALTING_PROBLEM_TIMEOUT = 1e3);
      let eG = e => {
          let { children: t } = e,
            n = (0, T.Dv)(z.At),
            a = (0, T.Dv)(z.nn),
            i = a.find(e => e.id === n),
            o = (0, W.useRouter)(),
            l = o.push;
          return ((0, L.useEffect)(() => {
            let e = setTimeout(() => {
              i ||
                (l('/').catch(e => {
                  console.error(e);
                }),
                (globalThis.HALTING_PROBLEM_TIMEOUT <<= 1));
            }, globalThis.HALTING_PROBLEM_TIMEOUT);
            return () => {
              clearTimeout(e);
            };
          }, [l, i, a.length]),
          0 === a.length)
            ? (0, r.tZ)(u.aD, {}, 'no-workspace')
            : o.isReady
            ? n
              ? i
                ? (0, r.tZ)(r.HY, { children: t })
                : (0, r.tZ)(u.aD, {}, 'workspace-not-found')
              : (0, r.tZ)(u.aD, {}, 'finding-workspace-id')
            : (0, r.tZ)(u.aD, {}, 'router-is-loading');
        },
        e$ = function (e) {
          var t;
          let { children: n } = e,
            a = (0, v.M1)();
          (0, L.useEffect)(() => {
            var e;
            (document.documentElement.lang = a.language),
              null === (e = (0, v.r$)(a)) ||
                void 0 === e ||
                e.catch(e => {
                  console.error(e);
                });
          }, [a]),
            (function () {
              let e = (0, T.b9)(R),
                t = (0, W.useRouter)();
              (0, L.useEffect)(() => {
                let n = t => {
                  e(e => {
                    if (
                      (console.log(
                        'push',
                        t,
                        e.skip,
                        e.stack.length,
                        e.current
                      ),
                      e.skip)
                    )
                      return {
                        stack: [...e.stack],
                        current: e.current,
                        skip: !1,
                      };
                    if (e.current < e.stack.length - 1) {
                      let n = e.stack.slice(0, e.current);
                      return (
                        n.push(t),
                        n.length > 50 && n.shift(),
                        { stack: n, current: n.length - 1, skip: !1 }
                      );
                    }
                    {
                      let n = [...e.stack, t];
                      return (
                        n.length > 50 && n.shift(),
                        { stack: n, current: n.length - 1, skip: !1 }
                      );
                    }
                  });
                };
                return (
                  t.events.on('routeChangeComplete', n),
                  () => {
                    t.events.off('routeChangeComplete', n);
                  }
                );
              }, [t.events, e]);
            })();
          let i = (0, T.Dv)(z.At),
            o = (0, T.Dv)(z.nn),
            l = (0, L.useMemo)(() => o.find(e => e.id === i), [i, o]),
            c = (0, T.b9)(z.nn);
          (0, L.useEffect)(() => {
            eK.info('mount');
            let e = new AbortController(),
              t = Object.values(N.WorkspaceAdapters)
                .sort((e, t) => e.loadPriority - t.loadPriority)
                .map(e => {
                  let { CRUD: t } = e;
                  return t.list;
                });
            return (
              (async function () {
                let n = m.Ux.get(z.nn),
                  r = [];
                for (let e of t)
                  try {
                    let t = await e();
                    n.length &&
                      t.sort(
                        (e, t) =>
                          n.findIndex(t => t.id === e.id) -
                          n.findIndex(e => e.id === t.id)
                      ),
                      r.push(...t.map(e => ({ id: e.id, flavour: e.flavour })));
                  } catch (e) {
                    eK.error('list data error:', e);
                  }
                e.signal.aborted ||
                  (c([...r]), eK.info('mount first data:', r));
              })().catch(e => {
                eK.error('fetch error:', e);
              }),
              () => {
                e.abort(), eK.info('unmount');
              }
            );
          }, [c]),
            (0, L.useEffect)(() => {
              var e;
              let t =
                null === (e = o.find(e => e.id === i)) || void 0 === e
                  ? void 0
                  : e.flavour;
              if (t === f.b8.AFFINE)
                return (
                  eY.connect(),
                  () => {
                    eY.disconnect();
                  }
                );
            }, [i, o]);
          let s =
            null !== (t = l && N.WorkspaceAdapters[l.flavour].UI.Provider) &&
            void 0 !== t
              ? t
              : eU;
          return (0, r.BX)(r.HY, {
            children: [
              (0, r.tZ)(L.Suspense, {
                fallback: null,
                children: (0, r.BX)(eV, {
                  children: [
                    (0, r.tZ)(eN.Y, {}),
                    (0, r.tZ)(eG, { children: (0, r.tZ)(eN.m, {}, i) }),
                  ],
                }),
              }),
              (0, r.tZ)(eG, {
                children: (0, r.tZ)(L.Suspense, {
                  fallback: (0, r.tZ)(u.aD, {}),
                  children: (0, r.tZ)(s, {
                    children: (0, r.tZ)(eq, { children: n }),
                  }),
                }),
              }),
            ],
          });
        },
        eq = e => {
          let { children: t } = e,
            [n] = (0, e_.$)(),
            a = (0, T.b9)(z.dv),
            o = (0, T.Dv)(z.dv),
            l = (0, W.useRouter)(),
            { jumpToPage: d } = (0, eA.$)(l);
          if (n.blockSuiteWorkspace.isEmpty) {
            let e = C.Pr,
              t = n.blockSuiteWorkspace.createPage({ id: e });
            (0, B.Y8)(t.id, e),
              C.vc.enablePreloading
                ? (0, p.m)(t).catch(e => {
                    console.error('import error:', e);
                  })
                : (0, p.E)(t),
              l.query.pageId ||
                (a(e),
                d(n.id, e).catch(e => {
                  console.error(e);
                }));
          }
          (0, L.useEffect)(() => {
            let e = n.providers.filter(e => 'background' in e);
            return (
              e.forEach(e => {
                e.connect();
              }),
              () => {
                e.forEach(e => {
                  e.disconnect();
                });
              }
            );
          }, [n]),
            (0, L.useEffect)(() => {
              if (!n) return;
              let e = n.blockSuiteWorkspace.getPage(C.Pr);
              e &&
                e.meta.jumpOnce &&
                (n.blockSuiteWorkspace.meta.setPageMeta(C.Pr, { jumpOnce: !1 }),
                a(o),
                d(n.id, e.id).catch(e => {
                  console.error(e);
                }));
            }, [o, n, d, l.query.pageId, a]);
          let { openPage: h } = (0, eA.$)(l),
            [, f] = (0, T.KO)(O.XK),
            v = (0, I.S)(n.blockSuiteWorkspace),
            g = 'public-workspace' === l.pathname.split('/')[1],
            b = (0, eW.d)(l),
            k = (0, L.useCallback)(() => v.createPage((0, B.x0)()), [v]),
            m = (0, L.useCallback)(() => {
              f(!0);
            }, [f]),
            [, Z] = (0, T.KO)(O.A8),
            w = (0, L.useCallback)(() => {
              Z(!0);
            }, [Z]),
            x = (0, T.Dv)(s.XN),
            y = (0, F.Dy)(
              (0, F.VT)(F.MA, {
                activationConstraint: { delay: 500, tolerance: 10 },
              })
            ),
            { removeToTrash: S } = (0, eP.a)(n.blockSuiteWorkspace),
            _ = (0, i.X)(),
            M = C.OB.isDesktop
              ? ['whatNew', 'contact', 'guide']
              : ['whatNew', 'contact'],
            H = (0, L.useCallback)(
              e => {
                var t;
                if (
                  (null === (t = e.over) || void 0 === t ? void 0 : t.id) ===
                    eI &&
                  String(e.active.id).startsWith('page-list-item-')
                ) {
                  let { pageId: t } = e.active.data.current;
                  S(t), (0, eD.A)(_['Successfully deleted']());
                }
              },
              [S, _]
            );
          return (0, r.BX)(r.HY, {
            children: [
              (0, r.tZ)(A(), { children: (0, r.tZ)('title', { children: b }) }),
              (0, r.BX)(F.LB, {
                sensors: y,
                collisionDetection: F.j2,
                onDragEnd: H,
                children: [
                  (0, r.BX)(u.zj, {
                    resizing: x,
                    children: [
                      (0, r.tZ)(eT, {
                        isPublicWorkspace: g,
                        onOpenQuickSearchModal: w,
                        currentWorkspace: n,
                        onOpenWorkspaceListModal: m,
                        openPage: (0, L.useCallback)(
                          e => ((0, B.kP)(n), h(n.id, e)),
                          [n, h]
                        ),
                        createPage: k,
                        currentPath: l.asPath.split('?')[0],
                        paths: g ? eO.Z3 : eO.d5,
                      }),
                      (0, r.BX)(u.tz, {
                        children: [
                          t,
                          (0, r.BX)(u.yK, {
                            children: [
                              (0, r.tZ)('div', {
                                id: 'toolWrapper',
                                style: { marginBottom: '12px' },
                              }),
                              !g &&
                                (0, r.tZ)(ep, {
                                  showList: l.query.pageId ? void 0 : M,
                                }),
                            ],
                          }),
                          (0, r.tZ)(c, {}),
                        ],
                      }),
                    ],
                  }),
                  (0, r.tZ)(eQ, {}),
                ],
              }),
              (0, r.tZ)(ej, {}),
            ],
          });
        };
      function eQ() {
        let { active: e } = (0, F.Cj)(),
          t = (0, L.useCallback)(e => {
            let { icon: t, pageTitle: n } = e;
            return (0, r.BX)(d.$X, {
              children: [
                t,
                (0, r.tZ)(a.VY, {
                  ellipsis: !0,
                  color: 'inherit',
                  children: n,
                }),
              ],
            });
          }, []);
        return (0, r.tZ)(F.y9, {
          style: {
            zIndex: 1001,
            backgroundColor: 'var(--affine-black-10)',
            padding: '0 30px',
            cursor: 'default',
            borderRadius: 10,
            ...(0, a.j2)('flex-start', 'center'),
          },
          dropAnimation: null,
          children: e ? t(e.data.current) : null,
        });
      }
    },
    99341: function (e, t, n) {
      'use strict';
      n.d(t, {
        Y: function () {
          return w;
        },
        m: function () {
          return Z;
        },
      });
      var r = n(52903),
        a = n(96893),
        i = n(91337),
        o = n(14192),
        l = n(66548),
        c = n(752),
        s = n(5632),
        d = n(2784),
        u = n(74090),
        h = n(66844),
        C = n(9718),
        p = n(76641),
        f = n(31747),
        v = n(87175);
      let g = (0, d.lazy)(() =>
          n
            .e(9967)
            .then(n.bind(n, 29967))
            .then(e => ({ default: e.WorkspaceListModal }))
        ),
        b = (0, d.lazy)(() =>
          n
            .e(2612)
            .then(n.bind(n, 32612))
            .then(e => ({ default: e.CreateWorkspaceModal }))
        ),
        k = (0, d.lazy)(() =>
          n
            .e(2883)
            .then(n.bind(n, 2883))
            .then(e => ({ default: e.TmpDisableAffineCloudModal }))
        ),
        m = (0, d.lazy)(() =>
          n
            .e(2964)
            .then(n.bind(n, 92964))
            .then(e => ({ default: e.OnboardingModal }))
        );
      function Z() {
        let [e, t] = (0, c.KO)(u.Qe),
          [n, i] = (0, c.KO)(u.Yt),
          o = (0, d.useCallback)(() => {
            i(!1);
          }, [i]);
        return (0, r.BX)(r.HY, {
          children: [
            (0, r.tZ)(d.Suspense, {
              children: (0, r.tZ)(k, {
                open: e,
                onClose: (0, d.useCallback)(() => {
                  t(!1);
                }, [t]),
              }),
            }),
            a.OB.isDesktop &&
              (0, r.tZ)(d.Suspense, {
                children: (0, r.tZ)(m, { open: n, onClose: o }),
              }),
          ],
        });
      }
      let w = () => {
        let [e, t] = (0, c.KO)(u.XK),
          [n, a] = (0, c.KO)(u.Hi),
          k = (0, s.useRouter)(),
          { jumpToSubPath: m } = (0, f.$)(k),
          Z = (0, p.x)(),
          w = (0, v._)(),
          x = (0, c.b9)(o.nn),
          [y, S] = (0, c.KO)(o.At),
          [_, M] = (0, d.useTransition)();
        return (0, r.BX)(r.HY, {
          children: [
            (0, r.tZ)(d.Suspense, {
              children: (0, r.tZ)(g, {
                disabled: _,
                user: Z,
                workspaces: w,
                currentWorkspaceId: y,
                open: (e || 0 === w.length) && !1 === n,
                onClose: (0, d.useCallback)(() => {
                  t(!1);
                }, [t]),
                onMoveWorkspace: (0, d.useCallback)(
                  (e, t) => {
                    let n = w.findIndex(t => t.id === e),
                      r = w.findIndex(e => e.id === t);
                    M(() => x(e => (0, l.Rp)(e, n, r)));
                  },
                  [x, w]
                ),
                onClickWorkspace: (0, d.useCallback)(
                  e => {
                    t(!1),
                      S(e.id),
                      m(e.id, i._0.ALL).catch(e => {
                        console.error(e);
                      });
                  },
                  [m, S, t]
                ),
                onClickWorkspaceSetting: (0, d.useCallback)(
                  e => {
                    t(!1),
                      S(e.id),
                      m(e.id, i._0.SETTING).catch(e => {
                        console.error(e);
                      });
                  },
                  [m, S, t]
                ),
                onClickLogin: (function () {
                  let e = (0, s.useRouter)();
                  return (0, d.useCallback)(async () => {
                    var t, n;
                    await (null ===
                      (n = (t = h.WorkspaceAdapters[i.b8.AFFINE].Events)[
                        'workspace:access'
                      ]) || void 0 === n
                      ? void 0
                      : n.call(t)),
                      e.reload();
                  }, [e]);
                })(),
                onClickLogout: (0, C.v)(),
                onNewWorkspace: (0, d.useCallback)(() => {
                  a('new');
                }, [a]),
                onAddWorkspace: (0, d.useCallback)(async () => {
                  a('add');
                }, [a]),
              }),
            }),
            (0, r.tZ)(d.Suspense, {
              children: (0, r.tZ)(b, {
                mode: n,
                onClose: (0, d.useCallback)(() => {
                  a(!1);
                }, [a]),
                onCreate: (0, d.useCallback)(
                  async e => (a(!1), t(!1), S(e), m(e, i._0.ALL)),
                  [m, S, a, t]
                ),
              }),
            }),
          ],
        });
      };
    },
    5329: function (e, t, n) {
      'use strict';
      n.d(t, {
        z: function () {
          return C;
        },
      });
      var r = n(52903),
        a = n(98036),
        i = n(77352),
        o = n(78365),
        l = n(6277),
        c = n(2784);
      n(24717);
      var s = '_1fm79vi0';
      let d = [
          ['#FF0000', '#FF00E5', '#FFAE73'],
          ['#FF5C00', '#FFC700', '#FFE073'],
          ['#FFDA16', '#FFFBA6', '#FFBE73'],
          ['#8CD317', '#FCFF5C', '#67CAE9'],
          ['#28E19F', '#89FFC6', '#39A880'],
          ['#35B7E0', '#77FFCE', '#5076FF'],
          ['#3D39FF', '#77BEFF', '#3502FF'],
          ['#BD08EB', '#755FFF', '#6967E4'],
        ],
        u = e => {
          let { name: t } = e,
            n = t || 'A',
            a = (0, c.useMemo)(() => {
              let e = n[0].toUpperCase().charCodeAt(0);
              return d[e % d.length];
            }, [n]),
            i = (0, c.useRef)(),
            [o, s, u] = a,
            [h, C] = (0, c.useState)(!1);
          return (0, r.BX)('div', {
            className: '_1fm79vi4',
            onMouseEnter: () => {
              i.current = setTimeout(() => {
                C(!0);
              }, 300);
            },
            onMouseLeave: () => {
              clearTimeout(i.current), C(!1);
            },
            children: [
              (0, r.tZ)('div', {
                className: '_1fm79vi9',
                style: { background: u },
              }),
              (0, r.tZ)('div', {
                className: (0, l.Z)('_1fm79vi5', { _1fm79vi6: h }),
                style: { background: s },
              }),
              (0, r.tZ)('div', {
                className: (0, l.Z)('_1fm79vi7', { _1fm79vi8: h }),
                style: { background: o },
              }),
            ],
          });
        },
        h = e => {
          let { size: t, workspace: n, ...c } = e,
            [d] = (0, i.r)(n),
            [h] = (0, o.H)(n);
          return (0, r.BX)(a.fC, {
            ...c,
            className: (0, l.Z)(s, c.className),
            style: { height: t, width: t },
            children: [
              (0, r.tZ)(a.Ee, { className: '_1fm79vi1', src: d, alt: h }),
              (0, r.tZ)(a.NY, { children: (0, r.tZ)(u, { name: h }) }),
            ],
          });
        },
        C = e => {
          let { size: t = 20, workspace: n, ...i } = e;
          return n && 'blockSuiteWorkspace' in n
            ? (0, r.tZ)(h, { ...i, size: t, workspace: n.blockSuiteWorkspace })
            : (0, r.tZ)(a.fC, {
                ...i,
                className: (0, l.Z)(s, i.className),
                style: { height: t, width: t },
                children: (0, r.tZ)(a.NY, {
                  children: (0, r.tZ)(u, { name: 'A' }),
                }),
              });
        };
    },
    49889: function (e, t, n) {
      'use strict';
      n.d(t, {
        TN: function () {
          return s;
        },
        ib: function () {
          return d;
        },
        vH: function () {
          return o;
        },
      });
      var r,
        a,
        i,
        o,
        l = n(30195);
      l.z.object({
        blob_usage: l.z.object({
          usage: l.z.number(),
          max_usage: l.z.number(),
        }),
      }),
        ((r = i || (i = {}))[(r.Private = 0)] = 'Private'),
        (r[(r.Normal = 1)] = 'Normal'),
        ((a = o || (o = {}))[(a.Read = 0)] = 'Read'),
        (a[(a.Write = 1)] = 'Write'),
        (a[(a.Admin = 10)] = 'Admin'),
        (a[(a.Owner = 99)] = 'Owner');
      let c = l.z.object({
          id: l.z.string(),
          name: l.z.string(),
          email: l.z.string(),
          avatar_url: l.z.string(),
          created_at: l.z.number(),
        }),
        s = l.z.object({
          id: l.z.string(),
          type: l.z.nativeEnum(i),
          public: l.z.boolean(),
          permission: l.z.nativeEnum(o),
        }),
        d = l.z.object({
          ...s.shape,
          permission: l.z.undefined(),
          owner: c,
          member_count: l.z.number(),
        });
      l.z.object({
        id: l.z.string(),
        public: l.z.boolean(),
        type: l.z.nativeEnum(i),
        created_at: l.z.number(),
      });
    },
    77352: function (e, t, n) {
      'use strict';
      n.d(t, {
        r: function () {
          return o;
        },
      });
      var r = n(13246),
        a = n(2784),
        i = n(3255);
      function o(e) {
        let [t, n] = (0, a.useState)(() => e.meta.avatar);
        t !== e.meta.avatar && n(e.meta.avatar);
        let { data: o, mutate: l } = (0, i.ZP)(t, {
            fetcher: async t => {
              (0, r.kP)(e);
              let n = await e.blobs,
                a = await n.get(t);
              return a ? URL.createObjectURL(a) : null;
            },
            suspense: !0,
            fallbackData: null,
          }),
          c = (0, a.useCallback)(
            async t => {
              (0, r.kP)(e);
              let n = new Blob([t], { type: t.type }),
                a = await e.blobs,
                i = await a.set(n);
              e.meta.setAvatar(i), await l(i);
            },
            [e, l]
          );
        return (
          (0, a.useEffect)(() => {
            if (e) {
              let t = e.meta.commonFieldsUpdated.on(() => {
                n(e.meta.avatar);
              });
              return () => {
                t.dispose();
              };
            }
          }, [e]),
          [null != o ? o : null, c]
        );
      }
    },
    36054: function (e, t, n) {
      'use strict';
      n.d(t, {
        S: function () {
          return o;
        },
      });
      var r = n(13246),
        a = n(61222),
        i = n(2784);
      function o(e) {
        return (0, i.useMemo)(
          () => ({
            createPage: t => ((0, r.kP)(e), e.createPage({ id: t })),
            markMilestone: async t => {
              (0, r.kP)(e);
              let n = e.doc;
              await (0, a.J6)(e.id, n, t);
            },
            revertMilestone: async t => {
              (0, r.kP)(e);
              let n = e.doc,
                i = await (0, a.gu)(e.id);
              if (!i) throw Error('no milestone');
              let o = i[t];
              o && (0, a.dE)(n, o, () => 'Map');
            },
            listMilestone: async () => ((0, r.kP)(e), await (0, a.gu)(e.id)),
          }),
          [e]
        );
      }
    },
    78365: function (e, t, n) {
      'use strict';
      n.d(t, {
        H: function () {
          return s;
        },
      });
      var r = n(96893),
        a = n(13246),
        i = n(65058),
        o = n(752);
      let l = new WeakMap(),
        c = (0, i.cn)(r.e6, () => {
          console.warn('you cannot set the name of an null workspace.'),
            console.warn('this is a bug in the code.');
        });
      function s(e) {
        let t;
        if (e) {
          if (l.has(e)) (t = l.get(e)), (0, a.kP)(t);
          else {
            var n;
            let a = (0, i.cn)(
                null !== (n = e.meta.name) && void 0 !== n ? n : r.e6
              ),
              o = (0, i.cn)(
                e => e(a),
                (t, n, r) => {
                  e.meta.setName(r), n(a, r);
                }
              );
            (a.onMount = t => {
              let n = e.meta.commonFieldsUpdated.on(() => {
                var n;
                t(null !== (n = e.meta.name) && void 0 !== n ? n : '');
              });
              return () => {
                n.dispose();
              };
            }),
              l.set(e, o),
              (t = o);
          }
        } else t = c;
        return (0, o.KO)(t);
      }
    },
    85245: function (e, t, n) {
      'use strict';
      n.d(t, {
        j: function () {
          return c;
        },
      });
      var r = n(13246),
        a = n(65058),
        i = n(752);
      let o = new WeakMap(),
        l = (0, a.cn)(null);
      function c(e, t) {
        let n = (function (e, t) {
          if (!t) return l;
          o.has(e) || o.set(e, new Map());
          let n = o.get(e);
          if (((0, r.kP)(n), n.has(t))) return n.get(t);
          {
            let i = (0, a.cn)(e.getPage(t));
            return (
              (i.onMount = n => {
                let a = new r.SJ();
                return (
                  a.add(
                    e.slots.pageAdded.on(r => {
                      t === r && n(e.getPage(r));
                    })
                  ),
                  a.add(
                    e.slots.pageRemoved.on(e => {
                      t === e && n(null);
                    })
                  ),
                  () => {
                    a.dispose();
                  }
                );
              }),
              n.set(t, i),
              i
            );
          }
        })(e, t);
        return (0, r.kP)(n), (0, i.Dv)(n);
      }
    },
    89365: function () {},
    24717: function () {},
    32420: function () {},
    53745: function () {},
  },
]);
//# sourceMappingURL=1264-5ed9e2d9163200cc.js.map
