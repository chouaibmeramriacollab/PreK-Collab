{"version":3,"file":"static/chunks/pages/invite/[invite-code]-0bc162e9b596dced.js","mappings":"qIAsEAA,CAAAA,EAAA,EAhDA,SAAAC,CAAA,EACA,IACAC,SAAAA,CAAA,CACAC,MAAAA,EAAA,GACAC,SAAAA,EAAA,KACA,CAAIH,EACJ,CAAAI,EAAAC,EAAA,CAA0CC,EAAAC,QAAc,KAaxD,MAZE,GAAAC,EAAAC,CAAA,EAAiB,KACnBP,GACAG,EAAA,GAEA,EAAG,CAAAH,EAAA,EACDI,EAAAI,SAAe,MACjBR,GACAG,EAAA,GAEA,EAAG,CAAAH,EAAA,EAGmB,GAAAS,EAAAC,GAAA,EAAKN,EAAAO,QAAc,EACzCZ,SAAAG,EAAAH,EAAAE,CAAA,EAEA,yBC3CA,CAAAW,OAAAC,QAAA,CAAAD,OAAAC,QAAA,MAAAC,IAAA,EACA,wBACA,WACA,OAAeC,EAAQ,MACvB,EACA,iGCFYC,EAALA,YAKA,SAASC,EAAgBC,CAAkB,CAAE,CAClD,IAAMC,EAAaC,CAAAA,EAAAA,EAAAA,WAAAA,EACjB,SACEC,CAAAA,CACAC,CAAAA,CAEG,KADHC,EAAAA,UAAAA,MAAAA,CAAAA,GAAAA,KAAAA,IAAAA,SAAAA,CAAAA,EAAAA,CAAAA,SAAAA,CAAAA,EAAAA,CAAoBP,EAAWQ,IAAI,CAEnC,OAAON,CAAM,CAACK,EAAM,CAAC,CACnBE,SAAW,oCACXC,MAAO,CACLL,YAAAA,EACAC,OAAAA,CACF,CACF,EACF,EACA,CAACJ,EAAO,EAEJS,EAA4BP,CAAAA,EAAAA,EAAAA,WAAAA,EAChC,SACEC,CAAAA,CACAC,CAAAA,CAEG,KADHC,EAAAA,UAAAA,MAAAA,CAAAA,GAAAA,KAAAA,IAAAA,SAAAA,CAAAA,EAAAA,CAAAA,SAAAA,CAAAA,EAAAA,CAAoBP,EAAWQ,IAAI,CAEnC,OAAON,CAAM,CAACK,EAAM,CAAC,CACnBE,SAAW,2CACXC,MAAO,CACLL,YAAAA,EACAC,OAAAA,CACF,CACF,EACF,EACA,CAACJ,EAAO,EAEJU,EAAgBR,CAAAA,EAAAA,EAAAA,WAAAA,EACpB,SACEC,CAAAA,CACAQ,CAAAA,CAEqB,KADrBN,EAAAA,UAAAA,MAAAA,CAAAA,GAAAA,KAAAA,IAAAA,SAAAA,CAAAA,EAAAA,CAAAA,SAAAA,CAAAA,EAAAA,CAAoBP,EAAWQ,IAAI,CAEnC,OAAON,CAAM,CAACK,EAAM,CAAC,CACnBE,SAAU,4BAAoCK,MAAA,CAARD,GACtCH,MAAO,CACLL,YAAAA,CACF,CACF,EACF,EACA,CAACH,EAAO,EAEJa,EAAWX,CAAAA,EAAAA,EAAAA,WAAAA,EACf,CAACC,EAAqBC,IAAmB,CACvC,IAAMU,EACJd,qBAAAA,EAAOO,QAAQ,CAACQ,KAAK,CAAC,IAAI,CAAC,EAAE,QAC/B,EACSN,EAA0BN,EAAaC,GAEvCH,EAAWE,EAAaC,EAChC,EAEH,CAACH,EAAYQ,EAA2BT,EAAOO,QAAQ,CAAC,EAG1D,MAAO,CACLN,WAAAA,EACAQ,0BAAAA,EACAC,cAAAA,EACAG,SAAAA,CACF,CACF,CAxEYf,CAAAA,EAAAA,GAAAA,CAAAA,EAAAA,CAAAA,CAAAA,GACVkB,OAAAA,CAAU,UADAlB,EAEVQ,IAAAA,CAAO,gMCaT,IAAMW,EAAiC,IAAM,CAC3C,IAAMjB,EAASkB,CAAAA,EAAAA,EAAAA,SAAAA,IACT,CAAER,cAAAA,CAAAA,CAAe,CAAGX,CAAAA,EAAAA,EAAAA,CAAAA,EAAgBC,GACpC,CAAEmB,KAAMC,CAAAA,CAAY,CAAGC,CAAAA,EAAAA,EAAAA,EAAAA,EAC3B,iBAAOrB,EAAOQ,KAAK,CAACc,WAAW,CAC3B,CAACC,EAAAA,CAAAA,CAAAA,YAAqB,CAAEvB,EAAOQ,KAAK,CAACc,WAAW,CAAC,CACjD,IAAI,EAGV,GAAIF,MAAAA,EAAAA,KAAAA,EAAAA,EAAYI,QAAQ,CACtB,MACE,GAAAC,EAAAC,EAAA,EAACC,EAAAA,WACC,GAAAF,EAAAG,EAAA,EAACC,IAAKA,CACJC,IAAI,2BACJC,IAAI,GACJC,OAAO,OACPC,MAAO,IACPC,OAAQ,MAEV,GAAAT,EAAAG,EAAA,EAACO,EAAAA,EAAMA,CAAAA,CACLC,KAAK,UACLC,MAAM,QACNC,QAAS,IAAM,CACb5B,EACEU,EAAWmB,YAAY,CACvBC,EAAAA,EAAAA,CAAAA,GAAoB,CACpB1C,EAAAA,CAAAA,CAAAA,OAAkB,EAClB2C,KAAK,CAACC,GAAOC,QAAQC,KAAK,CAACF,GAC/B,WACD,oBAGD,GAAAjB,EAAAC,EAAA,EAACmB,IAAAA,WACC,GAAApB,EAAAG,EAAA,EAACkB,EAAAA,oBAAoBA,CAAAA,CAAAA,GAAG,2BAK/B,CAED,GAAI1B,CAAAA,MAAAA,EAAAA,KAAAA,EAAAA,EAAYI,QAAQ,IAAK,GAC3B,MACE,GAAAC,EAAAC,EAAA,EAACC,EAAAA,WACC,GAAAF,EAAAG,EAAA,EAACC,IAAKA,CAACC,IAAI,yBAAyBC,IAAI,KACxC,GAAAN,EAAAG,EAAA,EAACO,EAAAA,EAAMA,CAAAA,CACLE,MAAM,QACNC,QAAS,IAAM,CACbtC,EAAO+C,OAAO,CAAE,KAAIN,KAAK,CAACC,GAAOC,QAAQC,KAAK,CAACF,GACjD,WACD,iBAGD,GAAAjB,EAAAC,EAAA,EAACmB,IAAAA,WACC,GAAApB,EAAAG,EAAA,EAACoB,EAAAA,sBAAsBA,CAAAA,CAAAA,GAAG,4BAKjC,OACK,MAAU,sBAAuB,CAGzCrE,CAAAA,EAAA,QAAesC,EAEfA,EAAWgC,SAAS,CAAGC,GAEnB,GAAAzB,EAAAG,EAAA,EAACuB,EAAAA,QAAQA,CAAAA,CAACpE,SAAU,GAAA0C,EAAAG,EAAA,EAACwB,EAAAA,EAAWA,CAAAA,CAAAA,YAC9B,GAAA3B,EAAAG,EAAA,EAACyB,EAAAA,CAAKA,CAAAA,UAAEH,MAKd,IAAMvB,EAAkB2B,CAAAA,EAAAA,EAAAA,EAAAA,EAAO,OAAO,IAC7B,EACLpB,OAAQ,QACR,GAAGqB,CAAAA,EAAAA,EAAAA,EAAAA,EAAY,SAAU,SAAS,CAClCC,cAAe,SACfC,gBAAiB,yCACjBC,IAAK,CACHzB,MAAO,QACPC,OAAQ,OACV,EACAW,EAAG,CACD,GAAGU,CAAAA,EAAAA,EAAAA,EAAAA,EAAY,SAAU,SAAS,CAClCI,UAAW,OACXC,IAAK,CACHC,MAAO,8BACPC,SAAU,OACVC,YAAa,MACf,CACF,CACF","sources":["webpack://_N_E/../../node_modules/@mui/base/NoSsr/NoSsr.js","webpack://_N_E/?83ec","webpack://_N_E/./src/hooks/use-router-helper.ts","webpack://_N_E/./src/pages/invite/[invite-code].tsx","webpack://_N_E/<anon>"],"sourcesContent":["import * as React from 'react';\nimport PropTypes from 'prop-types';\nimport { exactProp, unstable_useEnhancedEffect as useEnhancedEffect } from '@mui/utils';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n/**\n * NoSsr purposely removes components from the subject of Server Side Rendering (SSR).\n *\n * This component can be useful in a variety of situations:\n *\n * *   Escape hatch for broken dependencies not supporting SSR.\n * *   Improve the time-to-first paint on the client by only rendering above the fold.\n * *   Reduce the rendering time on the server.\n * *   Under too heavy server load, you can turn on service degradation.\n *\n * Demos:\n *\n * - [No SSR](https://mui.com/base/react-no-ssr/)\n *\n * API:\n *\n * - [NoSsr API](https://mui.com/base/react-no-ssr/components-api/#no-ssr)\n */\nfunction NoSsr(props) {\n  const {\n    children,\n    defer = false,\n    fallback = null\n  } = props;\n  const [mountedState, setMountedState] = React.useState(false);\n  useEnhancedEffect(() => {\n    if (!defer) {\n      setMountedState(true);\n    }\n  }, [defer]);\n  React.useEffect(() => {\n    if (defer) {\n      setMountedState(true);\n    }\n  }, [defer]);\n\n  // We need the Fragment here to force react-docgen to recognise NoSsr as a component.\n  return /*#__PURE__*/_jsx(React.Fragment, {\n    children: mountedState ? children : fallback\n  });\n}\nprocess.env.NODE_ENV !== \"production\" ? NoSsr.propTypes /* remove-proptypes */ = {\n  // ----------------------------- Warning --------------------------------\n  // | These PropTypes are generated from the TypeScript type definitions |\n  // |     To update them edit TypeScript types and run \"yarn proptypes\"  |\n  // ----------------------------------------------------------------------\n  /**\n   * You can wrap a node.\n   */\n  children: PropTypes.node,\n  /**\n   * If `true`, the component will not only prevent server-side rendering.\n   * It will also defer the rendering of the children into a different screen frame.\n   * @default false\n   */\n  defer: PropTypes.bool,\n  /**\n   * The fallback content to display.\n   * @default null\n   */\n  fallback: PropTypes.node\n} : void 0;\nif (process.env.NODE_ENV !== 'production') {\n  // eslint-disable-next-line\n  NoSsr['propTypes' + ''] = exactProp(NoSsr.propTypes);\n}\nexport default NoSsr;","\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/invite/[invite-code]\",\n      function () {\n        return require(\"private-next-pages/invite/[invite-code].tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/invite/[invite-code]\"])\n      });\n    }\n  ","import type { WorkspaceSubPath } from '@affine/env/workspace';\nimport type { NextRouter } from 'next/router';\nimport { useCallback } from 'react';\n\nexport enum RouteLogic {\n  REPLACE = 'replace',\n  PUSH = 'push',\n}\n\nexport function useRouterHelper(router: NextRouter) {\n  const jumpToPage = useCallback(\n    (\n      workspaceId: string,\n      pageId: string,\n      logic: RouteLogic = RouteLogic.PUSH\n    ) => {\n      return router[logic]({\n        pathname: `/workspace/[workspaceId]/[pageId]`,\n        query: {\n          workspaceId,\n          pageId,\n        },\n      });\n    },\n    [router]\n  );\n  const jumpToPublicWorkspacePage = useCallback(\n    (\n      workspaceId: string,\n      pageId: string,\n      logic: RouteLogic = RouteLogic.PUSH\n    ) => {\n      return router[logic]({\n        pathname: `/public-workspace/[workspaceId]/[pageId]`,\n        query: {\n          workspaceId,\n          pageId,\n        },\n      });\n    },\n    [router]\n  );\n  const jumpToSubPath = useCallback(\n    (\n      workspaceId: string,\n      subPath: WorkspaceSubPath,\n      logic: RouteLogic = RouteLogic.PUSH\n    ): Promise<boolean> => {\n      return router[logic]({\n        pathname: `/workspace/[workspaceId]/${subPath}`,\n        query: {\n          workspaceId,\n        },\n      });\n    },\n    [router]\n  );\n  const openPage = useCallback(\n    (workspaceId: string, pageId: string) => {\n      const isPublicWorkspace =\n        router.pathname.split('/')[1] === 'public-workspace';\n      if (isPublicWorkspace) {\n        return jumpToPublicWorkspacePage(workspaceId, pageId);\n      } else {\n        return jumpToPage(workspaceId, pageId);\n      }\n    },\n    [jumpToPage, jumpToPublicWorkspacePage, router.pathname]\n  );\n\n  return {\n    jumpToPage,\n    jumpToPublicWorkspacePage,\n    jumpToSubPath,\n    openPage,\n  };\n}\n","import { displayFlex, styled } from '@affine/component';\nimport { Button } from '@affine/component';\nimport { WorkspaceSubPath } from '@affine/env/workspace';\nimport type { Permission } from '@affine/env/workspace/legacy-cloud';\nimport {\n  SucessfulDuotoneIcon,\n  UnsucessfulDuotoneIcon,\n} from '@blocksuite/icons';\nimport { NoSsr } from '@mui/material';\nimport Image from 'next/legacy/image';\nimport { useRouter } from 'next/router';\nimport { Suspense } from 'react';\nimport useSWR from 'swr';\n\nimport { QueryKey } from '../../adapters/affine/fetcher';\nimport { PageLoading } from '../../components/pure/loading';\nimport { RouteLogic, useRouterHelper } from '../../hooks/use-router-helper';\nimport type { NextPageWithLayout } from '../../shared';\n\nconst InvitePage: NextPageWithLayout = () => {\n  const router = useRouter();\n  const { jumpToSubPath } = useRouterHelper(router);\n  const { data: inviteData } = useSWR<Permission>(\n    typeof router.query.invite_code === 'string'\n      ? [QueryKey.acceptInvite, router.query.invite_code]\n      : null\n  );\n\n  if (inviteData?.accepted) {\n    return (\n      <StyledContainer>\n        <Image\n          src=\"/imgs/invite-success.svg\"\n          alt=\"\"\n          layout=\"fill\"\n          width={300}\n          height={300}\n        />\n        <Button\n          type=\"primary\"\n          shape=\"round\"\n          onClick={() => {\n            jumpToSubPath(\n              inviteData.workspace_id,\n              WorkspaceSubPath.ALL,\n              RouteLogic.REPLACE\n            ).catch(err => console.error(err));\n          }}\n        >\n          Go to Workspace\n        </Button>\n        <p>\n          <SucessfulDuotoneIcon />\n          Successfully joined\n        </p>\n      </StyledContainer>\n    );\n  }\n\n  if (inviteData?.accepted === false) {\n    return (\n      <StyledContainer>\n        <Image src=\"/imgs/invite-error.svg\" alt=\"\" />\n        <Button\n          shape=\"round\"\n          onClick={() => {\n            router.replace(`/`).catch(err => console.error(err));\n          }}\n        >\n          Back to Home\n        </Button>\n        <p>\n          <UnsucessfulDuotoneIcon />\n          The link has expired\n        </p>\n      </StyledContainer>\n    );\n  }\n  throw new Error('Invalid invite code');\n};\n\nexport default InvitePage;\n\nInvitePage.getLayout = page => {\n  return (\n    <Suspense fallback={<PageLoading />}>\n      <NoSsr>{page}</NoSsr>\n    </Suspense>\n  );\n};\n\nconst StyledContainer = styled('div')(() => {\n  return {\n    height: '100vh',\n    ...displayFlex('center', 'center'),\n    flexDirection: 'column',\n    backgroundColor: 'var(--affine-background-primary-color)',\n    img: {\n      width: '300px',\n      height: '300px',\n    },\n    p: {\n      ...displayFlex('center', 'center'),\n      marginTop: '24px',\n      svg: {\n        color: 'var(--affine-primary-color)',\n        fontSize: '24px',\n        marginRight: '12px',\n      },\n    },\n  };\n});\n"],"names":["__webpack_exports__","props","children","defer","fallback","mountedState","setMountedState","react__WEBPACK_IMPORTED_MODULE_0__","useState","_mui_utils__WEBPACK_IMPORTED_MODULE_2__","Z","useEffect","react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__","jsx","Fragment","window","__NEXT_P","push","__webpack_require__","RouteLogic","useRouterHelper","router","jumpToPage","useCallback","workspaceId","pageId","logic","PUSH","pathname","query","jumpToPublicWorkspacePage","jumpToSubPath","subPath","concat","openPage","isPublicWorkspace","split","REPLACE","InvitePage","useRouter","data","inviteData","useSWR","invite_code","QueryKey","accepted","_emotion_react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__","BX","StyledContainer","tZ","Image","src","alt","layout","width","height","Button","type","shape","onClick","workspace_id","WorkspaceSubPath","catch","err","console","error","p","SucessfulDuotoneIcon","replace","UnsucessfulDuotoneIcon","getLayout","page","Suspense","PageLoading","NoSsr","styled","displayFlex","flexDirection","backgroundColor","img","marginTop","svg","color","fontSize","marginRight"],"sourceRoot":""}